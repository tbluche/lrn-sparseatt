2026-02-08 10:46:53,278 - INFO - [1/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=50%
2026-02-08 10:46:53,718 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         4.17%     501.299us       100.00%      12.035ms     401.179us            30  
       aten::masked_fill         0.18%      21.503us        51.58%       6.207ms     206.910us            30  
      aten::masked_fill_        47.87%       5.761ms        47.87%       5.761ms     192.033us            30  
           aten::softmax         0.07%       8.540us        19.67%       2.367ms      78.896us            30  
          aten::_softmax        19.60%       2.358ms        19.60%       2.358ms      78.611us            30  
            aten::matmul         0.51%      61.827us        16.44%       1.979ms      32.978us            60  
               aten::bmm        14.57%       1.754ms        15.01%       1.807ms      30.117us            60  
               aten::div         5.18%     623.380us         5.44%     654.878us      21.829us            30  
             aten::clone         0.10%      11.540us         3.53%     424.834us      14.161us            30  
             aten::copy_         3.42%     412.127us         3.42%     412.127us       6.869us            60  
       aten::bitwise_not         2.32%     278.919us         2.32%     278.919us       9.297us            30  
           aten::reshape         0.21%      24.707us         0.46%      55.043us       0.459us           120  
            aten::select         0.28%      34.300us         0.39%      47.421us       0.263us           180  
            aten::expand         0.30%      35.745us         0.38%      45.836us       0.382us           120  
        aten::as_strided         0.27%      31.918us         0.27%      31.918us       0.089us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.035ms

2026-02-08 10:46:54,054 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         4.21%       7.044ms       100.00%     167.265ms       5.576ms            30  
                   aten::index_add_        48.37%      80.906ms        48.40%      80.951ms       2.698ms            30  
                 aten::index_select        20.68%      34.582ms        20.68%      34.596ms     576.603us            60  
    extension_cpp::sparse_matmul_vo         9.61%      16.071ms         9.67%      16.177ms     539.234us            30  
                    aten::index_add         0.04%      59.625us         7.34%      12.275ms     409.178us            30  
                 aten::scatter_add_         7.28%      12.183ms         7.28%      12.185ms     406.164us            30  
                          aten::mul         6.75%      11.293ms         6.75%      11.293ms     376.450us            30  
                          aten::div         1.05%       1.762ms         1.12%       1.865ms      31.089us            60  
                          aten::exp         0.82%       1.371ms         0.82%       1.371ms      45.704us            30  
                          aten::max         0.39%     651.835us         0.41%     677.503us      22.583us            30  
                          aten::sub         0.35%     593.751us         0.35%     593.751us      19.792us            30  
                        aten::empty         0.11%     176.217us         0.11%     176.217us       0.979us           180  
                        aten::zeros         0.04%      67.333us         0.09%     149.041us       2.484us            60  
                           aten::to         0.01%      16.627us         0.06%     105.501us       1.758us            60  
                       aten::select         0.05%      81.038us         0.06%      99.081us       0.826us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 167.265ms

2026-02-08 10:46:54,182 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.41%     196.209us       100.00%      47.776ms       1.593ms            30  
    extension_cpp::sparse_attn        99.39%      47.484ms        99.48%      47.527ms       1.584ms            30  
                 aten::squeeze         0.07%      32.207us         0.08%      38.666us       0.430us            90  
               aten::new_zeros         0.02%       8.415us         0.05%      25.039us       0.835us            30  
                   aten::empty         0.03%      15.500us         0.03%      15.500us       0.172us            90  
               aten::unsqueeze         0.02%      11.879us         0.03%      14.375us       0.479us            30  
                   aten::zero_         0.02%      11.041us         0.02%      11.041us       0.184us            60  
              aten::as_strided         0.02%       8.955us         0.02%       8.955us       0.075us           120  
               aten::new_empty         0.01%       4.956us         0.02%       8.416us       0.281us            30  
              aten::contiguous         0.01%       2.753us         0.01%       2.753us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 47.776ms

2026-02-08 10:46:54,184 - INFO - [2/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=70%
2026-02-08 10:46:54,273 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.74%     712.500us       100.00%      12.417ms     413.910us            30  
       aten::masked_fill         0.24%      29.876us        37.25%       4.626ms     154.195us            30  
      aten::masked_fill_        32.73%       4.064ms        32.73%       4.064ms     135.482us            30  
            aten::matmul         0.57%      70.338us        23.57%       2.926ms      48.772us            60  
               aten::bmm        21.47%       2.666ms        21.95%       2.726ms      45.430us            60  
           aten::softmax         0.09%      11.374us        21.50%       2.670ms      89.006us            30  
          aten::_softmax        21.41%       2.659ms        21.41%       2.659ms      88.626us            30  
               aten::div         7.84%     973.587us         8.09%       1.005ms      33.490us            30  
             aten::clone         0.13%      15.879us         4.28%     531.504us      17.717us            30  
             aten::copy_         4.11%     509.755us         4.11%     509.755us       8.496us            60  
       aten::bitwise_not         3.41%     423.414us         3.41%     423.414us      14.114us            30  
           aten::reshape         0.22%      27.082us         0.51%      62.958us       0.525us           120  
            aten::expand         0.37%      45.493us         0.46%      56.996us       0.475us           120  
            aten::select         0.31%      38.454us         0.43%      53.124us       0.295us           180  
        aten::as_strided         0.30%      36.840us         0.30%      36.840us       0.102us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.417ms

2026-02-08 10:46:54,490 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         4.88%       4.512ms       100.00%      92.380ms       3.079ms            30  
                   aten::index_add_        48.01%      44.356ms        48.04%      44.379ms       1.479ms            30  
                 aten::index_select        21.29%      19.671ms        21.30%      19.680ms     328.001us            60  
    extension_cpp::sparse_matmul_vo         9.78%       9.031ms         9.79%       9.046ms     301.547us            30  
                    aten::index_add         0.04%      36.173us         7.86%       7.264ms     242.129us            30  
                 aten::scatter_add_         7.80%       7.205ms         7.80%       7.207ms     240.220us            30  
                          aten::mul         4.86%       4.488ms         4.86%       4.488ms     149.593us            30  
                          aten::div         1.14%       1.049ms         1.19%       1.097ms      18.284us            60  
                          aten::exp         0.89%     823.584us         0.89%     823.584us      27.453us            30  
                          aten::max         0.51%     467.999us         0.53%     488.459us      16.282us            30  
                          aten::sub         0.41%     380.373us         0.41%     380.373us      12.679us            30  
                        aten::zeros         0.04%      35.913us         0.08%      74.708us       1.245us            60  
                       aten::select         0.05%      47.462us         0.06%      59.713us       0.498us           120  
                        aten::empty         0.06%      52.424us         0.06%      52.424us       0.291us           180  
                           aten::to         0.01%       7.959us         0.05%      49.000us       0.817us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 92.380ms

2026-02-08 10:46:54,586 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.18%     341.836us       100.00%      29.011ms     967.033us            30  
    extension_cpp::sparse_attn        98.50%      28.576ms        98.65%      28.618ms     953.948us            30  
                 aten::squeeze         0.11%      31.255us         0.13%      37.169us       0.413us            90  
               aten::new_zeros         0.03%       8.880us         0.08%      24.420us       0.814us            30  
                   aten::empty         0.06%      16.122us         0.06%      16.122us       0.179us            90  
               aten::unsqueeze         0.04%      11.081us         0.05%      13.541us       0.451us            30  
                   aten::zero_         0.04%      11.039us         0.04%      11.039us       0.184us            60  
              aten::as_strided         0.03%       8.374us         0.03%       8.374us       0.070us           120  
               aten::new_empty         0.01%       4.003us         0.03%       7.542us       0.251us            30  
              aten::contiguous         0.01%       2.791us         0.01%       2.791us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 29.011ms

2026-02-08 10:46:54,588 - INFO - [3/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=90%
2026-02-08 10:46:54,669 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.32%     713.085us       100.00%       9.742ms     324.726us            30  
       aten::masked_fill         0.29%      28.625us        28.59%       2.785ms      92.823us            30  
           aten::softmax         0.11%      11.000us        27.49%       2.678ms      89.262us            30  
          aten::_softmax        27.38%       2.667ms        27.38%       2.667ms      88.896us            30  
            aten::matmul         0.73%      70.956us        23.32%       2.272ms      37.860us            60  
      aten::masked_fill_        22.44%       2.187ms        22.44%       2.187ms      72.885us            30  
               aten::bmm        20.65%       2.012ms        21.27%       2.072ms      34.533us            60  
               aten::div         8.37%     815.172us         8.69%     846.713us      28.224us            30  
             aten::clone         0.15%      15.041us         5.85%     569.542us      18.985us            30  
             aten::copy_         5.64%     549.752us         5.64%     549.752us       9.163us            60  
       aten::bitwise_not         4.05%     394.828us         4.05%     394.828us      13.161us            30  
           aten::reshape         0.28%      27.576us         0.64%      62.621us       0.522us           120  
            aten::expand         0.46%      44.429us         0.58%      56.253us       0.469us           120  
            aten::select         0.40%      38.624us         0.55%      53.209us       0.296us           180  
        aten::as_strided         0.37%      36.363us         0.37%      36.363us       0.101us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.742ms

2026-02-08 10:46:54,786 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.78%       1.846ms       100.00%      31.934ms       1.064ms            30  
                   aten::index_add_        47.57%      15.191ms        47.63%      15.211ms     507.048us            30  
                 aten::index_select        16.83%       5.373ms        16.84%       5.378ms      89.629us            60  
    extension_cpp::sparse_matmul_vo         9.44%       3.015ms         9.48%       3.026ms     100.872us            30  
                    aten::index_add         0.08%      26.910us         8.38%       2.675ms      89.156us            30  
                 aten::scatter_add_         8.23%       2.628ms         8.23%       2.630ms      87.655us            30  
                          aten::mul         8.15%       2.603ms         8.15%       2.603ms      86.774us            30  
                          aten::exp         1.70%     544.378us         1.70%     544.378us      18.146us            30  
                          aten::div         0.92%     292.421us         1.00%     319.667us       5.328us            60  
                          aten::max         0.33%     105.913us         0.35%     112.583us       3.753us            30  
                        aten::zeros         0.10%      31.249us         0.20%      64.664us       1.078us            60  
                          aten::sub         0.17%      54.704us         0.17%      54.704us       1.823us            30  
                       aten::select         0.10%      33.137us         0.13%      42.347us       0.353us           120  
                        aten::empty         0.11%      36.707us         0.11%      36.707us       0.204us           180  
                      aten::squeeze         0.09%      27.921us         0.10%      32.418us       0.540us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 31.934ms

2026-02-08 10:46:54,854 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         2.19%     212.924us       100.00%       9.708ms     323.613us            30  
    extension_cpp::sparse_attn        96.79%       9.396ms        97.24%       9.440ms     314.678us            30  
                 aten::squeeze         0.34%      33.380us         0.41%      39.663us       0.441us            90  
               aten::new_zeros         0.09%       8.494us         0.25%      24.706us       0.824us            30  
                   aten::empty         0.17%      16.541us         0.17%      16.541us       0.184us            90  
               aten::unsqueeze         0.13%      12.702us         0.16%      15.454us       0.515us            30  
                   aten::zero_         0.13%      12.252us         0.13%      12.252us       0.204us            60  
              aten::as_strided         0.09%       9.035us         0.09%       9.035us       0.075us           120  
               aten::new_empty         0.04%       3.873us         0.08%       7.875us       0.262us            30  
              aten::contiguous         0.03%       2.837us         0.03%       2.837us       0.032us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.708ms

2026-02-08 10:46:54,857 - INFO - [4/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=95%
2026-02-08 10:46:54,944 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.77%     967.921us       100.00%       9.911ms     330.373us            30  
            aten::matmul         0.69%      68.547us        28.05%       2.780ms      46.334us            60  
           aten::softmax         0.10%      10.164us        26.55%       2.632ms      87.724us            30  
          aten::_softmax        26.45%       2.622ms        26.45%       2.622ms      87.385us            30  
               aten::bmm        25.51%       2.529ms        26.11%       2.588ms      43.125us            60  
       aten::masked_fill         0.28%      27.334us        22.47%       2.227ms      74.238us            30  
      aten::masked_fill_        16.71%       1.656ms        16.71%       1.656ms      55.189us            30  
               aten::div         8.58%     850.462us         8.89%     881.379us      29.379us            30  
             aten::clone         0.15%      14.542us         5.49%     544.128us      18.138us            30  
             aten::copy_         5.29%     524.421us         5.29%     524.421us       8.740us            60  
       aten::bitwise_not         3.75%     371.915us         3.75%     371.915us      12.397us            30  
           aten::reshape         0.26%      26.082us         0.61%      59.997us       0.500us           120  
            aten::expand         0.42%      41.629us         0.54%      53.624us       0.447us           120  
            aten::select         0.39%      38.834us         0.53%      52.750us       0.293us           180  
        aten::as_strided         0.36%      35.321us         0.36%      35.321us       0.098us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.911ms

2026-02-08 10:46:55,032 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         8.41%       1.411ms       100.00%      16.778ms     559.258us            30  
                   aten::index_add_        45.57%       7.645ms        45.69%       7.666ms     255.521us            30  
                 aten::index_select        14.36%       2.409ms        14.39%       2.414ms      40.233us            60  
    extension_cpp::sparse_matmul_vo         9.07%       1.522ms         9.13%       1.532ms      51.077us            30  
                    aten::index_add         0.17%      29.334us         9.05%       1.518ms      50.585us            30  
                 aten::scatter_add_         8.75%       1.468ms         8.76%       1.470ms      48.985us            30  
                          aten::mul         8.24%       1.382ms         8.24%       1.382ms      46.063us            30  
                          aten::exp         2.67%     447.616us         2.67%     447.616us      14.921us            30  
                          aten::div         0.66%     110.996us         0.82%     137.248us       2.287us            60  
                          aten::max         0.36%      60.000us         0.40%      66.623us       2.221us            30  
                        aten::zeros         0.21%      34.655us         0.39%      66.161us       1.103us            60  
                       aten::select         0.20%      33.538us         0.26%      43.250us       0.360us           120  
                          aten::sub         0.25%      42.125us         0.25%      42.125us       1.404us            30  
                        aten::empty         0.21%      35.249us         0.21%      35.249us       0.196us           180  
                      aten::squeeze         0.15%      25.794us         0.18%      30.544us       0.509us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 16.778ms

2026-02-08 10:46:55,087 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         3.55%     170.877us       100.00%       4.814ms     160.469us            30  
    extension_cpp::sparse_attn        94.64%       4.556ms        95.48%       4.596ms     153.217us            30  
                 aten::squeeze         0.60%      29.072us         0.71%      34.374us       0.382us            90  
               aten::new_zeros         0.18%       8.503us         0.51%      24.500us       0.817us            30  
                   aten::empty         0.30%      14.252us         0.30%      14.252us       0.158us            90  
               aten::unsqueeze         0.21%      10.001us         0.26%      12.335us       0.411us            30  
                   aten::zero_         0.23%      11.120us         0.23%      11.120us       0.185us            60  
              aten::as_strided         0.16%       7.636us         0.16%       7.636us       0.064us           120  
               aten::new_empty         0.08%       3.832us         0.16%       7.624us       0.254us            30  
              aten::contiguous         0.06%       2.958us         0.06%       2.958us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.814ms

2026-02-08 10:46:55,089 - INFO - [5/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=99%
2026-02-08 10:46:55,167 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.49%     739.875us       100.00%       9.877ms     329.247us            30  
            aten::matmul         0.68%      66.883us        32.62%       3.222ms      53.695us            60  
               aten::bmm        30.13%       2.976ms        30.71%       3.033ms      50.557us            60  
           aten::softmax         0.12%      11.373us        26.27%       2.595ms      86.501us            30  
          aten::_softmax        26.16%       2.584ms        26.16%       2.584ms      86.122us            30  
       aten::masked_fill         0.27%      27.081us        19.52%       1.928ms      64.263us            30  
      aten::masked_fill_        13.90%       1.373ms        13.90%       1.373ms      45.757us            30  
               aten::div         9.55%     943.419us         9.84%     971.709us      32.390us            30  
             aten::clone         0.15%      14.665us         5.35%     528.084us      17.603us            30  
             aten::copy_         5.14%     507.295us         5.14%     507.295us       8.455us            60  
       aten::bitwise_not         3.74%     369.461us         3.74%     369.461us      12.315us            30  
           aten::reshape         0.25%      25.050us         0.57%      56.664us       0.472us           120  
            aten::expand         0.44%      43.800us         0.56%      55.214us       0.460us           120  
            aten::select         0.37%      36.832us         0.52%      51.041us       0.284us           180  
        aten::as_strided         0.36%      35.456us         0.36%      35.456us       0.098us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.877ms

2026-02-08 10:46:55,236 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        16.74%     747.834us       100.00%       4.468ms     148.943us            30  
                   aten::index_add_        35.69%       1.595ms        36.11%       1.613ms      53.777us            30  
                          aten::mul         9.82%     438.981us         9.82%     438.981us      14.633us            30  
                 aten::index_select         8.60%     384.280us         8.74%     390.364us       6.506us            60  
    extension_cpp::sparse_matmul_vo         7.56%     337.723us         7.77%     347.271us      11.576us            30  
                          aten::exp         7.33%     327.692us         7.33%     327.692us      10.923us            30  
                    aten::index_add         0.59%      26.370us         7.17%     320.451us      10.682us            30  
                 aten::scatter_add_         6.17%     275.697us         6.20%     276.868us       9.229us            30  
                          aten::div         1.13%      50.707us         1.71%      76.208us       1.270us            60  
                        aten::zeros         0.63%      27.955us         1.29%      57.620us       0.960us            60  
                       aten::select         0.68%      30.410us         0.88%      39.364us       0.328us           120  
                        aten::empty         0.77%      34.421us         0.77%      34.421us       0.191us           180  
                    aten::unsqueeze         0.58%      26.119us         0.70%      31.287us       0.521us            60  
                          aten::max         0.53%      23.623us         0.67%      30.081us       1.003us            30  
                      aten::squeeze         0.54%      24.329us         0.65%      29.120us       0.485us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.468ms

2026-02-08 10:46:55,282 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*        15.52%     175.070us       100.00%       1.128ms      37.593us            30  
    extension_cpp::sparse_attn        76.52%     862.987us        80.16%     904.067us      30.136us            30  
                 aten::squeeze         2.60%      29.282us         3.16%      35.665us       0.396us            90  
               aten::new_zeros         0.78%       8.750us         2.11%      23.829us       0.794us            30  
                   aten::empty         1.39%      15.707us         1.39%      15.707us       0.175us            90  
               aten::unsqueeze         0.96%      10.786us         1.15%      12.999us       0.433us            30  
                   aten::zero_         0.95%      10.747us         0.95%      10.747us       0.179us            60  
              aten::as_strided         0.76%       8.596us         0.76%       8.596us       0.072us           120  
               aten::new_empty         0.30%       3.372us         0.63%       7.122us       0.237us            30  
              aten::contiguous         0.22%       2.504us         0.22%       2.504us       0.028us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.128ms

2026-02-08 10:46:55,284 - INFO - [6/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=50%
2026-02-08 10:46:55,372 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.76%     864.634us       100.00%      15.007ms     500.224us            30  
       aten::masked_fill         0.18%      26.837us        43.99%       6.601ms     220.044us            30  
      aten::masked_fill_        40.25%       6.040ms        40.25%       6.040ms     201.323us            30  
            aten::matmul         0.45%      67.005us        22.66%       3.401ms      56.677us            60  
               aten::bmm        21.02%       3.155ms        21.40%       3.211ms      53.518us            60  
           aten::softmax         0.07%      10.498us        17.94%       2.693ms      89.761us            30  
          aten::_softmax        17.87%       2.682ms        17.87%       2.682ms      89.411us            30  
               aten::div         6.60%     990.633us         6.81%       1.021ms      34.048us            30  
             aten::clone         0.10%      14.459us         3.56%     534.797us      17.827us            30  
             aten::copy_         3.43%     514.796us         3.43%     514.796us       8.580us            60  
       aten::bitwise_not         2.50%     374.926us         2.50%     374.926us      12.498us            30  
           aten::reshape         0.19%      27.956us         0.40%      60.168us       0.501us           120  
            aten::expand         0.28%      41.374us         0.35%      52.666us       0.439us           120  
            aten::select         0.24%      36.159us         0.33%      49.702us       0.276us           180  
        aten::as_strided         0.23%      34.296us         0.23%      34.296us       0.095us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 15.007ms

2026-02-08 10:46:55,849 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.05%      12.358ms       100.00%     244.681ms       8.156ms            30  
                   aten::index_add_        33.86%      82.849ms        33.88%      82.890ms       2.763ms            30  
                 aten::index_select        24.92%      60.970ms        24.92%      60.979ms       1.016ms            60  
    extension_cpp::sparse_matmul_vo        15.03%      36.771ms        15.04%      36.791ms       1.226ms            30  
                          aten::mul        14.60%      35.717ms        14.60%      35.717ms       1.191ms            30  
                    aten::index_add         0.02%      41.172us         4.80%      11.744ms     391.465us            30  
                 aten::scatter_add_         4.77%      11.679ms         4.77%      11.681ms     389.377us            30  
                          aten::div         0.60%       1.466ms         0.63%       1.538ms      25.629us            60  
                          aten::exp         0.50%       1.226ms         0.50%       1.226ms      40.876us            30  
                          aten::max         0.22%     529.039us         0.22%     546.708us      18.224us            30  
                          aten::sub         0.19%     475.125us         0.19%     475.125us      15.838us            30  
                        aten::zeros         0.02%      47.253us         0.08%     199.499us       3.325us            60  
                        aten::zero_         0.01%      23.584us         0.05%     113.916us       1.899us            60  
                        aten::fill_         0.04%      93.832us         0.04%      93.832us       1.564us            60  
                       aten::select         0.03%      75.371us         0.04%      91.370us       0.761us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 244.681ms

2026-02-08 10:46:56,032 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.45%     349.954us       100.00%      77.911ms       2.597ms            30  
    extension_cpp::sparse_attn        99.38%      77.431ms        99.48%      77.510ms       2.584ms            30  
               aten::new_zeros         0.01%       9.210us         0.08%      60.582us       2.019us            30  
                   aten::zero_         0.01%       6.372us         0.06%      46.205us       0.770us            60  
                   aten::fill_         0.05%      39.833us         0.05%      39.833us       1.328us            30  
                 aten::squeeze         0.04%      31.177us         0.05%      37.171us       0.413us            90  
                   aten::empty         0.02%      16.415us         0.02%      16.415us       0.182us            90  
               aten::unsqueeze         0.02%      12.043us         0.02%      14.251us       0.475us            30  
              aten::as_strided         0.01%       8.202us         0.01%       8.202us       0.068us           120  
               aten::new_empty         0.00%       3.667us         0.01%       8.167us       0.272us            30  
              aten::contiguous         0.00%       2.793us         0.00%       2.793us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 77.911ms

2026-02-08 10:46:56,035 - INFO - [7/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=70%
2026-02-08 10:46:56,120 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.91%     736.467us       100.00%      12.454ms     415.145us            30  
       aten::masked_fill         0.22%      26.833us        36.78%       4.581ms     152.708us            30  
      aten::masked_fill_        32.46%       4.043ms        32.46%       4.043ms     134.764us            30  
            aten::matmul         0.55%      68.753us        24.90%       3.101ms      51.689us            60  
               aten::bmm        22.89%       2.851ms        23.36%       2.910ms      48.496us            60  
           aten::softmax         0.09%      11.292us        21.58%       2.688ms      89.599us            30  
          aten::_softmax        21.49%       2.677ms        21.49%       2.677ms      89.223us            30  
               aten::div         6.99%     870.463us         7.25%     903.545us      30.118us            30  
             aten::clone         0.12%      14.501us         4.11%     511.508us      17.050us            30  
             aten::copy_         3.96%     493.466us         3.96%     493.466us       8.224us            60  
       aten::bitwise_not         3.16%     394.124us         3.16%     394.124us      13.137us            30  
           aten::reshape         0.20%      25.461us         0.49%      61.338us       0.511us           120  
            aten::select         0.30%      37.337us         0.42%      51.920us       0.288us           180  
            aten::expand         0.32%      40.209us         0.42%      51.874us       0.432us           120  
        aten::as_strided         0.29%      35.791us         0.29%      35.791us       0.099us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.454ms

2026-02-08 10:46:56,422 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.47%       9.397ms       100.00%     145.301ms       4.843ms            30  
                   aten::index_add_        33.95%      49.335ms        33.97%      49.365ms       1.645ms            30  
                 aten::index_select        23.26%      33.799ms        23.27%      33.806ms     563.442us            60  
    extension_cpp::sparse_matmul_vo        15.18%      22.053ms        15.19%      22.068ms     735.607us            30  
                          aten::mul        13.97%      20.293ms        13.97%      20.293ms     676.443us            30  
                    aten::index_add         0.02%      35.415us         4.97%       7.226ms     240.866us            30  
                 aten::scatter_add_         4.93%       7.167ms         4.93%       7.168ms     238.940us            30  
                          aten::div         0.70%       1.014ms         0.74%       1.069ms      17.814us            60  
                          aten::exp         0.60%     871.339us         0.60%     871.339us      29.045us            30  
                          aten::max         0.32%     471.791us         0.33%     486.126us      16.204us            30  
                          aten::sub         0.28%     404.966us         0.28%     404.966us      13.499us            30  
                        aten::zeros         0.02%      34.217us         0.10%     151.755us       2.529us            60  
                        aten::zero_         0.01%      18.874us         0.06%      93.747us       1.562us            60  
                        aten::fill_         0.05%      77.538us         0.05%      77.538us       1.292us            60  
                       aten::select         0.04%      59.042us         0.05%      71.754us       0.598us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 145.301ms

2026-02-08 10:46:56,549 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.41%     191.093us       100.00%      46.673ms       1.556ms            30  
    extension_cpp::sparse_attn        99.31%      46.351ms        99.48%      46.428ms       1.548ms            30  
               aten::new_zeros         0.02%       8.996us         0.13%      58.997us       1.967us            30  
                   aten::zero_         0.01%       6.828us         0.10%      46.538us       0.776us            60  
                   aten::fill_         0.09%      39.710us         0.09%      39.710us       1.324us            30  
                 aten::squeeze         0.07%      32.664us         0.08%      38.829us       0.431us            90  
                   aten::empty         0.03%      15.042us         0.03%      15.042us       0.167us            90  
               aten::unsqueeze         0.03%      11.952us         0.03%      14.539us       0.485us            30  
              aten::as_strided         0.02%       8.752us         0.02%       8.752us       0.073us           120  
               aten::new_empty         0.01%       3.583us         0.01%       6.750us       0.225us            30  
              aten::contiguous         0.01%       2.916us         0.01%       2.916us       0.032us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 46.673ms

2026-02-08 10:46:56,551 - INFO - [8/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=90%
2026-02-08 10:46:56,634 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.66%     813.932us       100.00%      10.626ms     354.187us            30  
            aten::matmul         0.64%      67.708us        28.73%       3.053ms      50.884us            60  
               aten::bmm        26.37%       2.802ms        26.95%       2.864ms      47.728us            60  
       aten::masked_fill         0.27%      28.253us        25.73%       2.734ms      91.140us            30  
           aten::softmax         0.11%      11.459us        25.36%       2.694ms      89.813us            30  
          aten::_softmax        25.25%       2.683ms        25.25%       2.683ms      89.431us            30  
      aten::masked_fill_        20.08%       2.133ms        20.08%       2.133ms      71.108us            30  
               aten::div         8.05%     855.856us         8.36%     888.772us      29.626us            30  
             aten::clone         0.14%      14.789us         5.39%     572.698us      19.090us            30  
             aten::copy_         5.20%     552.824us         5.20%     552.824us       9.214us            60  
       aten::bitwise_not         3.69%     391.907us         3.69%     391.907us      13.064us            30  
           aten::reshape         0.23%      24.498us         0.57%      60.207us       0.502us           120  
            aten::select         0.38%      40.472us         0.52%      54.836us       0.305us           180  
            aten::expand         0.38%      40.082us         0.49%      51.580us       0.430us           120  
        aten::as_strided         0.33%      35.404us         0.33%      35.404us       0.098us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 10.626ms

2026-02-08 10:46:56,772 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.38%       3.464ms       100.00%      46.933ms       1.564ms            30  
                   aten::index_add_        33.70%      15.815ms        33.75%      15.839ms     527.968us            30  
                 aten::index_select        22.19%      10.415ms        22.20%      10.419ms     173.653us            60  
    extension_cpp::sparse_matmul_vo        15.76%       7.394ms        15.78%       7.404ms     246.811us            30  
                          aten::mul        12.55%       5.892ms        12.55%       5.892ms     196.413us            30  
                    aten::index_add         0.06%      28.297us         5.72%       2.687ms      89.563us            30  
                 aten::scatter_add_         5.62%       2.639ms         5.62%       2.640ms      87.995us            30  
                          aten::exp         1.12%     526.248us         1.12%     526.248us      17.542us            30  
                          aten::div         0.54%     251.919us         0.60%     282.004us       4.700us            60  
                        aten::zeros         0.06%      27.170us         0.31%     145.211us       2.420us            60  
                          aten::max         0.22%     104.998us         0.24%     111.539us       3.718us            30  
                        aten::zero_         0.02%      11.504us         0.21%      99.878us       1.665us            60  
                        aten::fill_         0.19%      89.791us         0.19%      89.791us       1.497us            60  
                          aten::sub         0.12%      54.046us         0.12%      54.046us       1.802us            30  
                       aten::select         0.09%      39.915us         0.11%      49.872us       0.416us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 46.933ms

2026-02-08 10:46:56,850 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.45%     229.621us       100.00%      15.860ms     528.680us            30  
    extension_cpp::sparse_attn        97.48%      15.460ms        98.24%      15.581ms     519.358us            30  
               aten::new_zeros         0.05%       8.503us         0.65%     103.169us       3.439us            30  
                   aten::zero_         0.04%       6.793us         0.57%      89.791us       1.497us            60  
                   aten::fill_         0.52%      82.998us         0.52%      82.998us       2.767us            30  
                 aten::squeeze         0.19%      30.592us         0.23%      36.457us       0.405us            90  
                   aten::empty         0.09%      15.004us         0.09%      15.004us       0.167us            90  
               aten::unsqueeze         0.07%      11.040us         0.09%      13.584us       0.453us            30  
              aten::as_strided         0.05%       8.409us         0.05%       8.409us       0.070us           120  
               aten::new_empty         0.03%       4.164us         0.05%       8.250us       0.275us            30  
              aten::contiguous         0.02%       2.915us         0.02%       2.915us       0.032us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 15.860ms

2026-02-08 10:46:56,853 - INFO - [9/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=95%
2026-02-08 10:46:56,943 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        10.40%       1.305ms       100.00%      12.550ms     418.322us            30  
            aten::matmul         0.54%      67.316us        35.94%       4.510ms      75.174us            60  
               aten::bmm        33.96%       4.262ms        34.43%       4.321ms      72.009us            60  
           aten::softmax         0.09%      10.996us        23.08%       2.897ms      96.564us            30  
          aten::_softmax        23.00%       2.886ms        23.00%       2.886ms      96.198us            30  
       aten::masked_fill         0.23%      28.258us        18.86%       2.367ms      78.896us            30  
      aten::masked_fill_        14.36%       1.802ms        14.36%       1.802ms      60.077us            30  
               aten::div         7.91%     992.378us         8.17%       1.026ms      34.185us            30  
             aten::clone         0.12%      14.913us         4.27%     536.333us      17.878us            30  
             aten::copy_         4.11%     515.872us         4.11%     515.872us       8.598us            60  
       aten::bitwise_not         3.14%     394.124us         3.14%     394.124us      13.137us            30  
           aten::reshape         0.21%      26.759us         0.50%      62.513us       0.521us           120  
            aten::select         0.30%      37.087us         0.41%      52.081us       0.289us           180  
            aten::expand         0.31%      39.329us         0.41%      50.956us       0.425us           120  
        aten::as_strided         0.29%      36.368us         0.29%      36.368us       0.101us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.550ms

2026-02-08 10:46:57,043 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         9.46%       2.226ms       100.00%      23.523ms     784.115us            30  
                   aten::index_add_        33.89%       7.971ms        33.98%       7.994ms     266.463us            30  
                 aten::index_select        19.75%       4.647ms        19.77%       4.651ms      77.523us            60  
    extension_cpp::sparse_matmul_vo        15.59%       3.668ms        15.64%       3.679ms     122.632us            30  
                          aten::mul        10.97%       2.580ms        10.97%       2.580ms      86.012us            30  
                    aten::index_add         0.11%      26.670us         6.50%       1.528ms      50.935us            30  
                 aten::scatter_add_         6.30%       1.482ms         6.31%       1.483ms      49.443us            30  
                          aten::exp         1.73%     408.002us         1.73%     408.002us      13.600us            30  
                          aten::div         0.43%     100.757us         0.54%     127.006us       2.117us            60  
                        aten::zeros         0.11%      26.377us         0.52%     122.547us       2.042us            60  
                        aten::zero_         0.04%       9.626us         0.33%      78.003us       1.300us            60  
                        aten::fill_         0.30%      69.965us         0.30%      69.965us       1.166us            60  
                          aten::max         0.25%      58.539us         0.28%      65.291us       2.176us            30  
                       aten::select         0.16%      37.707us         0.20%      46.953us       0.391us           120  
                          aten::sub         0.19%      44.167us         0.19%      44.167us       1.472us            30  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 23.523ms

2026-02-08 10:46:57,104 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         2.23%     174.498us       100.00%       7.820ms     260.664us            30  
    extension_cpp::sparse_attn        96.18%       7.521ms        97.16%       7.598ms     253.273us            30  
               aten::new_zeros         0.11%       8.836us         0.77%      60.168us       2.006us            30  
                   aten::zero_         0.08%       6.622us         0.60%      46.624us       0.777us            60  
                   aten::fill_         0.51%      40.002us         0.51%      40.002us       1.333us            30  
                 aten::squeeze         0.37%      28.682us         0.44%      34.421us       0.382us            90  
                   aten::empty         0.19%      14.708us         0.19%      14.708us       0.163us            90  
               aten::unsqueeze         0.13%      10.538us         0.16%      12.829us       0.428us            30  
              aten::as_strided         0.10%       8.030us         0.10%       8.030us       0.067us           120  
               aten::new_empty         0.05%       4.251us         0.10%       7.792us       0.260us            30  
              aten::contiguous         0.03%       2.373us         0.03%       2.373us       0.026us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.820ms

2026-02-08 10:46:57,106 - INFO - [10/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=99%
2026-02-08 10:46:57,187 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.84%     987.556us       100.00%      10.039ms     334.638us            30  
            aten::matmul         0.63%      63.212us        32.02%       3.215ms      53.582us            60  
               aten::bmm        29.71%       2.982ms        30.27%       3.039ms      50.654us            60  
           aten::softmax         0.10%      10.497us        26.11%       2.621ms      87.366us            30  
          aten::_softmax        26.00%       2.610ms        26.00%       2.610ms      87.017us            30  
       aten::masked_fill         0.27%      27.205us        19.38%       1.945ms      64.843us            30  
      aten::masked_fill_        13.26%       1.331ms        13.26%       1.331ms      44.376us            30  
               aten::div         8.26%     828.803us         8.57%     860.427us      28.681us            30  
             aten::clone         0.14%      13.915us         5.85%     586.798us      19.560us            30  
             aten::copy_         5.66%     568.385us         5.66%     568.385us       9.473us            60  
       aten::bitwise_not         3.62%     363.461us         3.62%     363.461us      12.115us            30  
           aten::reshape         0.23%      23.212us         0.56%      55.914us       0.466us           120  
            aten::select         0.37%      37.017us         0.50%      50.635us       0.281us           180  
            aten::expand         0.36%      36.463us         0.47%      47.337us       0.394us           120  
        aten::as_strided         0.33%      33.116us         0.33%      33.116us       0.092us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 10.039ms

2026-02-08 10:46:57,257 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        17.93%       1.022ms       100.00%       5.699ms     189.979us            30  
                   aten::index_add_        33.07%       1.885ms        33.65%       1.918ms      63.921us            30  
    extension_cpp::sparse_matmul_vo        13.57%     773.550us        13.74%     783.255us      26.108us            30  
                          aten::mul         9.67%     551.251us         9.67%     551.251us      18.375us            30  
                 aten::index_select         7.48%     426.219us         7.59%     432.511us       7.209us            60  
                          aten::exp         5.82%     331.463us         5.82%     331.463us      11.049us            30  
                    aten::index_add         0.44%      25.089us         5.59%     318.834us      10.628us            30  
                 aten::scatter_add_         4.85%     276.244us         4.86%     277.165us       9.239us            30  
                        aten::zeros         0.45%      25.922us         2.06%     117.460us       1.958us            60  
                          aten::div         0.89%      50.834us         1.34%      76.378us       1.273us            60  
                        aten::zero_         0.16%       9.161us         1.30%      74.247us       1.237us            60  
                        aten::fill_         1.16%      66.376us         1.16%      66.376us       1.106us            60  
                       aten::select         0.81%      46.300us         0.99%      56.171us       0.468us           120  
                        aten::empty         0.63%      36.081us         0.63%      36.081us       0.200us           180  
                    aten::unsqueeze         0.45%      25.871us         0.54%      30.958us       0.516us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 5.699ms

2026-02-08 10:46:57,305 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         9.78%     173.899us       100.00%       1.778ms      59.254us            30  
    extension_cpp::sparse_attn        83.37%       1.482ms        87.58%       1.557ms      51.893us            30  
               aten::new_zeros         0.49%       8.796us         3.26%      57.967us       1.932us            30  
                   aten::zero_         0.31%       5.545us         2.54%      45.215us       0.754us            60  
                   aten::fill_         2.23%      39.670us         2.23%      39.670us       1.322us            30  
                 aten::squeeze         1.62%      28.811us         1.93%      34.245us       0.380us            90  
                   aten::empty         0.82%      14.543us         0.82%      14.543us       0.162us            90  
               aten::unsqueeze         0.59%      10.415us         0.71%      12.669us       0.422us            30  
              aten::as_strided         0.43%       7.688us         0.43%       7.688us       0.064us           120  
               aten::new_empty         0.20%       3.628us         0.37%       6.628us       0.221us            30  
              aten::contiguous         0.15%       2.582us         0.15%       2.582us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.778ms

2026-02-08 10:46:57,308 - INFO - [11/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=50%
2026-02-08 10:46:57,398 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.68%       1.407ms       100.00%      16.219ms     540.628us            30  
       aten::masked_fill         0.16%      26.413us        42.19%       6.843ms     228.085us            30  
      aten::masked_fill_        38.31%       6.213ms        38.31%       6.213ms     207.100us            30  
            aten::matmul         0.38%      61.743us        25.08%       4.068ms      67.805us            60  
               aten::bmm        23.65%       3.836ms        23.99%       3.891ms      64.844us            60  
           aten::softmax         0.06%      10.338us        16.31%       2.645ms      88.158us            30  
          aten::_softmax        16.24%       2.634ms        16.24%       2.634ms      87.813us            30  
               aten::div         4.95%     803.012us         5.14%     833.554us      27.785us            30  
             aten::clone         0.09%      14.039us         3.72%     603.132us      20.104us            30  
             aten::copy_         3.60%     583.761us         3.60%     583.761us       9.729us            60  
       aten::bitwise_not         2.31%     374.914us         2.31%     374.914us      12.497us            30  
           aten::reshape         0.14%      23.087us         0.35%      56.584us       0.472us           120  
            aten::expand         0.24%      39.668us         0.31%      50.462us       0.421us           120  
            aten::select         0.22%      35.749us         0.30%      49.076us       0.273us           180  
        aten::as_strided         0.20%      32.831us         0.20%      32.831us       0.091us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 16.219ms

2026-02-08 10:46:58,237 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         8.24%      37.054ms       100.00%     449.808ms      14.994ms            30  
                 aten::index_select        27.84%     125.218ms        27.84%     125.228ms       2.087ms            60  
    extension_cpp::sparse_matmul_vo        23.12%     103.983ms        23.13%     104.024ms       3.467ms            30  
                   aten::index_add_        20.93%      94.149ms        20.95%      94.216ms       3.141ms            30  
                          aten::mul        16.17%      72.718ms        16.17%      72.718ms       2.424ms            30  
                    aten::index_add         0.01%      56.501us         2.64%      11.869ms     395.642us            30  
                 aten::scatter_add_         2.62%      11.781ms         2.62%      11.783ms     392.772us            30  
                          aten::div         0.30%       1.368ms         0.33%       1.481ms      24.689us            60  
                          aten::exp         0.25%       1.105ms         0.25%       1.105ms      36.819us            30  
                        aten::zeros         0.02%      76.866us         0.16%     718.662us      11.978us            60  
                          aten::max         0.13%     571.455us         0.13%     593.458us      19.782us            30  
                        aten::zero_         0.01%      35.418us         0.13%     579.878us       9.665us            60  
                        aten::fill_         0.12%     549.090us         0.12%     549.090us       9.152us            60  
                          aten::sub         0.11%     494.589us         0.11%     494.589us      16.486us            30  
                        aten::empty         0.03%     126.287us         0.03%     126.287us       0.702us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 449.808ms

2026-02-08 10:46:58,565 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.23%     376.498us       100.00%     167.017ms       5.567ms            30  
    extension_cpp::sparse_attn        99.48%     166.155ms        99.74%     166.584ms       5.553ms            30  
               aten::new_zeros         0.01%      14.455us         0.25%     409.626us      13.654us            30  
                   aten::zero_         0.01%      12.498us         0.23%     390.337us       6.506us            60  
                   aten::fill_         0.23%     377.839us         0.23%     377.839us      12.595us            30  
                 aten::squeeze         0.02%      32.744us         0.02%      38.752us       0.431us            90  
               aten::unsqueeze         0.01%      15.165us         0.01%      17.789us       0.593us            30  
                   aten::empty         0.01%      17.046us         0.01%      17.046us       0.189us            90  
               aten::new_empty         0.00%       4.502us         0.01%       8.835us       0.294us            30  
              aten::as_strided         0.01%       8.632us         0.01%       8.632us       0.072us           120  
              aten::contiguous         0.00%       2.662us         0.00%       2.662us       0.030us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 167.017ms

2026-02-08 10:46:58,567 - INFO - [12/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=70%
2026-02-08 10:46:58,660 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.60%       1.277ms       100.00%      14.845ms     494.823us            30  
            aten::matmul         0.42%      62.037us        31.90%       4.735ms      78.922us            60  
       aten::masked_fill         0.19%      27.833us        31.63%       4.696ms     156.535us            30  
               aten::bmm        30.36%       4.507ms        30.71%       4.559ms      75.984us            60  
      aten::masked_fill_        27.97%       4.153ms        27.97%       4.153ms     138.426us            30  
           aten::softmax         0.08%      11.415us        18.22%       2.705ms      90.167us            30  
          aten::_softmax        18.15%       2.694ms        18.15%       2.694ms      89.786us            30  
               aten::div         6.45%     957.653us         6.67%     989.816us      32.994us            30  
             aten::clone         0.10%      15.337us         3.47%     515.453us      17.182us            30  
             aten::copy_         3.34%     495.739us         3.34%     495.739us       8.262us            60  
       aten::bitwise_not         2.65%     393.162us         2.65%     393.162us      13.105us            30  
           aten::reshape         0.16%      23.338us         0.37%      54.836us       0.457us           120  
            aten::expand         0.27%      39.464us         0.34%      50.505us       0.421us           120  
            aten::select         0.23%      33.591us         0.31%      46.166us       0.256us           180  
        aten::as_strided         0.22%      32.280us         0.22%      32.280us       0.090us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 14.845ms

2026-02-08 10:46:59,172 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         9.01%      24.284ms       100.00%     269.403ms       8.980ms            30  
                 aten::index_select        26.47%      71.306ms        26.47%      71.315ms       1.189ms            60  
    extension_cpp::sparse_matmul_vo        23.35%      62.893ms        23.36%      62.924ms       2.097ms            30  
                   aten::index_add_        20.94%      56.421ms        20.96%      56.472ms       1.882ms            30  
                          aten::mul        16.06%      43.272ms        16.06%      43.272ms       1.442ms            30  
                    aten::index_add         0.02%      46.998us         2.71%       7.304ms     243.451us            30  
                 aten::scatter_add_         2.68%       7.228ms         2.68%       7.230ms     241.002us            30  
                          aten::div         0.40%       1.085ms         0.44%       1.175ms      19.587us            60  
                          aten::exp         0.32%     870.341us         0.32%     870.341us      29.011us            30  
                        aten::zeros         0.02%      60.165us         0.23%     630.338us      10.506us            60  
                        aten::zero_         0.01%      29.711us         0.20%     526.585us       8.776us            60  
                          aten::max         0.18%     496.464us         0.19%     515.044us      17.168us            30  
                        aten::fill_         0.19%     501.207us         0.19%     501.207us       8.353us            60  
                          aten::sub         0.15%     395.171us         0.15%     395.171us      13.172us            30  
                       aten::select         0.03%      85.126us         0.04%     103.374us       0.861us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 269.403ms

2026-02-08 10:46:59,388 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.53%     537.461us       100.00%     100.809ms       3.360ms            30  
    extension_cpp::sparse_attn        98.96%      99.764ms        99.41%     100.216ms       3.341ms            30  
               aten::new_zeros         0.01%      13.960us         0.43%     431.883us      14.396us            30  
                   aten::zero_         0.01%      12.000us         0.41%     412.753us       6.879us            60  
                   aten::fill_         0.40%     400.753us         0.40%     400.753us      13.358us            30  
                 aten::squeeze         0.03%      32.582us         0.04%      38.874us       0.432us            90  
                   aten::empty         0.02%      17.659us         0.02%      17.659us       0.196us            90  
               aten::unsqueeze         0.01%      14.538us         0.02%      17.333us       0.578us            30  
              aten::as_strided         0.01%       9.087us         0.01%       9.087us       0.076us           120  
               aten::new_empty         0.00%       3.963us         0.01%       8.919us       0.297us            30  
              aten::contiguous         0.00%       3.041us         0.00%       3.041us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 100.809ms

2026-02-08 10:46:59,390 - INFO - [13/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=90%
2026-02-08 10:46:59,478 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.40%       1.224ms       100.00%      13.021ms     434.019us            30  
            aten::matmul         0.48%      62.472us        38.25%       4.980ms      83.006us            60  
               aten::bmm        36.50%       4.753ms        36.92%       4.808ms      80.128us            60  
       aten::masked_fill         0.22%      28.622us        21.83%       2.843ms      94.755us            30  
           aten::softmax         0.08%      10.455us        20.49%       2.668ms      88.945us            30  
          aten::_softmax        20.41%       2.658ms        20.41%       2.658ms      88.596us            30  
      aten::masked_fill_        17.38%       2.263ms        17.38%       2.263ms      75.446us            30  
               aten::div         6.38%     830.633us         6.62%     861.384us      28.713us            30  
             aten::clone         0.12%      15.045us         4.23%     550.630us      18.354us            30  
             aten::copy_         4.07%     529.792us         4.07%     529.792us       8.830us            60  
       aten::bitwise_not         3.05%     396.713us         3.05%     396.713us      13.224us            30  
           aten::reshape         0.18%      23.286us         0.42%      54.076us       0.451us           120  
            aten::select         0.28%      36.222us         0.38%      49.174us       0.273us           180  
            aten::expand         0.28%      36.578us         0.36%      47.291us       0.394us           120  
        aten::as_strided         0.25%      32.206us         0.25%      32.206us       0.089us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 13.021ms

2026-02-08 10:46:59,667 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.54%       4.957ms       100.00%      75.817ms       2.527ms            30  
    extension_cpp::sparse_matmul_vo        27.21%      20.633ms        27.24%      20.651ms     688.376us            30  
                 aten::index_select        27.03%      20.492ms        27.04%      20.497ms     341.623us            60  
                   aten::index_add_        24.17%      18.327ms        24.21%      18.357ms     611.909us            30  
                          aten::mul         9.30%       7.049ms         9.30%       7.049ms     234.980us            30  
                    aten::index_add         0.05%      36.758us         3.56%       2.700ms      90.002us            30  
                 aten::scatter_add_         3.48%       2.640ms         3.48%       2.641ms      88.043us            30  
                          aten::exp         0.70%     531.421us         0.70%     531.421us      17.714us            30  
                        aten::zeros         0.04%      31.915us         0.70%     528.290us       8.805us            60  
                        aten::zero_         0.02%      16.501us         0.62%     473.749us       7.896us            60  
                        aten::fill_         0.61%     458.834us         0.61%     458.834us       7.647us            60  
                          aten::div         0.26%     195.002us         0.31%     236.541us       3.942us            60  
                          aten::max         0.14%     109.790us         0.15%     117.250us       3.908us            30  
                       aten::select         0.07%      50.867us         0.08%      62.457us       0.520us           120  
                          aten::sub         0.08%      57.461us         0.08%      57.461us       1.915us            30  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 75.817ms

2026-02-08 10:46:59,772 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.65%     222.844us       100.00%      34.311ms       1.144ms            30  
    extension_cpp::sparse_attn        97.92%      33.599ms        99.18%      34.030ms       1.134ms            30  
               aten::new_zeros         0.04%      13.376us         1.20%     412.086us      13.736us            30  
                   aten::zero_         0.03%      11.465us         1.15%     394.630us       6.577us            60  
                   aten::fill_         1.12%     383.165us         1.12%     383.165us      12.772us            30  
                 aten::squeeze         0.10%      33.831us         0.12%      39.998us       0.444us            90  
               aten::unsqueeze         0.04%      15.043us         0.05%      17.958us       0.599us            30  
                   aten::empty         0.05%      17.249us         0.05%      17.249us       0.192us            90  
              aten::as_strided         0.03%       9.082us         0.03%       9.082us       0.076us           120  
               aten::new_empty         0.01%       3.915us         0.02%       7.831us       0.261us            30  
              aten::contiguous         0.01%       2.750us         0.01%       2.750us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 34.311ms

2026-02-08 10:46:59,775 - INFO - [14/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=95%
2026-02-08 10:46:59,863 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.74%       1.131ms       100.00%      12.936ms     431.203us            30  
            aten::matmul         0.49%      63.070us        42.18%       5.457ms      90.947us            60  
               aten::bmm        40.37%       5.222ms        40.80%       5.278ms      87.965us            60  
           aten::softmax         0.08%      10.129us        20.95%       2.710ms      90.324us            30  
          aten::_softmax        20.87%       2.700ms        20.87%       2.700ms      89.987us            30  
       aten::masked_fill         0.21%      27.416us        17.32%       2.241ms      74.685us            30  
      aten::masked_fill_        12.95%       1.675ms        12.95%       1.675ms      55.849us            30  
               aten::div         7.06%     913.676us         7.31%     945.591us      31.520us            30  
             aten::clone         0.12%      14.881us         4.16%     537.671us      17.922us            30  
             aten::copy_         4.01%     518.332us         4.01%     518.332us       8.639us            60  
       aten::bitwise_not         3.12%     404.204us         3.12%     404.204us      13.473us            30  
           aten::reshape         0.19%      24.669us         0.45%      58.044us       0.484us           120  
            aten::select         0.27%      35.154us         0.38%      49.124us       0.273us           180  
            aten::expand         0.29%      37.639us         0.38%      48.592us       0.405us           120  
        aten::as_strided         0.27%      34.299us         0.27%      34.299us       0.095us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.936ms

2026-02-08 10:47:00,001 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         9.00%       3.819ms       100.00%      42.412ms       1.414ms            30  
                 aten::index_select        24.63%      10.445ms        24.64%      10.450ms     174.164us            60  
    extension_cpp::sparse_matmul_vo        23.95%      10.156ms        23.98%      10.169ms     338.963us            30  
                   aten::index_add_        21.30%       9.033ms        21.35%       9.057ms     301.897us            30  
                          aten::mul        14.32%       6.072ms        14.32%       6.072ms     202.390us            30  
                    aten::index_add         0.07%      31.210us         3.62%       1.536ms      51.203us            30  
                 aten::scatter_add_         3.50%       1.483ms         3.50%       1.484ms      49.474us            30  
                        aten::zeros         0.07%      30.289us         1.27%     539.340us       8.989us            60  
                        aten::zero_         0.04%      15.839us         1.15%     489.636us       8.161us            60  
                        aten::fill_         1.12%     475.131us         1.12%     475.131us       7.919us            60  
                          aten::exp         0.97%     411.176us         0.97%     411.176us      13.706us            30  
                          aten::div         0.26%     109.830us         0.33%     141.957us       2.366us            60  
                          aten::max         0.14%      60.497us         0.16%      67.164us       2.239us            30  
                       aten::select         0.10%      41.332us         0.12%      51.618us       0.430us           120  
                        aten::empty         0.09%      39.667us         0.09%      39.667us       0.220us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 42.412ms

2026-02-08 10:47:00,077 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.20%     209.000us       100.00%      17.392ms     579.726us            30  
    extension_cpp::sparse_attn        96.14%      16.721ms        98.48%      17.127ms     570.890us            30  
               aten::new_zeros         0.08%      13.741us         2.22%     386.831us      12.894us            30  
                   aten::zero_         0.07%      11.837us         2.13%     370.377us       6.173us            60  
                   aten::fill_         2.06%     358.540us         2.06%     358.540us      11.951us            30  
                 aten::squeeze         0.19%      32.873us         0.22%      38.750us       0.431us            90  
               aten::unsqueeze         0.08%      14.497us         0.10%      17.330us       0.578us            30  
                   aten::empty         0.09%      15.750us         0.09%      15.750us       0.175us            90  
              aten::as_strided         0.05%       8.710us         0.05%       8.710us       0.073us           120  
               aten::new_empty         0.02%       3.587us         0.04%       7.004us       0.233us            30  
              aten::contiguous         0.01%       2.506us         0.01%       2.506us       0.028us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 17.392ms

2026-02-08 10:47:00,080 - INFO - [15/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=99%
2026-02-08 10:47:00,167 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.92%       1.136ms       100.00%      12.733ms     424.446us            30  
            aten::matmul         0.47%      59.290us        43.97%       5.598ms      93.308us            60  
               aten::bmm        42.24%       5.378ms        42.64%       5.430ms      90.493us            60  
           aten::softmax         0.08%       9.918us        20.62%       2.626ms      87.521us            30  
          aten::_softmax        20.54%       2.616ms        20.54%       2.616ms      87.190us            30  
       aten::masked_fill         0.22%      27.626us        15.11%       1.924ms      64.131us            30  
      aten::masked_fill_        10.76%       1.370ms        10.76%       1.370ms      45.666us            30  
               aten::div         7.65%     974.612us         7.88%       1.003ms      33.450us            30  
             aten::clone         0.12%      14.878us         4.13%     526.327us      17.544us            30  
             aten::copy_         3.97%     505.281us         3.97%     505.281us       8.421us            60  
       aten::bitwise_not         3.15%     400.663us         3.15%     400.663us      13.355us            30  
           aten::reshape         0.19%      24.660us         0.44%      55.869us       0.466us           120  
            aten::select         0.26%      33.720us         0.36%      45.918us       0.255us           180  
            aten::expand         0.27%      34.999us         0.36%      45.249us       0.377us           120  
        aten::as_strided         0.24%      30.659us         0.24%      30.659us       0.085us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.733ms

2026-02-08 10:47:00,240 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        10.50%     849.447us       100.00%       8.087ms     269.569us            30  
    extension_cpp::sparse_matmul_vo        25.63%       2.073ms        25.76%       2.083ms      69.428us            30  
                   aten::index_add_        24.17%       1.955ms        24.49%       1.980ms      66.009us            30  
                 aten::index_select        12.60%       1.019ms        12.67%       1.025ms      17.081us            60  
                          aten::mul        10.93%     883.858us        10.93%     883.858us      29.462us            30  
                        aten::zeros         0.34%      27.788us         5.05%     408.696us       6.812us            60  
                        aten::zero_         0.15%      11.960us         4.51%     364.784us       6.080us            60  
                        aten::fill_         4.38%     354.074us         4.38%     354.074us       5.901us            60  
                    aten::index_add         0.32%      25.871us         3.99%     322.449us      10.748us            30  
                          aten::exp         3.84%     310.661us         3.84%     310.661us      10.355us            30  
                 aten::scatter_add_         3.45%     279.082us         3.46%     280.079us       9.336us            30  
                          aten::div         0.63%      51.333us         0.95%      76.999us       1.283us            60  
                       aten::select         0.48%      38.538us         0.61%      49.123us       0.409us           120  
                        aten::empty         0.44%      35.289us         0.44%      35.289us       0.196us           180  
                          aten::max         0.30%      23.912us         0.37%      30.039us       1.001us            30  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 8.087ms

2026-02-08 10:47:00,293 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         5.67%     242.258us       100.00%       4.272ms     142.385us            30  
    extension_cpp::sparse_attn        83.75%       3.577ms        92.92%       3.969ms     132.300us            30  
               aten::new_zeros         0.32%      13.787us         8.70%     371.507us      12.384us            30  
                   aten::zero_         0.26%      11.164us         8.30%     354.426us       5.907us            60  
                   aten::fill_         8.04%     343.262us         8.04%     343.262us      11.442us            30  
                 aten::squeeze         0.74%      31.626us         0.88%      37.747us       0.419us            90  
               aten::unsqueeze         0.44%      18.916us         0.53%      22.539us       0.751us            30  
                   aten::empty         0.40%      17.249us         0.40%      17.249us       0.192us            90  
              aten::as_strided         0.23%       9.744us         0.23%       9.744us       0.081us           120  
               aten::new_empty         0.08%       3.374us         0.17%       7.083us       0.236us            30  
              aten::contiguous         0.07%       2.793us         0.07%       2.793us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.272ms

2026-02-08 10:47:00,295 - INFO - [16/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=50%
2026-02-08 10:47:00,466 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.55%       4.456ms       100.00%      59.039ms       1.968ms            30  
       aten::masked_fill         0.05%      31.423us        46.09%      27.209ms     906.979us            30  
      aten::masked_fill_        40.50%      23.909ms        40.50%      23.909ms     796.966us            30  
            aten::matmul         0.11%      64.995us        20.97%      12.382ms     206.373us            60  
               aten::bmm        20.55%      12.132ms        20.64%      12.185ms     203.087us            60  
           aten::softmax         0.02%      11.294us        17.53%      10.349ms     344.969us            30  
          aten::_softmax        17.51%      10.338ms        17.51%      10.338ms     344.593us            30  
               aten::div         5.78%       3.411ms         5.84%       3.451ms     115.020us            30  
             aten::clone         0.03%      15.584us         5.54%       3.269ms     108.965us            30  
             aten::copy_         5.50%       3.248ms         5.50%       3.248ms      54.126us            60  
       aten::bitwise_not         1.92%       1.135ms         1.92%       1.135ms      37.845us            30  
           aten::reshape         0.04%      26.283us         0.12%      68.952us       0.575us           120  
            aten::expand         0.07%      43.545us         0.09%      54.382us       0.453us           120  
            aten::select         0.06%      34.044us         0.08%      48.131us       0.267us           180  
                aten::to         0.01%       6.035us         0.07%      39.536us       1.318us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 59.039ms

2026-02-08 10:47:01,662 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.73%      38.809ms       100.00%     677.319ms      22.577ms            30  
                   aten::index_add_        45.23%     306.344ms        45.24%     306.400ms      10.213ms            30  
                 aten::index_select        20.33%     137.725ms        20.34%     137.734ms       2.296ms            60  
                          aten::mul        10.94%      74.097ms        10.94%      74.097ms       2.470ms            30  
    extension_cpp::sparse_matmul_vo         9.17%      62.129ms         9.18%      62.175ms       2.072ms            30  
                    aten::index_add         0.01%      66.498us         6.82%      46.194ms       1.540ms            30  
                 aten::scatter_add_         6.80%      46.083ms         6.80%      46.086ms       1.536ms            30  
                          aten::div         0.67%       4.534ms         0.69%       4.662ms      77.703us            60  
                          aten::exp         0.56%       3.812ms         0.56%       3.812ms     127.052us            30  
                          aten::sub         0.26%       1.781ms         0.26%       1.781ms      59.368us            30  
                          aten::max         0.15%       1.013ms         0.15%       1.034ms      34.465us            30  
                        aten::zeros         0.01%      70.585us         0.05%     318.627us       5.310us            60  
                        aten::zero_         0.01%      38.417us         0.03%     185.415us       3.090us            60  
                        aten::fill_         0.02%     152.918us         0.02%     152.918us       2.549us            60  
                           aten::to         0.00%      19.540us         0.02%     131.207us       2.187us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 677.319ms

2026-02-08 10:47:02,043 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.74%       1.492ms       100.00%     201.499ms       6.717ms            30  
    extension_cpp::sparse_attn        99.17%     199.824ms        99.22%     199.934ms       6.664ms            30  
               aten::new_zeros         0.01%      12.665us         0.04%      80.748us       2.692us            30  
                   aten::zero_         0.01%      12.084us         0.03%      63.501us       1.058us            60  
                   aten::fill_         0.03%      51.417us         0.03%      51.417us       1.714us            30  
                 aten::squeeze         0.02%      40.962us         0.02%      48.625us       0.540us            90  
                   aten::empty         0.01%      24.533us         0.01%      24.533us       0.273us            90  
               aten::unsqueeze         0.01%      19.622us         0.01%      24.123us       0.804us            30  
              aten::as_strided         0.01%      12.164us         0.01%      12.164us       0.101us           120  
               aten::new_empty         0.00%       5.587us         0.01%      11.958us       0.399us            30  
              aten::contiguous         0.00%       3.419us         0.00%       3.419us       0.038us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 201.499ms

2026-02-08 10:47:02,045 - INFO - [17/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=70%
2026-02-08 10:47:02,201 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.23%       4.637ms       100.00%      50.226ms       1.674ms            30  
       aten::masked_fill         0.07%      33.537us        36.63%      18.399ms     613.301us            30  
      aten::masked_fill_        30.22%      15.176ms        30.22%      15.176ms     505.883us            30  
            aten::matmul         0.13%      65.534us        24.87%      12.493ms     208.223us            60  
               aten::bmm        24.38%      12.246ms        24.49%      12.299ms     204.990us            60  
           aten::softmax         0.02%      11.239us        19.86%       9.977ms     332.573us            30  
          aten::_softmax        19.84%       9.966ms        19.84%       9.966ms     332.198us            30  
               aten::div         6.96%       3.496ms         7.04%       3.535ms     117.824us            30  
             aten::clone         0.03%      16.952us         6.35%       3.189ms     106.301us            30  
             aten::copy_         6.30%       3.166ms         6.30%       3.166ms      52.772us            60  
       aten::bitwise_not         2.26%       1.134ms         2.26%       1.134ms      37.786us            30  
           aten::reshape         0.05%      26.165us         0.13%      65.711us       0.548us           120  
            aten::expand         0.09%      42.747us         0.11%      53.916us       0.449us           120  
            aten::select         0.07%      33.884us         0.09%      47.292us       0.263us           180  
                aten::to         0.01%       6.167us         0.08%      38.292us       1.276us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 50.226ms

2026-02-08 10:47:02,941 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.65%      27.271ms       100.00%     410.344ms      13.678ms            30  
                   aten::index_add_        45.27%     185.772ms        45.28%     185.812ms       6.194ms            30  
                 aten::index_select        19.50%      80.004ms        19.50%      80.013ms       1.334ms            60  
                          aten::mul        10.75%      44.113ms        10.75%      44.113ms       1.470ms            30  
    extension_cpp::sparse_matmul_vo         9.32%      38.228ms         9.32%      38.251ms       1.275ms            30  
                    aten::index_add         0.01%      46.075us         6.81%      27.937ms     931.238us            30  
                 aten::scatter_add_         6.79%      27.861ms         6.79%      27.863ms     928.754us            30  
                          aten::div         0.68%       2.770ms         0.70%       2.860ms      47.665us            60  
                          aten::exp         0.53%       2.168ms         0.53%       2.168ms      72.257us            30  
                          aten::max         0.19%     768.207us         0.19%     786.417us      26.214us            30  
                          aten::sub         0.16%     655.794us         0.16%     655.794us      21.860us            30  
                        aten::zeros         0.01%      56.634us         0.06%     226.002us       3.767us            60  
                        aten::zero_         0.01%      29.749us         0.03%     126.455us       2.108us            60  
                        aten::fill_         0.02%     100.540us         0.02%     100.540us       1.676us            60  
                           aten::to         0.00%      12.717us         0.02%      91.588us       1.526us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 410.344ms

2026-02-08 10:47:03,186 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.28%     323.128us       100.00%     117.005ms       3.900ms            30  
    extension_cpp::sparse_attn        99.60%     116.535ms        99.67%     116.623ms       3.887ms            30  
               aten::new_zeros         0.01%       9.332us         0.06%      64.666us       2.156us            30  
                   aten::zero_         0.01%       8.869us         0.04%      50.790us       0.846us            60  
                 aten::squeeze         0.03%      35.298us         0.04%      42.043us       0.467us            90  
                   aten::fill_         0.04%      41.921us         0.04%      41.921us       1.397us            30  
                   aten::empty         0.02%      20.672us         0.02%      20.672us       0.230us            90  
               aten::unsqueeze         0.01%      13.335us         0.01%      16.292us       0.543us            30  
              aten::as_strided         0.01%       9.702us         0.01%       9.702us       0.081us           120  
               aten::new_empty         0.00%       3.872us         0.01%       9.417us       0.314us            30  
              aten::contiguous         0.00%       3.122us         0.00%       3.122us       0.035us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 117.005ms

2026-02-08 10:47:03,189 - INFO - [18/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=90%
2026-02-08 10:47:03,333 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        12.43%       5.408ms       100.00%      43.524ms       1.451ms            30  
            aten::matmul         0.16%      68.749us        28.48%      12.394ms     206.560us            60  
               aten::bmm        27.85%      12.122ms        27.98%      12.178ms     202.966us            60  
       aten::masked_fill         0.08%      34.088us        24.59%      10.702ms     356.721us            30  
           aten::softmax         0.03%      11.542us        23.50%      10.226ms     340.877us            30  
          aten::_softmax        23.47%      10.215ms        23.47%      10.215ms     340.492us            30  
      aten::masked_fill_        17.03%       7.412ms        17.03%       7.412ms     247.060us            30  
               aten::div         8.29%       3.609ms         8.40%       3.655ms     121.850us            30  
             aten::clone         0.04%      17.707us         7.48%       3.256ms     108.525us            30  
             aten::copy_         7.43%       3.235ms         7.43%       3.235ms      53.909us            60  
       aten::bitwise_not         2.48%       1.081ms         2.48%       1.081ms      36.034us            30  
           aten::reshape         0.07%      29.289us         0.17%      75.583us       0.630us           120  
            aten::expand         0.12%      50.199us         0.14%      61.617us       0.513us           120  
            aten::select         0.08%      35.712us         0.12%      50.548us       0.281us           180  
                aten::to         0.01%       6.335us         0.11%      46.002us       1.533us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 43.524ms

2026-02-08 10:47:03,596 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         4.37%       5.322ms       100.00%     121.697ms       4.057ms            30  
                   aten::index_add_        49.76%      60.562ms        49.79%      60.588ms       2.020ms            30  
                 aten::index_select        18.94%      23.053ms        18.95%      23.062ms     384.362us            60  
    extension_cpp::sparse_matmul_vo        10.34%      12.589ms        10.36%      12.606ms     420.198us            30  
                    aten::index_add         0.03%      34.451us         7.80%       9.487ms     316.235us            30  
                 aten::scatter_add_         7.75%       9.427ms         7.75%       9.429ms     314.299us            30  
                          aten::mul         5.95%       7.245ms         5.95%       7.245ms     241.508us            30  
                          aten::div         0.95%       1.156ms         0.98%       1.197ms      19.958us            60  
                          aten::exp         0.82%       1.000ms         0.82%       1.000ms      33.347us            30  
                          aten::max         0.40%     483.294us         0.41%     496.879us      16.563us            30  
                          aten::sub         0.33%     398.044us         0.33%     398.044us      13.268us            30  
                        aten::zeros         0.02%      29.753us         0.12%     142.334us       2.372us            60  
                        aten::zero_         0.02%      19.209us         0.08%      92.292us       1.538us            60  
                        aten::fill_         0.06%      75.253us         0.06%      75.253us       1.254us            60  
                       aten::select         0.04%      53.755us         0.05%      66.046us       0.550us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 121.697ms

2026-02-08 10:47:03,710 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         2.08%     829.703us       100.00%      39.983ms       1.333ms            30  
    extension_cpp::sparse_attn        97.57%      39.012ms        97.79%      39.099ms       1.303ms            30  
               aten::new_zeros         0.02%       9.337us         0.17%      66.710us       2.224us            30  
                   aten::zero_         0.02%       7.250us         0.14%      54.458us       0.908us            60  
                   aten::fill_         0.12%      47.208us         0.12%      47.208us       1.574us            30  
                 aten::squeeze         0.08%      32.883us         0.10%      39.047us       0.434us            90  
                   aten::empty         0.04%      16.626us         0.04%      16.626us       0.185us            90  
               aten::unsqueeze         0.03%      12.377us         0.04%      15.168us       0.506us            30  
              aten::as_strided         0.02%       8.955us         0.02%       8.955us       0.075us           120  
               aten::new_empty         0.01%       3.708us         0.02%       7.041us       0.235us            30  
              aten::contiguous         0.01%       2.754us         0.01%       2.754us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 39.983ms

2026-02-08 10:47:03,713 - INFO - [19/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=95%
2026-02-08 10:47:03,851 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        12.85%       5.346ms       100.00%      41.611ms       1.387ms            30  
            aten::matmul         0.16%      64.748us        30.49%      12.686ms     211.439us            60  
               aten::bmm        29.89%      12.437ms        30.02%      12.492ms     208.205us            60  
           aten::softmax         0.03%      11.043us        24.03%      10.001ms     333.356us            30  
          aten::_softmax        24.01%       9.990ms        24.01%       9.990ms     332.988us            30  
       aten::masked_fill         0.07%      30.129us        21.02%       8.746ms     291.530us            30  
      aten::masked_fill_        12.95%       5.387ms        12.95%       5.387ms     179.568us            30  
               aten::div         8.69%       3.616ms         8.78%       3.654ms     121.811us            30  
             aten::clone         0.04%      16.879us         8.00%       3.329ms     110.957us            30  
             aten::copy_         7.95%       3.307ms         7.95%       3.307ms      55.116us            60  
       aten::bitwise_not         2.71%       1.127ms         2.71%       1.127ms      37.550us            30  
           aten::reshape         0.06%      26.169us         0.16%      65.959us       0.550us           120  
            aten::expand         0.10%      42.838us         0.13%      54.254us       0.452us           120  
            aten::select         0.08%      35.088us         0.12%      49.665us       0.276us           180  
                aten::to         0.01%       5.881us         0.09%      38.045us       1.268us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 41.611ms

2026-02-08 10:47:04,029 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.68%       5.114ms       100.00%      66.562ms       2.219ms            30  
                   aten::index_add_        46.12%      30.698ms        46.16%      30.727ms       1.024ms            30  
                 aten::index_select        17.05%      11.348ms        17.06%      11.356ms     189.269us            60  
    extension_cpp::sparse_matmul_vo         9.62%       6.404ms         9.64%       6.418ms     213.933us            30  
                          aten::mul         8.14%       5.418ms         8.14%       5.418ms     180.603us            30  
                    aten::index_add         0.04%      27.699us         7.30%       4.860ms     161.995us            30  
                 aten::scatter_add_         7.23%       4.811ms         7.23%       4.812ms     160.405us            30  
                          aten::div         1.31%     874.676us         1.37%     914.924us      15.249us            60  
                          aten::exp         0.94%     627.211us         0.94%     627.211us      20.907us            30  
                          aten::max         0.63%     420.625us         0.65%     433.751us      14.458us            30  
                          aten::sub         0.53%     352.586us         0.53%     352.586us      11.753us            30  
                        aten::zeros         0.04%      27.958us         0.30%     198.871us       3.315us            60  
                        aten::zero_         0.02%      15.584us         0.23%     152.416us       2.540us            60  
                        aten::fill_         0.21%     140.664us         0.21%     140.664us       2.344us            60  
                       aten::select         0.08%      51.880us         0.10%      64.210us       0.535us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 66.562ms

2026-02-08 10:47:04,110 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.44%     289.330us       100.00%      20.048ms     668.278us            30  
    extension_cpp::sparse_attn        97.90%      19.627ms        98.30%      19.707ms     656.892us            30  
               aten::new_zeros         0.05%       9.094us         0.30%      60.090us       2.003us            30  
                   aten::zero_         0.04%       7.452us         0.24%      47.579us       0.793us            60  
                   aten::fill_         0.20%      40.127us         0.20%      40.127us       1.338us            30  
                 aten::squeeze         0.16%      31.881us         0.19%      37.792us       0.420us            90  
                   aten::empty         0.08%      15.961us         0.08%      15.961us       0.177us            90  
               aten::unsqueeze         0.06%      12.042us         0.07%      14.460us       0.482us            30  
              aten::as_strided         0.04%       8.329us         0.04%       8.329us       0.069us           120  
               aten::new_empty         0.02%       4.248us         0.04%       7.459us       0.249us            30  
              aten::contiguous         0.01%       3.002us         0.01%       3.002us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 20.048ms

2026-02-08 10:47:04,112 - INFO - [20/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=99%
2026-02-08 10:47:04,249 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        13.72%       5.554ms       100.00%      40.493ms       1.350ms            30  
            aten::matmul         0.17%      68.243us        30.21%      12.231ms     203.851us            60  
               aten::bmm        29.54%      11.962ms        29.68%      12.019ms     200.310us            60  
           aten::softmax         0.03%      10.707us        25.50%      10.326ms     344.207us            30  
          aten::_softmax        25.47%      10.315ms        25.47%      10.315ms     343.850us            30  
       aten::masked_fill         0.08%      32.207us        18.64%       7.546ms     251.542us            30  
      aten::masked_fill_        10.55%       4.272ms        10.55%       4.272ms     142.394us            30  
               aten::div         8.91%       3.608ms         9.01%       3.649ms     121.647us            30  
             aten::clone         0.04%      16.417us         8.01%       3.242ms     108.074us            30  
             aten::copy_         7.95%       3.221ms         7.95%       3.221ms      53.679us            60  
       aten::bitwise_not         2.79%       1.130ms         2.79%       1.130ms      37.676us            30  
           aten::reshape         0.10%      39.168us         0.20%      80.545us       0.671us           120  
            aten::expand         0.11%      43.210us         0.13%      53.831us       0.449us           120  
            aten::select         0.09%      36.293us         0.12%      50.376us       0.280us           180  
                aten::to         0.01%       6.044us         0.10%      41.002us       1.367us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 40.493ms

2026-02-08 10:47:04,331 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         8.25%       1.024ms       100.00%      12.405ms     413.514us            30  
                   aten::index_add_        47.70%       5.918ms        47.88%       5.940ms     197.996us            30  
                    aten::index_add         0.21%      25.910us        10.44%       1.295ms      43.160us            30  
    extension_cpp::sparse_matmul_vo        10.04%       1.245ms        10.12%       1.256ms      41.859us            30  
                 aten::scatter_add_        10.07%       1.249ms        10.08%       1.250ms      41.680us            30  
                 aten::index_select         8.72%       1.081ms         8.75%       1.086ms      18.097us            60  
                          aten::mul         7.98%     989.466us         7.98%     989.466us      32.982us            30  
                          aten::exp         3.17%     393.801us         3.17%     393.801us      13.127us            30  
                        aten::zeros         0.20%      24.752us         0.95%     117.377us       1.956us            60  
                          aten::div         0.72%      89.543us         0.93%     115.877us       1.931us            60  
                        aten::zero_         0.10%      12.622us         0.60%      74.955us       1.249us            60  
                        aten::fill_         0.51%      63.710us         0.51%      63.710us       1.062us            60  
                          aten::max         0.40%      49.918us         0.45%      56.334us       1.878us            30  
                       aten::select         0.29%      35.489us         0.36%      44.914us       0.374us           120  
                          aten::sub         0.30%      37.545us         0.30%      37.545us       1.252us            30  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.405ms

2026-02-08 10:47:04,384 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         4.41%     178.722us       100.00%       4.048ms     134.943us            30  
    extension_cpp::sparse_attn        92.43%       3.742ms        94.36%       3.820ms     127.331us            30  
               aten::new_zeros         0.22%       8.711us         1.48%      59.796us       1.993us            30  
                   aten::zero_         0.18%       7.211us         1.18%      47.712us       0.795us            60  
                   aten::fill_         1.00%      40.501us         1.00%      40.501us       1.350us            30  
                 aten::squeeze         0.75%      30.455us         0.90%      36.380us       0.404us            90  
                   aten::empty         0.38%      15.377us         0.38%      15.377us       0.171us            90  
               aten::unsqueeze         0.27%      10.955us         0.33%      13.249us       0.442us            30  
              aten::as_strided         0.20%       8.219us         0.20%       8.219us       0.068us           120  
               aten::new_empty         0.08%       3.335us         0.18%       7.250us       0.242us            30  
              aten::contiguous         0.08%       3.126us         0.08%       3.126us       0.035us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.048ms

2026-02-08 10:47:04,387 - INFO - [21/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=50%
2026-02-08 10:47:04,562 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.21%       5.027ms       100.00%      61.246ms       2.042ms            30  
       aten::masked_fill         0.05%      31.871us        44.05%      26.979ms     899.309us            30  
      aten::masked_fill_        38.31%      23.464ms        38.31%      23.464ms     782.149us            30  
            aten::matmul         0.11%      64.542us        23.91%      14.646ms     244.098us            60  
               aten::bmm        23.51%      14.397ms        23.60%      14.452ms     240.859us            60  
           aten::softmax         0.02%      11.422us        16.37%      10.023ms     334.106us            30  
          aten::_softmax        16.35%      10.012ms        16.35%      10.012ms     333.726us            30  
             aten::clone         0.03%      15.585us         5.69%       3.483ms     116.097us            30  
             aten::copy_         5.65%       3.463ms         5.65%       3.463ms      57.719us            60  
               aten::div         5.52%       3.382ms         5.59%       3.421ms     114.021us            30  
       aten::bitwise_not         1.79%       1.099ms         1.79%       1.099ms      36.627us            30  
           aten::reshape         0.04%      24.383us         0.10%      62.667us       0.522us           120  
            aten::expand         0.08%      47.287us         0.09%      57.791us       0.482us           120  
            aten::select         0.06%      35.825us         0.08%      49.286us       0.274us           180  
                aten::to         0.01%       5.958us         0.06%      38.668us       1.289us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 61.246ms

2026-02-08 10:47:06,409 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.57%      78.455ms       100.00%        1.036s      34.543ms            30  
                   aten::index_add_        32.00%     331.665ms        32.01%     331.745ms      11.058ms            30  
                 aten::index_select        25.79%     267.281ms        25.79%     267.292ms       4.455ms            60  
    extension_cpp::sparse_matmul_vo        14.74%     152.788ms        14.75%     152.840ms       5.095ms            30  
                          aten::mul        14.15%     146.659ms        14.15%     146.659ms       4.889ms            30  
                    aten::index_add         0.01%      74.209us         4.49%      46.571ms       1.552ms            30  
                 aten::scatter_add_         4.48%      46.451ms         4.48%      46.454ms       1.548ms            30  
                          aten::div         0.45%       4.664ms         0.46%       4.804ms      80.071us            60  
                          aten::exp         0.38%       3.927ms         0.38%       3.927ms     130.899us            30  
                          aten::sub         0.17%       1.793ms         0.17%       1.793ms      59.759us            30  
                          aten::max         0.10%       1.028ms         0.10%       1.053ms      35.085us            30  
                        aten::zeros         0.01%      95.168us         0.08%     796.254us      13.271us            60  
                        aten::zero_         0.00%      42.999us         0.06%     625.962us      10.433us            60  
                        aten::fill_         0.06%     589.794us         0.06%     589.794us       9.830us            60  
                        aten::empty         0.01%     151.288us         0.01%     151.288us       0.840us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.036s

2026-02-08 10:47:07,006 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.44%       1.451ms       100.00%     331.069ms      11.036ms            30  
    extension_cpp::sparse_attn        99.39%     329.060ms        99.54%     329.530ms      10.984ms            30  
               aten::new_zeros         0.01%      20.130us         0.13%     434.255us      14.475us            30  
                   aten::zero_         0.01%      22.995us         0.12%     412.123us       6.869us            60  
                   aten::fill_         0.12%     389.128us         0.12%     389.128us      12.971us            30  
                 aten::squeeze         0.01%      48.375us         0.02%      56.249us       0.625us            90  
               aten::unsqueeze         0.01%      26.750us         0.01%      31.874us       1.062us            30  
                   aten::empty         0.01%      27.832us         0.01%      27.832us       0.309us            90  
              aten::as_strided         0.00%      12.998us         0.00%      12.998us       0.108us           120  
               aten::new_empty         0.00%       6.040us         0.00%      12.418us       0.414us            30  
              aten::contiguous         0.00%       3.456us         0.00%       3.456us       0.038us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 331.069ms

2026-02-08 10:47:07,008 - INFO - [22/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=70%
2026-02-08 10:47:07,178 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.60%       5.115ms       100.00%      53.295ms       1.777ms            30  
       aten::masked_fill         0.06%      32.748us        35.06%      18.683ms     622.768us            30  
      aten::masked_fill_        28.77%      15.336ms        28.77%      15.336ms     511.186us            30  
            aten::matmul         0.13%      67.925us        27.64%      14.729ms     245.491us            60  
               aten::bmm        27.14%      14.467ms        27.24%      14.520ms     242.002us            60  
           aten::softmax         0.03%      13.499us        18.82%      10.032ms     334.389us            30  
          aten::_softmax        18.80%      10.018ms        18.80%      10.018ms     333.939us            30  
               aten::div         6.61%       3.523ms         6.69%       3.566ms     118.871us            30  
             aten::clone         0.03%      16.749us         6.22%       3.315ms     110.491us            30  
             aten::copy_         6.18%       3.294ms         6.18%       3.294ms      54.898us            60  
       aten::bitwise_not         2.10%       1.117ms         2.10%       1.117ms      37.224us            30  
           aten::reshape         0.06%      32.006us         0.14%      73.588us       0.613us           120  
            aten::expand         0.09%      47.712us         0.11%      58.288us       0.486us           120  
            aten::select         0.06%      33.665us         0.09%      47.540us       0.264us           180  
                aten::to         0.01%       5.585us         0.08%      43.295us       1.443us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 53.295ms

2026-02-08 10:47:08,342 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        13.73%      93.793ms       100.00%     682.912ms      22.764ms            30  
                   aten::index_add_        29.98%     204.763ms        29.99%     204.831ms       6.828ms            30  
                 aten::index_select        24.04%     164.145ms        24.04%     164.155ms       2.736ms            60  
                          aten::mul        13.53%      92.412ms        13.53%      92.412ms       3.080ms            30  
    extension_cpp::sparse_matmul_vo        13.39%      91.418ms        13.39%      91.467ms       3.049ms            30  
                    aten::index_add         0.01%      67.456us         4.10%      27.974ms     932.469us            30  
                 aten::scatter_add_         4.08%      27.865ms         4.08%      27.868ms     928.919us            30  
                          aten::div         0.44%       2.987ms         0.46%       3.121ms      52.013us            60  
                          aten::exp         0.35%       2.416ms         0.35%       2.416ms      80.545us            30  
                          aten::max         0.12%     833.003us         0.13%     857.338us      28.578us            30  
                        aten::zeros         0.01%      86.672us         0.12%     798.001us      13.300us            60  
                          aten::sub         0.11%     756.963us         0.11%     756.963us      25.232us            30  
                        aten::zero_         0.01%      39.623us         0.09%     639.999us      10.667us            60  
                        aten::fill_         0.09%     607.293us         0.09%     607.293us      10.122us            60  
                        aten::empty         0.02%     142.998us         0.02%     142.998us       0.794us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 682.912ms

2026-02-08 10:47:08,714 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.36%     700.931us       100.00%     194.483ms       6.483ms            30  
    extension_cpp::sparse_attn        99.41%     193.331ms        99.61%     193.719ms       6.457ms            30  
               aten::new_zeros         0.01%      14.002us         0.19%     365.417us      12.181us            30  
                   aten::zero_         0.01%      13.037us         0.18%     349.126us       5.819us            60  
                   aten::fill_         0.17%     336.089us         0.17%     336.089us      11.203us            30  
                 aten::squeeze         0.02%      36.453us         0.02%      42.661us       0.474us            90  
               aten::unsqueeze         0.01%      17.084us         0.01%      20.456us       0.682us            30  
                   aten::empty         0.01%      18.212us         0.01%      18.212us       0.202us            90  
              aten::as_strided         0.00%       9.580us         0.00%       9.580us       0.080us           120  
               aten::new_empty         0.00%       3.915us         0.00%       7.624us       0.254us            30  
              aten::contiguous         0.00%       2.661us         0.00%       2.661us       0.030us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 194.483ms

2026-02-08 10:47:08,716 - INFO - [23/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=90%
2026-02-08 10:47:08,866 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        11.32%       5.130ms       100.00%      45.303ms       1.510ms            30  
            aten::matmul         0.14%      64.088us        32.93%      14.919ms     248.652us            60  
               aten::bmm        32.38%      14.669ms        32.50%      14.721ms     245.357us            60  
       aten::masked_fill         0.07%      31.249us        24.03%      10.885ms     362.849us            30  
           aten::softmax         0.03%      11.582us        22.05%       9.987ms     332.916us            30  
          aten::_softmax        22.02%       9.976ms        22.02%       9.976ms     332.529us            30  
      aten::masked_fill_        16.38%       7.422ms        16.38%       7.422ms     247.407us            30  
             aten::clone         0.04%      16.671us         7.58%       3.432ms     114.400us            30  
             aten::copy_         7.53%       3.409ms         7.53%       3.409ms      56.822us            60  
               aten::div         7.12%       3.226ms         7.20%       3.261ms     108.707us            30  
       aten::bitwise_not         2.36%       1.070ms         2.36%       1.070ms      35.658us            30  
           aten::reshape         0.06%      26.293us         0.15%      66.624us       0.555us           120  
            aten::expand         0.10%      46.965us         0.13%      58.037us       0.484us           120  
            aten::select         0.07%      33.662us         0.10%      47.247us       0.262us           180  
                aten::to         0.01%       5.250us         0.08%      35.584us       1.186us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 45.303ms

2026-02-08 10:47:09,280 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        10.65%      22.549ms       100.00%     211.811ms       7.060ms            30  
                   aten::index_add_        31.73%      67.207ms        31.75%      67.248ms       2.242ms            30  
                 aten::index_select        23.53%      49.830ms        23.53%      49.839ms     830.657us            60  
    extension_cpp::sparse_matmul_vo        14.21%      30.106ms        14.22%      30.129ms       1.004ms            30  
                          aten::mul        13.44%      28.472ms        13.44%      28.472ms     949.057us            30  
                    aten::index_add         0.02%      44.671us         4.50%       9.525ms     317.500us            30  
                 aten::scatter_add_         4.46%       9.451ms         4.46%       9.452ms     315.072us            30  
                          aten::div         0.57%       1.200ms         0.60%       1.275ms      21.252us            60  
                          aten::exp         0.49%       1.041ms         0.49%       1.041ms      34.686us            30  
                          aten::max         0.25%     522.039us         0.25%     539.417us      17.981us            30  
                        aten::zeros         0.02%      43.997us         0.25%     526.504us       8.775us            60  
                        aten::zero_         0.01%      25.499us         0.21%     451.548us       7.526us            60  
                          aten::sub         0.21%     450.250us         0.21%     450.250us      15.008us            30  
                        aten::fill_         0.20%     429.469us         0.20%     429.469us       7.158us            60  
                       aten::select         0.04%      75.715us         0.04%      93.505us       0.779us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 211.811ms

2026-02-08 10:47:09,436 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.41%     263.493us       100.00%      64.259ms       2.142ms            30  
    extension_cpp::sparse_attn        98.84%      63.512ms        99.50%      63.937ms       2.131ms            30  
               aten::new_zeros         0.02%      14.663us         0.63%     404.247us      13.475us            30  
                   aten::zero_         0.02%      12.663us         0.60%     385.747us       6.429us            60  
                   aten::fill_         0.58%     373.084us         0.58%     373.084us      12.436us            30  
                 aten::squeeze         0.05%      34.250us         0.06%      40.128us       0.446us            90  
               aten::unsqueeze         0.02%      15.794us         0.03%      18.626us       0.621us            30  
                   aten::empty         0.03%      18.088us         0.03%      18.088us       0.201us            90  
              aten::as_strided         0.01%       8.710us         0.01%       8.710us       0.073us           120  
               aten::new_empty         0.01%       3.960us         0.01%       8.501us       0.283us            30  
              aten::contiguous         0.00%       2.835us         0.00%       2.835us       0.032us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 64.259ms

2026-02-08 10:47:09,438 - INFO - [24/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=95%
2026-02-08 10:47:09,582 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        12.58%       5.461ms       100.00%      43.431ms       1.448ms            30  
            aten::matmul         0.15%      63.925us        34.09%      14.808ms     246.797us            60  
               aten::bmm        33.53%      14.561ms        33.65%      14.614ms     243.568us            60  
           aten::softmax         0.03%      10.919us        23.05%      10.009ms     333.636us            30  
          aten::_softmax        23.02%       9.998ms        23.02%       9.998ms     333.272us            30  
       aten::masked_fill         0.07%      32.124us        19.76%       8.580ms     286.006us            30  
      aten::masked_fill_        12.40%       5.386ms        12.40%       5.386ms     179.537us            30  
               aten::div         7.74%       3.364ms         7.83%       3.402ms     113.398us            30  
             aten::clone         0.04%      16.791us         7.28%       3.162ms     105.398us            30  
             aten::copy_         7.23%       3.139ms         7.23%       3.139ms      52.309us            60  
       aten::bitwise_not         2.58%       1.119ms         2.58%       1.119ms      37.314us            30  
           aten::reshape         0.06%      26.750us         0.15%      66.416us       0.553us           120  
            aten::expand         0.10%      43.753us         0.12%      54.167us       0.451us           120  
            aten::select         0.08%      35.536us         0.11%      48.117us       0.267us           180  
                aten::to         0.01%       4.748us         0.09%      38.206us       1.274us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 43.431ms

2026-02-08 10:47:09,793 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         4.63%       4.163ms       100.00%      89.961ms       2.999ms            30  
                   aten::index_add_        37.96%      34.147ms        37.99%      34.174ms       1.139ms            30  
                 aten::index_select        24.05%      21.631ms        24.05%      21.639ms     360.653us            60  
    extension_cpp::sparse_matmul_vo        16.68%      15.003ms        16.69%      15.015ms     500.513us            30  
                          aten::mul         8.02%       7.217ms         8.02%       7.217ms     240.570us            30  
                    aten::index_add         0.04%      31.872us         5.42%       4.874ms     162.471us            30  
                 aten::scatter_add_         5.36%       4.818ms         5.36%       4.820ms     160.656us            30  
                          aten::div         0.90%     810.408us         0.95%     851.076us      14.185us            60  
                          aten::exp         0.68%     612.879us         0.68%     612.879us      20.429us            30  
                        aten::zeros         0.04%      31.592us         0.56%     501.964us       8.366us            60  
                        aten::zero_         0.02%      18.289us         0.50%     449.418us       7.490us            60  
                        aten::fill_         0.48%     434.421us         0.48%     434.421us       7.240us            60  
                          aten::max         0.46%     411.539us         0.47%     423.999us      14.133us            30  
                          aten::sub         0.39%     353.373us         0.39%     353.373us      11.779us            30  
                       aten::select         0.05%      48.298us         0.07%      60.833us       0.507us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 89.961ms

2026-02-08 10:47:09,895 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.71%     230.164us       100.00%      32.580ms       1.086ms            30  
    extension_cpp::sparse_attn        97.95%      31.910ms        99.11%      32.289ms       1.076ms            30  
               aten::new_zeros         0.04%      14.418us         1.10%     357.753us      11.925us            30  
                   aten::zero_         0.04%      12.375us         1.05%     340.542us       5.676us            60  
                   aten::fill_         1.01%     328.167us         1.01%     328.167us      10.939us            30  
                 aten::squeeze         0.11%      35.043us         0.12%      40.711us       0.452us            90  
               aten::unsqueeze         0.05%      16.581us         0.06%      19.417us       0.647us            30  
                   aten::empty         0.05%      17.711us         0.05%      17.711us       0.197us            90  
              aten::as_strided         0.03%       8.504us         0.03%       8.504us       0.071us           120  
               aten::new_empty         0.01%       3.835us         0.02%       7.626us       0.254us            30  
              aten::contiguous         0.01%       2.453us         0.01%       2.453us       0.027us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 32.580ms

2026-02-08 10:47:09,898 - INFO - [25/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=99%
2026-02-08 10:47:10,048 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        12.12%       5.298ms       100.00%      43.710ms       1.457ms            30  
            aten::matmul         0.16%      71.461us        35.69%      15.599ms     259.988us            60  
               aten::bmm        35.07%      15.329ms        35.20%      15.386ms     256.437us            60  
           aten::softmax         0.03%      13.296us        23.12%      10.106ms     336.856us            30  
          aten::_softmax        23.09%      10.092ms        23.09%      10.092ms     336.413us            30  
       aten::masked_fill         0.09%      37.249us        17.87%       7.809ms     260.311us            30  
      aten::masked_fill_         9.69%       4.237ms         9.69%       4.237ms     141.247us            30  
               aten::div         8.16%       3.566ms         8.27%       3.613ms     120.442us            30  
             aten::clone         0.04%      18.250us         8.09%       3.535ms     117.822us            30  
             aten::copy_         8.03%       3.509ms         8.03%       3.509ms      58.490us            60  
       aten::bitwise_not         2.80%       1.225ms         2.80%       1.225ms      40.849us            30  
           aten::reshape         0.06%      27.622us         0.17%      74.331us       0.619us           120  
            aten::expand         0.10%      45.289us         0.13%      57.084us       0.476us           120  
            aten::select         0.08%      37.152us         0.12%      50.744us       0.282us           180  
                aten::to         0.02%       6.710us         0.11%      47.045us       1.568us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 43.710ms

2026-02-08 10:47:10,145 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        12.31%       2.635ms       100.00%      21.408ms     713.601us            30  
                   aten::index_add_        29.71%       6.361ms        29.83%       6.387ms     212.901us            30  
                 aten::index_select        20.99%       4.494ms        21.02%       4.499ms      74.987us            60  
    extension_cpp::sparse_matmul_vo        14.11%       3.020ms        14.16%       3.032ms     101.056us            30  
                          aten::mul        11.09%       2.374ms        11.09%       2.374ms      79.123us            30  
                    aten::index_add         0.13%      27.800us         6.01%       1.287ms      42.897us            30  
                 aten::scatter_add_         5.77%       1.235ms         5.78%       1.237ms      41.220us            30  
                        aten::zeros         0.13%      28.263us         2.20%     471.749us       7.862us            60  
                        aten::zero_         0.08%      16.826us         1.99%     425.828us       7.097us            60  
                        aten::fill_         1.92%     410.377us         1.92%     410.377us       6.840us            60  
                          aten::exp         1.82%     388.662us         1.82%     388.662us      12.955us            30  
                          aten::div         0.46%      98.869us         0.60%     128.581us       2.143us            60  
                          aten::max         0.24%      51.912us         0.28%      58.876us       1.963us            30  
                       aten::select         0.21%      45.001us         0.26%      56.251us       0.469us           120  
                        aten::empty         0.18%      37.998us         0.18%      37.998us       0.211us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 21.408ms

2026-02-08 10:47:10,205 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         2.96%     216.136us       100.00%       7.310ms     243.670us            30  
    extension_cpp::sparse_attn        90.64%       6.626ms        96.26%       7.037ms     234.565us            30  
               aten::new_zeros         0.20%      14.284us         5.35%     391.388us      13.046us            30  
                   aten::zero_         0.17%      12.752us         5.10%     373.141us       6.219us            60  
                   aten::fill_         4.93%     360.389us         4.93%     360.389us      12.013us            30  
                 aten::squeeze         0.46%      33.419us         0.54%      39.375us       0.438us            90  
                   aten::empty         0.25%      17.956us         0.25%      17.956us       0.200us            90  
               aten::unsqueeze         0.20%      14.582us         0.24%      17.622us       0.587us            30  
              aten::as_strided         0.12%       8.996us         0.12%       8.996us       0.075us           120  
               aten::new_empty         0.05%       3.380us         0.11%       8.338us       0.278us            30  
              aten::contiguous         0.04%       2.631us         0.04%       2.631us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.310ms

2026-02-08 10:47:10,208 - INFO - [26/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=50%
2026-02-08 10:47:10,394 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.48%       4.915ms       100.00%      65.733ms       2.191ms            30  
       aten::masked_fill         0.05%      32.123us        40.82%      26.831ms     894.370us            30  
      aten::masked_fill_        35.29%      23.195ms        35.29%      23.195ms     773.164us            30  
            aten::matmul         0.10%      68.125us        29.61%      19.462ms     324.360us            60  
               aten::bmm        29.22%      19.206ms        29.30%      19.258ms     320.961us            60  
           aten::softmax         0.02%      10.625us        15.16%       9.965ms     332.171us            30  
          aten::_softmax        15.14%       9.955ms        15.14%       9.955ms     331.817us            30  
             aten::clone         0.02%      15.039us         5.48%       3.604ms     120.136us            30  
             aten::copy_         5.45%       3.582ms         5.45%       3.582ms      59.708us            60  
               aten::div         5.21%       3.426ms         5.27%       3.465ms     115.491us            30  
       aten::bitwise_not         1.59%       1.047ms         1.59%       1.047ms      34.900us            30  
           aten::reshape         0.05%      30.418us         0.11%      75.333us       0.628us           120  
            aten::expand         0.06%      41.000us         0.08%      51.168us       0.426us           120  
            aten::select         0.05%      32.459us         0.07%      45.544us       0.253us           180  
                aten::to         0.01%       6.336us         0.06%      38.920us       1.297us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 65.733ms

2026-02-08 10:47:13,664 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         8.80%     166.636ms       100.00%        1.895s      63.151ms            30  
                   aten::index_add_        25.71%     487.169ms        25.72%     487.256ms      16.242ms            30  
                 aten::index_select        25.47%     482.517ms        25.47%     482.529ms       8.042ms            60  
    extension_cpp::sparse_matmul_vo        21.86%     414.054ms        21.86%     414.123ms      13.804ms            30  
                          aten::mul        14.98%     283.855ms        14.98%     283.855ms       9.462ms            30  
                    aten::index_add         0.00%      83.917us         2.45%      46.343ms       1.545ms            30  
                 aten::scatter_add_         2.44%      46.202ms         2.44%      46.205ms       1.540ms            30  
                          aten::div         0.27%       5.076ms         0.28%       5.243ms      87.389us            60  
                          aten::exp         0.22%       4.080ms         0.22%       4.080ms     136.013us            30  
                          aten::sub         0.10%       1.897ms         0.10%       1.897ms      63.225us            30  
                          aten::max         0.06%       1.052ms         0.06%       1.088ms      36.271us            30  
                        aten::zeros         0.01%     108.172us         0.05%       1.037ms      17.290us            60  
                        aten::zero_         0.00%      43.828us         0.04%     842.705us      14.045us            60  
                        aten::fill_         0.04%     808.628us         0.04%     808.628us      13.477us            60  
                        aten::empty         0.01%     186.499us         0.01%     186.499us       1.036us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.895s

2026-02-08 10:47:14,856 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.12%     811.412us       100.00%     685.621ms      22.854ms            30  
    extension_cpp::sparse_attn        99.80%     684.268ms        99.87%     684.736ms      22.825ms            30  
               aten::new_zeros         0.00%      15.377us         0.06%     434.168us      14.472us            30  
                   aten::zero_         0.00%      17.283us         0.06%     415.952us       6.933us            60  
                   aten::fill_         0.06%     398.669us         0.06%     398.669us      13.289us            30  
                 aten::squeeze         0.01%      39.711us         0.01%      47.337us       0.526us            90  
                   aten::empty         0.00%      29.415us         0.00%      29.415us       0.327us            90  
               aten::unsqueeze         0.00%      21.087us         0.00%      25.378us       0.846us            30  
              aten::as_strided         0.00%      11.917us         0.00%      11.917us       0.099us           120  
               aten::new_empty         0.00%       4.830us         0.00%       9.959us       0.332us            30  
              aten::contiguous         0.00%       3.251us         0.00%       3.251us       0.036us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 685.621ms

2026-02-08 10:47:14,859 - INFO - [27/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=70%
2026-02-08 10:47:15,043 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.48%       5.475ms       100.00%      64.572ms       2.152ms            30  
       aten::masked_fill         0.07%      43.580us        33.37%      21.550ms     718.327us            30  
            aten::matmul         0.13%      86.097us        33.16%      21.413ms     356.876us            60  
               aten::bmm        32.65%      21.083ms        32.75%      21.148ms     352.463us            60  
      aten::masked_fill_        27.05%      17.469ms        27.05%      17.469ms     582.308us            30  
           aten::softmax         0.03%      20.543us        16.96%      10.955ms     365.150us            30  
          aten::_softmax        16.93%      10.934ms        16.93%      10.934ms     364.466us            30  
             aten::clone         0.03%      20.049us         6.25%       4.037ms     134.567us            30  
             aten::copy_         6.21%       4.013ms         6.21%       4.013ms      66.877us            60  
               aten::div         5.85%       3.775ms         5.95%       3.840ms     128.007us            30  
       aten::bitwise_not         1.96%       1.264ms         1.96%       1.264ms      42.138us            30  
           aten::reshape         0.06%      40.206us         0.15%      99.749us       0.831us           120  
            aten::expand         0.08%      54.252us         0.10%      67.451us       0.562us           120  
                aten::to         0.01%       9.500us         0.10%      65.373us       2.179us            30  
            aten::select         0.07%      42.919us         0.09%      58.667us       0.326us           180  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 64.572ms

2026-02-08 10:47:17,058 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.99%      93.887ms       100.00%        1.175s      39.179ms            30  
                   aten::index_add_        24.74%     290.824ms        24.75%     290.906ms       9.697ms            30  
                 aten::index_select        24.60%     289.084ms        24.60%     289.094ms       4.818ms            60  
    extension_cpp::sparse_matmul_vo        21.46%     252.183ms        21.46%     252.237ms       8.408ms            30  
                          aten::mul        18.11%     212.877ms        18.11%     212.877ms       7.096ms            30  
                    aten::index_add         0.01%      75.134us         2.38%      28.014ms     933.798us            30  
                 aten::scatter_add_         2.37%      27.890ms         2.37%      27.894ms     929.792us            30  
                          aten::div         0.25%       2.972ms         0.27%       3.124ms      52.064us            60  
                          aten::exp         0.20%       2.314ms         0.20%       2.314ms      77.145us            30  
                        aten::zeros         0.01%     101.342us         0.08%     892.794us      14.880us            60  
                          aten::max         0.07%     817.541us         0.07%     845.752us      28.192us            30  
                          aten::sub         0.07%     776.587us         0.07%     776.587us      25.886us            30  
                        aten::zero_         0.00%      38.955us         0.06%     711.374us      11.856us            60  
                        aten::fill_         0.06%     679.711us         0.06%     679.711us      11.329us            60  
                        aten::empty         0.01%     159.247us         0.01%     159.247us       0.885us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.175s

2026-02-08 10:47:17,791 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.14%     564.417us       100.00%     409.861ms      13.662ms            30  
    extension_cpp::sparse_attn        99.73%     408.757ms        99.84%     409.221ms      13.641ms            30  
               aten::new_zeros         0.00%      15.503us         0.11%     433.627us      14.454us            30  
                   aten::zero_         0.00%      17.414us         0.10%     416.666us       6.944us            60  
                   aten::fill_         0.10%     399.252us         0.10%     399.252us      13.308us            30  
                 aten::squeeze         0.01%      41.166us         0.01%      48.290us       0.537us            90  
               aten::unsqueeze         0.01%      21.793us         0.01%      26.919us       0.897us            30  
                   aten::empty         0.01%      22.881us         0.01%      22.881us       0.254us            90  
              aten::as_strided         0.00%      12.250us         0.00%      12.250us       0.102us           120  
               aten::new_empty         0.00%       4.455us         0.00%       8.539us       0.285us            30  
              aten::contiguous         0.00%       4.205us         0.00%       4.205us       0.047us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 409.861ms

2026-02-08 10:47:17,794 - INFO - [28/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=90%
2026-02-08 10:47:17,957 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        10.64%       5.669ms       100.00%      53.295ms       1.777ms            30  
            aten::matmul         0.14%      71.950us        39.82%      21.224ms     353.726us            60  
               aten::bmm        39.30%      20.943ms        39.41%      21.002ms     350.026us            60  
       aten::masked_fill         0.07%      38.294us        20.65%      11.004ms     366.798us            30  
           aten::softmax         0.03%      15.244us        19.33%      10.304ms     343.477us            30  
          aten::_softmax        19.31%      10.289ms        19.31%      10.289ms     342.969us            30  
      aten::masked_fill_        14.14%       7.535ms        14.14%       7.535ms     251.150us            30  
               aten::div         6.83%       3.638ms         6.92%       3.689ms     122.973us            30  
             aten::clone         0.03%      17.788us         6.44%       3.431ms     114.372us            30  
             aten::copy_         6.40%       3.408ms         6.40%       3.408ms      56.806us            60  
       aten::bitwise_not         2.52%       1.345ms         2.52%       1.345ms      44.839us            30  
           aten::reshape         0.06%      29.784us         0.15%      82.286us       0.686us           120  
            aten::expand         0.09%      47.085us         0.11%      58.092us       0.484us           120  
            aten::select         0.07%      37.667us         0.10%      52.539us       0.292us           180  
                aten::to         0.01%       6.832us         0.10%      51.042us       1.701us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 53.295ms

2026-02-08 10:47:18,605 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.53%      22.623ms       100.00%     346.658ms      11.555ms            30  
                 aten::index_select        26.67%      92.438ms        26.67%      92.447ms       1.541ms            60  
    extension_cpp::sparse_matmul_vo        24.12%      83.617ms        24.13%      83.650ms       2.788ms            30  
                   aten::index_add_        22.00%      76.273ms        22.02%      76.334ms       2.544ms            30  
                          aten::mul        16.67%      57.779ms        16.67%      57.779ms       1.926ms            30  
                    aten::index_add         0.02%      53.163us         2.73%       9.464ms     315.470us            30  
                 aten::scatter_add_         2.71%       9.379ms         2.71%       9.381ms     312.705us            30  
                          aten::div         0.34%       1.176ms         0.37%       1.273ms      21.216us            60  
                          aten::exp         0.27%     944.166us         0.27%     944.166us      31.472us            30  
                        aten::zeros         0.02%      66.918us         0.26%     898.455us      14.974us            60  
                        aten::zero_         0.01%      36.705us         0.23%     780.038us      13.001us            60  
                        aten::fill_         0.22%     746.666us         0.22%     746.666us      12.444us            60  
                          aten::max         0.15%     521.332us         0.16%     539.292us      17.976us            30  
                          aten::sub         0.13%     440.874us         0.13%     440.874us      14.696us            30  
                       aten::select         0.03%      90.917us         0.03%     113.581us       0.947us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 346.658ms

2026-02-08 10:47:18,880 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.17%     231.373us       100.00%     135.364ms       4.512ms            30  
    extension_cpp::sparse_attn        99.45%     134.616ms        99.79%     135.074ms       4.502ms            30  
               aten::new_zeros         0.01%      14.579us         0.32%     436.415us      14.547us            30  
                   aten::zero_         0.01%      12.542us         0.31%     419.000us       6.983us            60  
                   aten::fill_         0.30%     406.458us         0.30%     406.458us      13.549us            30  
                 aten::squeeze         0.03%      33.920us         0.03%      39.957us       0.444us            90  
               aten::unsqueeze         0.01%      15.873us         0.01%      18.873us       0.629us            30  
                   aten::empty         0.01%      17.134us         0.01%      17.134us       0.190us            90  
              aten::as_strided         0.01%       9.037us         0.01%       9.037us       0.075us           120  
               aten::new_empty         0.00%       3.791us         0.01%       7.543us       0.251us            30  
              aten::contiguous         0.00%       3.287us         0.00%       3.287us       0.037us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 135.364ms

2026-02-08 10:47:18,883 - INFO - [29/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=95%
2026-02-08 10:47:19,048 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        10.98%       5.972ms       100.00%      54.400ms       1.813ms            30  
            aten::matmul         0.15%      79.583us        40.63%      22.104ms     368.406us            60  
               aten::bmm        40.07%      21.800ms        40.19%      21.862ms     364.359us            60  
           aten::softmax         0.03%      15.165us        21.14%      11.501ms     383.372us            30  
          aten::_softmax        21.11%      11.486ms        21.11%      11.486ms     382.866us            30  
       aten::masked_fill         0.07%      36.672us        17.45%       9.493ms     316.432us            30  
      aten::masked_fill_        10.49%       5.709ms        10.49%       5.709ms     190.292us            30  
               aten::div         7.01%       3.811ms         7.11%       3.867ms     128.914us            30  
             aten::clone         0.03%      18.957us         6.89%       3.748ms     124.918us            30  
             aten::copy_         6.85%       3.724ms         6.85%       3.724ms      62.068us            60  
       aten::bitwise_not         2.57%       1.398ms         2.57%       1.398ms      46.592us            30  
           aten::reshape         0.06%      31.414us         0.17%      93.580us       0.780us           120  
            aten::expand         0.09%      47.508us         0.11%      59.334us       0.494us           120  
                aten::to         0.01%       7.832us         0.10%      56.583us       1.886us            30  
            aten::select         0.07%      39.581us         0.10%      55.168us       0.306us           180  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 54.400ms

2026-02-08 10:47:19,388 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         4.84%       8.002ms       100.00%     165.340ms       5.511ms            30  
                 aten::index_select        25.78%      42.629ms        25.79%      42.637ms     710.623us            60  
    extension_cpp::sparse_matmul_vo        25.03%      41.393ms        25.05%      41.410ms       1.380ms            30  
                   aten::index_add_        23.08%      38.162ms        23.10%      38.194ms       1.273ms            30  
                          aten::mul        16.37%      27.067ms        16.37%      27.067ms     902.234us            30  
                    aten::index_add         0.02%      36.585us         2.96%       4.891ms     163.035us            30  
                 aten::scatter_add_         2.92%       4.829ms         2.92%       4.830ms     160.999us            30  
                          aten::div         0.52%     854.461us         0.55%     903.711us      15.062us            60  
                          aten::exp         0.39%     645.834us         0.39%     645.834us      21.528us            30  
                        aten::zeros         0.02%      34.054us         0.38%     626.835us      10.447us            60  
                        aten::zero_         0.01%      21.498us         0.34%     569.913us       9.499us            60  
                        aten::fill_         0.33%     552.160us         0.33%     552.160us       9.203us            60  
                          aten::max         0.26%     432.178us         0.27%     446.255us      14.875us            30  
                          aten::sub         0.21%     355.162us         0.21%     355.162us      11.839us            30  
                       aten::select         0.04%      57.914us         0.04%      70.920us       0.591us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 165.340ms

2026-02-08 10:47:19,551 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.32%     219.087us       100.00%      67.911ms       2.264ms            30  
    extension_cpp::sparse_attn        98.91%      67.173ms        99.60%      67.636ms       2.255ms            30  
               aten::new_zeros         0.02%      13.789us         0.65%     441.543us      14.718us            30  
                   aten::zero_         0.02%      12.711us         0.62%     423.169us       7.053us            60  
                   aten::fill_         0.60%     410.458us         0.60%     410.458us      13.682us            30  
                 aten::squeeze         0.05%      31.743us         0.06%      38.160us       0.424us            90  
                   aten::empty         0.03%      19.122us         0.03%      19.122us       0.212us            90  
               aten::unsqueeze         0.02%      14.504us         0.03%      17.296us       0.577us            30  
              aten::as_strided         0.01%       9.209us         0.01%       9.209us       0.077us           120  
               aten::new_empty         0.01%       3.669us         0.01%       9.167us       0.306us            30  
              aten::contiguous         0.00%       3.085us         0.00%       3.085us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 67.911ms

2026-02-08 10:47:19,553 - INFO - [30/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=99%
2026-02-08 10:47:19,706 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        11.24%       5.351ms       100.00%      47.623ms       1.587ms            30  
            aten::matmul         0.14%      64.963us        42.14%      20.070ms     334.500us            60  
               aten::bmm        41.62%      19.823ms        41.74%      19.875ms     331.257us            60  
           aten::softmax         0.03%      12.252us        21.23%      10.109ms     336.970us            30  
          aten::_softmax        21.20%      10.097ms        21.20%      10.097ms     336.562us            30  
       aten::masked_fill         0.07%      33.914us        15.44%       7.354ms     245.121us            30  
      aten::masked_fill_         8.66%       4.126ms         8.66%       4.126ms     137.545us            30  
               aten::div         7.32%       3.484ms         7.41%       3.528ms     117.602us            30  
             aten::clone         0.03%      15.752us         6.71%       3.193ms     106.445us            30  
             aten::copy_         6.67%       3.177ms         6.67%       3.177ms      52.946us            60  
       aten::bitwise_not         2.43%       1.158ms         2.43%       1.158ms      38.611us            30  
           aten::reshape         0.05%      24.546us         0.14%      66.085us       0.551us           120  
            aten::expand         0.09%      43.402us         0.11%      53.412us       0.445us           120  
            aten::select         0.07%      33.387us         0.10%      46.964us       0.261us           180  
                aten::to         0.01%       5.544us         0.09%      43.792us       1.460us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 47.623ms

2026-02-08 10:47:19,826 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         9.98%       3.502ms       100.00%      35.081ms       1.169ms            30  
                 aten::index_select        23.85%       8.366ms        23.86%       8.371ms     139.515us            60  
    extension_cpp::sparse_matmul_vo        23.30%       8.175ms        23.33%       8.186ms     272.860us            30  
                   aten::index_add_        21.24%       7.452ms        21.32%       7.479ms     249.294us            30  
                          aten::mul        14.19%       4.979ms        14.19%       4.979ms     165.983us            30  
                    aten::index_add         0.08%      29.086us         3.71%       1.300ms      43.331us            30  
                 aten::scatter_add_         3.56%       1.247ms         3.56%       1.249ms      41.621us            30  
                        aten::zeros         0.08%      29.205us         1.54%     540.921us       9.015us            60  
                        aten::zero_         0.05%      16.916us         1.41%     494.586us       8.243us            60  
                        aten::fill_         1.37%     479.089us         1.37%     479.089us       7.985us            60  
                          aten::exp         1.16%     406.840us         1.16%     406.840us      13.561us            30  
                          aten::div         0.26%      91.295us         0.34%     120.379us       2.006us            60  
                          aten::max         0.15%      51.084us         0.16%      57.751us       1.925us            30  
                       aten::select         0.12%      42.540us         0.15%      53.580us       0.447us           120  
                        aten::empty         0.10%      36.079us         0.10%      36.079us       0.200us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 35.081ms

2026-02-08 10:47:19,899 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.54%     219.124us       100.00%      14.224ms     474.147us            30  
    extension_cpp::sparse_attn        94.91%      13.500ms        98.06%      13.948ms     464.926us            30  
               aten::new_zeros         0.10%      14.167us         3.00%     426.338us      14.211us            30  
                   aten::zero_         0.09%      13.126us         2.88%     409.963us       6.833us            60  
                   aten::fill_         2.79%     396.837us         2.79%     396.837us      13.228us            30  
                 aten::squeeze         0.24%      33.668us         0.28%      39.291us       0.437us            90  
               aten::unsqueeze         0.11%      15.458us         0.13%      18.209us       0.607us            30  
                   aten::empty         0.12%      17.250us         0.12%      17.250us       0.192us            90  
              aten::as_strided         0.06%       8.374us         0.06%       8.374us       0.070us           120  
               aten::new_empty         0.02%       3.542us         0.05%       7.459us       0.249us            30  
              aten::contiguous         0.02%       2.539us         0.02%       2.539us       0.028us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 14.224ms

2026-02-08 10:47:19,901 - INFO - [31/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=50%
2026-02-08 10:47:20,353 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         3.15%       6.456ms       100.00%     204.959ms       6.832ms            30  
       aten::masked_fill         0.04%      81.211us        50.14%     102.761ms       3.425ms            30  
      aten::masked_fill_        45.17%      92.574ms        45.17%      92.574ms       3.086ms            30  
            aten::matmul         0.06%     132.928us        22.81%      46.760ms     779.333us            60  
               aten::bmm        22.59%      46.292ms        22.62%      46.365ms     772.748us            60  
           aten::softmax         0.01%      30.132us        16.29%      33.398ms       1.113ms            30  
          aten::_softmax        16.28%      33.368ms        16.28%      33.368ms       1.112ms            30  
               aten::div         4.95%      10.143ms         4.99%      10.233ms     341.094us            30  
             aten::clone         0.02%      38.747us         4.93%      10.105ms     336.842us            30  
             aten::copy_         4.91%      10.057ms         4.91%      10.057ms     167.614us            60  
       aten::bitwise_not         2.56%       5.244ms         2.56%       5.244ms     174.798us            30  
           aten::reshape         0.03%      57.752us         0.07%     145.632us       1.214us           120  
            aten::expand         0.04%      83.464us         0.05%      99.634us       0.830us           120  
                aten::to         0.01%      12.169us         0.04%      89.962us       2.999us            30  
          aten::_to_copy         0.01%      28.794us         0.04%      77.793us       2.593us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 204.959ms

2026-02-08 10:47:25,246 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.03%     172.801ms       100.00%        2.867s      95.562ms            30  
                   aten::index_add_        47.16%        1.352s        47.17%        1.352s      45.073ms            30  
                 aten::index_select        19.34%     554.527ms        19.34%     554.550ms       9.243ms            60  
                          aten::mul         9.96%     285.529ms         9.96%     285.529ms       9.518ms            30  
    extension_cpp::sparse_matmul_vo         9.39%     269.077ms         9.39%     269.150ms       8.972ms            30  
                    aten::index_add         0.00%     117.830us         6.45%     184.887ms       6.163ms            30  
                 aten::scatter_add_         6.44%     184.670ms         6.44%     184.677ms       6.156ms            30  
                          aten::div         0.71%      20.277ms         0.71%      20.479ms     341.312us            60  
                          aten::exp         0.52%      14.916ms         0.52%      14.916ms     497.198us            30  
                          aten::sub         0.27%       7.614ms         0.27%       7.614ms     253.810us            30  
                          aten::max         0.11%       3.258ms         0.12%       3.304ms     110.117us            30  
                        aten::zeros         0.00%     127.916us         0.03%     885.507us      14.758us            60  
                        aten::zero_         0.00%      49.669us         0.02%     658.049us      10.967us            60  
                        aten::fill_         0.02%     620.839us         0.02%     620.839us      10.347us            60  
                        aten::empty         0.01%     220.041us         0.01%     220.041us       1.222us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.867s

2026-02-08 10:47:26,647 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.26%       2.079ms       100.00%     813.148ms      27.105ms            30  
    extension_cpp::sparse_attn        99.64%     810.212ms        99.73%     810.953ms      27.032ms            30  
               aten::new_zeros         0.00%      34.556us         0.08%     662.549us      22.085us            30  
                   aten::zero_         0.01%      58.001us         0.08%     632.585us      10.543us            60  
                   aten::fill_         0.07%     574.584us         0.07%     574.584us      19.153us            30  
                 aten::squeeze         0.01%      55.074us         0.01%      62.492us       0.694us            90  
                   aten::empty         0.01%      57.876us         0.01%      57.876us       0.643us            90  
               aten::unsqueeze         0.01%      45.253us         0.01%      54.042us       1.801us            30  
               aten::new_empty         0.00%      11.701us         0.00%      22.036us       0.735us            30  
              aten::as_strided         0.00%      16.207us         0.00%      16.207us       0.135us           120  
              aten::contiguous         0.00%       3.956us         0.00%       3.956us       0.044us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 813.148ms

2026-02-08 10:47:26,650 - INFO - [32/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=70%
2026-02-08 10:47:27,044 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         4.17%       7.423ms       100.00%     178.088ms       5.936ms            30  
       aten::masked_fill         0.05%      91.168us        40.62%      72.335ms       2.411ms            30  
      aten::masked_fill_        34.88%      62.108ms        34.88%      62.108ms       2.070ms            30  
            aten::matmul         0.08%     148.578us        27.09%      48.241ms     804.015us            60  
               aten::bmm        26.79%      47.715ms        26.84%      47.798ms     796.639us            60  
           aten::softmax         0.02%      32.670us        19.27%      34.325ms       1.144ms            30  
          aten::_softmax        19.26%      34.292ms        19.26%      34.292ms       1.143ms            30  
               aten::div         5.77%      10.273ms         5.82%      10.373ms     345.776us            30  
             aten::clone         0.02%      40.748us         5.69%      10.135ms     337.833us            30  
             aten::copy_         5.66%      10.085ms         5.66%      10.085ms     168.080us            60  
       aten::bitwise_not         2.96%       5.273ms         2.96%       5.273ms     175.759us            30  
           aten::reshape         0.04%      63.835us         0.09%     161.834us       1.349us           120  
            aten::expand         0.05%      94.126us         0.06%     113.505us       0.946us           120  
                aten::to         0.01%      14.669us         0.06%     100.169us       3.339us            30  
          aten::_to_copy         0.02%      32.041us         0.05%      85.500us       2.850us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 178.088ms

2026-02-08 10:47:30,062 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.92%     105.000ms       100.00%        1.775s      59.168ms            30  
                   aten::index_add_        45.72%     811.581ms        45.73%     811.663ms      27.055ms            30  
                 aten::index_select        19.06%     338.249ms        19.06%     338.264ms       5.638ms            60  
                          aten::mul        12.13%     215.296ms        12.13%     215.296ms       7.177ms            30  
    extension_cpp::sparse_matmul_vo         9.34%     165.811ms         9.35%     165.878ms       5.529ms            30  
                    aten::index_add         0.01%     100.250us         6.27%     111.214ms       3.707ms            30  
                 aten::scatter_add_         6.26%     111.038ms         6.26%     111.045ms       3.701ms            30  
                          aten::div         0.64%      11.284ms         0.65%      11.465ms     191.077us            60  
                          aten::exp         0.51%       8.996ms         0.51%       8.996ms     299.881us            30  
                          aten::sub         0.23%       4.050ms         0.23%       4.050ms     135.011us            30  
                          aten::max         0.11%       1.864ms         0.11%       1.895ms      63.153us            30  
                        aten::zeros         0.01%     119.678us         0.05%     872.091us      14.535us            60  
                        aten::zero_         0.00%      45.457us         0.04%     653.544us      10.892us            60  
                        aten::fill_         0.03%     617.502us         0.03%     617.502us      10.292us            60  
                        aten::empty         0.01%     192.539us         0.01%     192.539us       1.070us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.775s

2026-02-08 10:47:30,961 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.75%       3.844ms       100.00%     510.853ms      17.028ms            30  
    extension_cpp::sparse_attn        99.13%     506.406ms        99.23%     506.917ms      16.897ms            30  
               aten::new_zeros         0.00%      21.329us         0.09%     460.123us      15.337us            30  
                   aten::zero_         0.01%      30.207us         0.09%     441.710us       7.362us            60  
                   aten::fill_         0.08%     411.503us         0.08%     411.503us      13.717us            30  
                 aten::squeeze         0.01%      51.010us         0.01%      58.340us       0.648us            90  
                   aten::empty         0.01%      37.161us         0.01%      37.161us       0.413us            90  
               aten::unsqueeze         0.01%      28.040us         0.01%      33.832us       1.128us            30  
              aten::as_strided         0.00%      13.122us         0.00%      13.122us       0.109us           120  
               aten::new_empty         0.00%       7.377us         0.00%      13.002us       0.433us            30  
              aten::contiguous         0.00%       3.170us         0.00%       3.170us       0.035us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 510.853ms

2026-02-08 10:47:30,964 - INFO - [33/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=90%
2026-02-08 10:47:31,337 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.52%      12.386ms       100.00%     164.778ms       5.493ms            30  
            aten::matmul         0.07%     122.465us        28.05%      46.219ms     770.312us            60  
               aten::bmm        27.79%      45.785ms        27.83%      45.851ms     764.183us            60  
       aten::masked_fill         0.05%      81.966us        27.46%      45.244ms       1.508ms            30  
           aten::softmax         0.02%      29.580us        23.94%      39.449ms       1.315ms            30  
          aten::_softmax        23.92%      39.419ms        23.92%      39.419ms       1.314ms            30  
      aten::masked_fill_        17.14%      28.241ms        17.14%      28.241ms     941.377us            30  
             aten::clone         0.02%      34.456us        10.27%      16.921ms     564.026us            30  
             aten::copy_        10.24%      16.876ms        10.24%      16.876ms     281.274us            60  
               aten::div         9.77%      16.106ms         9.83%      16.195ms     539.836us            30  
       aten::bitwise_not         3.14%       5.176ms         3.14%       5.176ms     172.538us            30  
           aten::reshape         0.04%      61.995us         0.09%     141.164us       1.176us           120  
                aten::to         0.01%      13.248us         0.05%      89.127us       2.971us            30  
            aten::expand         0.04%      72.870us         0.05%      87.377us       0.728us           120  
          aten::_to_copy         0.02%      28.928us         0.05%      75.879us       2.529us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 164.778ms

2026-02-08 10:47:32,330 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.86%      32.888ms       100.00%     560.916ms      18.697ms            30  
                   aten::index_add_        46.05%     258.317ms        46.07%     258.386ms       8.613ms            30  
                 aten::index_select        19.25%     107.966ms        19.25%     107.974ms       1.800ms            60  
                          aten::mul        10.59%      59.428ms        10.59%      59.428ms       1.981ms            30  
    extension_cpp::sparse_matmul_vo         9.72%      54.525ms         9.73%      54.574ms       1.819ms            30  
                    aten::index_add         0.01%      74.212us         6.63%      37.190ms       1.240ms            30  
                 aten::scatter_add_         6.61%      37.066ms         6.61%      37.069ms       1.236ms            30  
                          aten::div         0.66%       3.729ms         0.69%       3.850ms      64.171us            60  
                          aten::exp         0.58%       3.237ms         0.58%       3.237ms     107.904us            30  
                          aten::sub         0.25%       1.386ms         0.25%       1.386ms      46.203us            30  
                          aten::max         0.16%     893.081us         0.16%     914.251us      30.475us            30  
                        aten::zeros         0.01%      81.793us         0.14%     791.127us      13.185us            60  
                        aten::zero_         0.01%      41.168us         0.12%     646.541us      10.776us            60  
                        aten::fill_         0.11%     610.497us         0.11%     610.497us      10.175us            60  
                        aten::empty         0.02%     131.889us         0.02%     131.889us       0.733us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 560.916ms

2026-02-08 10:47:32,655 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.11%       1.848ms       100.00%     166.817ms       5.561ms            30  
    extension_cpp::sparse_attn        98.58%     164.451ms        98.84%     164.889ms       5.496ms            30  
               aten::new_zeros         0.01%      18.130us         0.24%     405.210us      13.507us            30  
                   aten::zero_         0.01%      20.251us         0.23%     384.710us       6.412us            60  
                   aten::fill_         0.22%     364.459us         0.22%     364.459us      12.149us            30  
                 aten::squeeze         0.03%      43.416us         0.03%      50.503us       0.561us            90  
               aten::unsqueeze         0.01%      24.787us         0.02%      29.748us       0.992us            30  
                   aten::empty         0.02%      25.751us         0.02%      25.751us       0.286us            90  
               aten::new_empty         0.00%       6.209us         0.01%      12.083us       0.403us            30  
              aten::as_strided         0.01%      12.048us         0.01%      12.048us       0.100us           120  
              aten::contiguous         0.00%       3.255us         0.00%       3.255us       0.036us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 166.817ms

2026-02-08 10:47:32,658 - INFO - [34/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=95%
2026-02-08 10:47:33,010 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.33%      11.537ms       100.00%     157.428ms       5.248ms            30  
            aten::matmul         0.08%     118.636us        30.52%      48.047ms     800.786us            60  
               aten::bmm        30.25%      47.620ms        30.29%      47.691ms     794.850us            60  
           aten::softmax         0.02%      27.293us        24.67%      38.839ms       1.295ms            30  
          aten::_softmax        24.65%      38.812ms        24.65%      38.812ms       1.294ms            30  
       aten::masked_fill         0.05%      81.839us        23.46%      36.934ms       1.231ms            30  
      aten::masked_fill_        12.70%      19.999ms        12.70%      19.999ms     666.640us            30  
             aten::clone         0.02%      34.245us        10.70%      16.853ms     561.753us            30  
             aten::copy_        10.68%      16.813ms        10.68%      16.813ms     280.217us            60  
               aten::div        10.58%      16.657ms        10.64%      16.753ms     558.420us            30  
       aten::bitwise_not         3.31%       5.212ms         3.31%       5.212ms     173.745us            30  
           aten::reshape         0.04%      55.501us         0.09%     138.419us       1.153us           120  
                aten::to         0.01%      12.911us         0.06%      95.833us       3.194us            30  
          aten::_to_copy         0.02%      30.170us         0.05%      82.922us       2.764us            30  
            aten::expand         0.04%      67.626us         0.05%      81.332us       0.678us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 157.428ms

2026-02-08 10:47:33,532 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.27%      14.305ms       100.00%     271.487ms       9.050ms            30  
                   aten::index_add_        46.84%     127.164ms        46.85%     127.205ms       4.240ms            30  
                 aten::index_select        18.29%      49.654ms        18.29%      49.664ms     827.726us            60  
                          aten::mul        10.62%      28.827ms        10.62%      28.827ms     960.890us            30  
    extension_cpp::sparse_matmul_vo        10.03%      27.227ms        10.04%      27.256ms     908.548us            30  
                    aten::index_add         0.02%      47.994us         6.85%      18.599ms     619.968us            30  
                 aten::scatter_add_         6.82%      18.518ms         6.82%      18.521ms     617.356us            30  
                          aten::div         0.71%       1.933ms         0.74%       2.014ms      33.565us            60  
                          aten::exp         0.60%       1.634ms         0.60%       1.634ms      54.456us            30  
                          aten::max         0.24%     647.254us         0.24%     664.208us      22.140us            30  
                          aten::sub         0.21%     561.291us         0.21%     561.291us      18.710us            30  
                        aten::zeros         0.02%      47.845us         0.20%     547.505us       9.125us            60  
                        aten::zero_         0.01%      25.622us         0.17%     466.540us       7.776us            60  
                        aten::fill_         0.16%     444.375us         0.16%     444.375us       7.406us            60  
                       aten::select         0.03%      72.333us         0.03%      87.211us       0.727us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 271.487ms

2026-02-08 10:47:33,713 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.30%     241.173us       100.00%      79.479ms       2.649ms            30  
    extension_cpp::sparse_attn        99.12%      78.780ms        99.62%      79.178ms       2.639ms            30  
               aten::new_zeros         0.02%      14.215us         0.47%     374.253us      12.475us            30  
                   aten::zero_         0.02%      13.456us         0.45%     358.334us       5.972us            60  
                   aten::fill_         0.43%     344.878us         0.43%     344.878us      11.496us            30  
                 aten::squeeze         0.04%      34.377us         0.05%      40.874us       0.454us            90  
               aten::unsqueeze         0.02%      16.161us         0.02%      19.124us       0.637us            30  
                   aten::empty         0.02%      18.336us         0.02%      18.336us       0.204us            90  
              aten::as_strided         0.01%       9.460us         0.01%       9.460us       0.079us           120  
               aten::new_empty         0.01%       3.999us         0.01%       7.665us       0.256us            30  
              aten::contiguous         0.00%       3.039us         0.00%       3.039us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 79.479ms

2026-02-08 10:47:33,716 - INFO - [35/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=99%
2026-02-08 10:47:34,058 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.97%      12.464ms       100.00%     156.476ms       5.216ms            30  
            aten::matmul         0.09%     137.710us        32.68%      51.134ms     852.238us            60  
               aten::bmm        32.36%      50.637ms        32.41%      50.712ms     845.200us            60  
           aten::softmax         0.02%      36.170us        25.32%      39.612ms       1.320ms            30  
          aten::_softmax        25.29%      39.576ms        25.29%      39.576ms       1.319ms            30  
       aten::masked_fill         0.06%      86.174us        20.10%      31.452ms       1.048ms            30  
             aten::clone         0.03%      41.707us        10.72%      16.767ms     558.904us            30  
             aten::copy_        10.69%      16.722ms        10.69%      16.722ms     278.700us            60  
               aten::div        10.47%      16.382ms        10.54%      16.488ms     549.589us            30  
      aten::masked_fill_         9.33%      14.599ms         9.33%      14.599ms     486.622us            30  
       aten::bitwise_not         3.33%       5.206ms         3.33%       5.206ms     173.517us            30  
           aten::reshape         0.04%      60.780us         0.10%     156.870us       1.307us           120  
            aten::expand         0.06%      89.073us         0.07%     106.164us       0.885us           120  
                aten::to         0.01%      15.085us         0.07%     105.668us       3.522us            30  
          aten::_to_copy         0.02%      32.669us         0.06%      90.583us       3.019us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 156.476ms

2026-02-08 10:47:34,219 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*        10.59%       6.054ms       100.00%      57.154ms       1.905ms            30  
                   aten::index_add_        43.25%      24.721ms        43.30%      24.748ms     824.922us            30  
                 aten::index_select        17.67%      10.098ms        17.68%      10.105ms     168.424us            60  
    extension_cpp::sparse_matmul_vo         9.27%       5.301ms         9.30%       5.315ms     177.153us            30  
                          aten::mul         7.55%       4.314ms         7.55%       4.314ms     143.807us            30  
                    aten::index_add         0.05%      28.081us         6.74%       3.855ms     128.500us            30  
                 aten::scatter_add_         6.65%       3.801ms         6.65%       3.802ms     126.743us            30  
                          aten::div         1.34%     766.498us         1.41%     805.042us      13.417us            60  
                          aten::exp         1.01%     575.961us         1.01%     575.961us      19.199us            30  
                        aten::zeros         0.06%      32.330us         0.89%     508.373us       8.473us            60  
                        aten::zero_         0.03%      17.168us         0.80%     457.377us       7.623us            60  
                        aten::fill_         0.78%     443.544us         0.78%     443.544us       7.392us            60  
                          aten::max         0.68%     390.500us         0.71%     403.540us      13.451us            30  
                          aten::sub         0.59%     339.916us         0.59%     339.916us      11.331us            30  
                       aten::select         0.08%      47.625us         0.10%      58.796us       0.490us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 57.154ms

2026-02-08 10:47:34,295 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.36%     220.620us       100.00%      16.199ms     539.951us            30  
    extension_cpp::sparse_attn        95.73%      15.506ms        98.29%      15.921ms     530.711us            30  
               aten::new_zeros         0.09%      14.458us         2.42%     392.454us      13.082us            30  
                   aten::zero_         0.08%      13.705us         2.33%     377.034us       6.284us            60  
                   aten::fill_         2.24%     363.329us         2.24%     363.329us      12.111us            30  
                 aten::squeeze         0.20%      33.163us         0.24%      38.913us       0.432us            90  
               aten::unsqueeze         0.09%      14.792us         0.11%      17.665us       0.589us            30  
                   aten::empty         0.11%      17.255us         0.11%      17.255us       0.192us            90  
              aten::as_strided         0.05%       8.623us         0.05%       8.623us       0.072us           120  
               aten::new_empty         0.02%       3.543us         0.04%       7.043us       0.235us            30  
              aten::contiguous         0.02%       2.786us         0.02%       2.786us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 16.199ms

2026-02-08 10:47:34,298 - INFO - [36/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=50%
2026-02-08 10:47:34,765 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         3.10%       6.723ms       100.00%     217.039ms       7.235ms            30  
       aten::masked_fill         0.04%      87.170us        47.40%     102.866ms       3.429ms            30  
      aten::masked_fill_        42.76%      92.814ms        42.76%      92.814ms       3.094ms            30  
            aten::matmul         0.07%     143.298us        26.78%      58.114ms     968.571us            60  
               aten::bmm        26.55%      57.615ms        26.58%      57.687ms     961.450us            60  
           aten::softmax         0.02%      33.003us        15.32%      33.254ms       1.108ms            30  
          aten::_softmax        15.31%      33.221ms        15.31%      33.221ms       1.107ms            30  
               aten::div         4.88%      10.592ms         4.93%      10.697ms     356.551us            30  
             aten::clone         0.02%      39.795us         4.59%       9.965ms     332.162us            30  
             aten::copy_         4.57%       9.921ms         4.57%       9.921ms     165.353us            60  
       aten::bitwise_not         2.42%       5.262ms         2.42%       5.262ms     175.413us            30  
           aten::reshape         0.03%      62.161us         0.07%     156.458us       1.304us           120  
            aten::expand         0.04%      93.915us         0.05%     109.748us       0.915us           120  
                aten::to         0.01%      14.335us         0.05%     104.832us       3.494us            30  
          aten::_to_copy         0.01%      32.371us         0.04%      90.497us       3.017us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 217.039ms

2026-02-08 10:47:42,192 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.58%     331.572ms       100.00%        4.371s     145.716ms            30  
                   aten::index_add_        36.05%        1.576s        36.06%        1.576s      52.538ms            30  
                 aten::index_select        23.52%        1.028s        23.52%        1.028s      17.136ms            60  
    extension_cpp::sparse_matmul_vo        14.98%     654.709ms        14.98%     654.792ms      21.826ms            30  
                          aten::mul        12.54%     548.108ms        12.54%     548.108ms      18.270ms            30  
                    aten::index_add         0.00%     126.007us         4.22%     184.292ms       6.143ms            30  
                 aten::scatter_add_         4.21%     184.066ms         4.21%     184.073ms       6.136ms            30  
                          aten::div         0.47%      20.491ms         0.47%      20.694ms     344.896us            60  
                          aten::exp         0.34%      14.842ms         0.34%      14.842ms     494.719us            30  
                          aten::sub         0.18%       7.826ms         0.18%       7.826ms     260.862us            30  
                          aten::max         0.08%       3.298ms         0.08%       3.350ms     111.653us            30  
                        aten::zeros         0.00%     137.793us         0.02%       1.091ms      18.176us            60  
                        aten::zero_         0.00%      56.880us         0.02%     858.251us      14.304us            60  
                        aten::fill_         0.02%     817.375us         0.02%     817.375us      13.623us            60  
                        aten::empty         0.01%     227.008us         0.01%     227.008us       1.261us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.371s

2026-02-08 10:47:44,563 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.39%       5.376ms       100.00%        1.393s      46.446ms            30  
    extension_cpp::sparse_attn        99.53%        1.387s        99.60%        1.388s      46.261ms            30  
               aten::new_zeros         0.00%      50.247us         0.06%     879.335us      29.311us            30  
                   aten::zero_         0.01%      71.414us         0.06%     842.916us      14.049us            60  
                   aten::fill_         0.06%     771.502us         0.06%     771.502us      25.717us            30  
               aten::unsqueeze         0.01%      78.838us         0.01%      97.918us       3.264us            30  
                 aten::squeeze         0.01%      84.281us         0.01%      94.494us       1.050us            90  
                   aten::empty         0.01%      79.251us         0.01%      79.251us       0.881us            90  
              aten::as_strided         0.00%      29.293us         0.00%      29.293us       0.244us           120  
               aten::new_empty         0.00%      15.631us         0.00%      25.794us       0.860us            30  
              aten::contiguous         0.00%       6.786us         0.00%       6.786us       0.075us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.393s

2026-02-08 10:47:44,566 - INFO - [37/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=70%
2026-02-08 10:47:44,976 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         4.20%       7.796ms       100.00%     185.819ms       6.194ms            30  
       aten::masked_fill         0.05%      94.630us        37.39%      69.483ms       2.316ms            30  
      aten::masked_fill_        31.98%      59.420ms        31.98%      59.420ms       1.981ms            30  
            aten::matmul         0.08%     144.263us        31.65%      58.811ms     980.178us            60  
               aten::bmm        31.37%      58.297ms        31.42%      58.376ms     972.930us            60  
           aten::softmax         0.02%      30.335us        18.03%      33.504ms       1.117ms            30  
          aten::_softmax        18.01%      33.474ms        18.01%      33.474ms       1.116ms            30  
               aten::div         5.76%      10.697ms         5.81%      10.796ms     359.859us            30  
             aten::clone         0.02%      42.159us         5.36%       9.968ms     332.270us            30  
             aten::copy_         5.34%       9.919ms         5.34%       9.919ms     165.318us            60  
       aten::bitwise_not         2.86%       5.313ms         2.86%       5.313ms     177.089us            30  
           aten::reshape         0.04%      65.410us         0.09%     162.209us       1.352us           120  
            aten::expand         0.05%      89.334us         0.06%     108.412us       0.903us           120  
                aten::to         0.01%      13.252us         0.05%      99.209us       3.307us            30  
          aten::_to_copy         0.02%      31.787us         0.05%      85.957us       2.865us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 185.819ms

2026-02-08 10:47:49,316 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.52%     166.567ms       100.00%        2.556s      85.208ms            30  
                   aten::index_add_        35.99%     919.976ms        35.99%     920.062ms      30.669ms            30  
                 aten::index_select        23.70%     605.731ms        23.70%     605.745ms      10.096ms            60  
    extension_cpp::sparse_matmul_vo        15.87%     405.642ms        15.87%     405.711ms      13.524ms            30  
                          aten::mul        12.43%     317.746ms        12.43%     317.746ms      10.592ms            30  
                    aten::index_add         0.00%     104.834us         4.37%     111.674ms       3.722ms            30  
                 aten::scatter_add_         4.36%     111.492ms         4.36%     111.498ms       3.717ms            30  
                          aten::div         0.45%      11.581ms         0.46%      11.778ms     196.306us            60  
                          aten::exp         0.37%       9.348ms         0.37%       9.348ms     311.594us            30  
                          aten::sub         0.16%       4.010ms         0.16%       4.010ms     133.677us            30  
                          aten::max         0.08%       2.009ms         0.08%       2.054ms      68.472us            30  
                        aten::zeros         0.00%     124.869us         0.04%       1.019ms      16.985us            60  
                        aten::zero_         0.00%      50.760us         0.03%     802.342us      13.372us            60  
                        aten::fill_         0.03%     764.582us         0.03%     764.582us      12.743us            60  
                           aten::to         0.00%      26.791us         0.01%     202.625us       3.377us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.556s

2026-02-08 10:47:50,783 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.60%       5.126ms       100.00%     854.309ms      28.477ms            30  
    extension_cpp::sparse_attn        99.30%     848.293ms        99.39%     849.063ms      28.302ms            30  
               aten::new_zeros         0.00%      32.864us         0.08%     692.457us      23.082us            30  
                   aten::zero_         0.01%      48.459us         0.08%     670.338us      11.172us            60  
                   aten::fill_         0.07%     621.879us         0.07%     621.879us      20.729us            30  
                 aten::squeeze         0.01%      65.458us         0.01%      73.040us       0.812us            90  
                   aten::empty         0.01%      52.664us         0.01%      52.664us       0.585us            90  
               aten::unsqueeze         0.00%      39.086us         0.01%      47.503us       1.583us            30  
              aten::as_strided         0.00%      15.999us         0.00%      15.999us       0.133us           120  
               aten::new_empty         0.00%       9.840us         0.00%      15.922us       0.531us            30  
              aten::contiguous         0.00%       4.286us         0.00%       4.286us       0.048us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 854.309ms

2026-02-08 10:47:50,786 - INFO - [38/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=90%
2026-02-08 10:47:51,184 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.90%      14.643ms       100.00%     185.366ms       6.179ms            30  
            aten::matmul         0.08%     157.090us        32.54%      60.313ms       1.005ms            60  
               aten::bmm        32.24%      59.756ms        32.28%      59.837ms     997.277us            60  
       aten::masked_fill         0.06%     104.500us        24.50%      45.409ms       1.514ms            30  
           aten::softmax         0.02%      33.209us        22.41%      41.547ms       1.385ms            30  
          aten::_softmax        22.40%      41.514ms        22.40%      41.514ms       1.384ms            30  
      aten::masked_fill_        15.33%      28.408ms        15.33%      28.408ms     946.939us            30  
               aten::div         9.63%      17.847ms         9.69%      17.970ms     598.986us            30  
             aten::clone         0.02%      43.708us         9.12%      16.897ms     563.221us            30  
             aten::copy_         9.09%      16.851ms         9.09%      16.851ms     280.858us            60  
       aten::bitwise_not         2.88%       5.342ms         2.88%       5.342ms     178.066us            30  
           aten::reshape         0.04%      68.707us         0.10%     182.877us       1.524us           120  
                aten::to         0.01%      17.378us         0.07%     122.294us       4.076us            30  
            aten::expand         0.05%      94.665us         0.06%     113.534us       0.946us           120  
          aten::_to_copy         0.02%      37.086us         0.06%     104.916us       3.497us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 185.366ms

2026-02-08 10:47:52,628 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.40%      53.015ms       100.00%     827.974ms      27.599ms            30  
                   aten::index_add_        33.39%     276.490ms        33.40%     276.570ms       9.219ms            30  
                 aten::index_select        24.03%     198.963ms        24.03%     198.973ms       3.316ms            60  
    extension_cpp::sparse_matmul_vo        16.27%     134.751ms        16.28%     134.807ms       4.494ms            30  
                          aten::mul        14.05%     116.352ms        14.05%     116.352ms       3.878ms            30  
                    aten::index_add         0.01%      82.126us         4.53%      37.497ms       1.250ms            30  
                 aten::scatter_add_         4.51%      37.358ms         4.51%      37.361ms       1.245ms            30  
                          aten::div         0.46%       3.818ms         0.48%       3.967ms      66.116us            60  
                          aten::exp         0.38%       3.186ms         0.38%       3.186ms     106.204us            30  
                          aten::sub         0.16%       1.347ms         0.16%       1.347ms      44.913us            30  
                        aten::zeros         0.01%     101.542us         0.12%     963.753us      16.063us            60  
                          aten::max         0.11%     902.540us         0.11%     927.669us      30.922us            30  
                        aten::zero_         0.01%      47.002us         0.09%     784.419us      13.074us            60  
                        aten::fill_         0.09%     744.459us         0.09%     744.459us      12.408us            60  
                        aten::empty         0.02%     156.674us         0.02%     156.674us       0.870us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 827.974ms

2026-02-08 10:47:53,146 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.88%       2.498ms       100.00%     282.323ms       9.411ms            30  
    extension_cpp::sparse_attn        98.92%     279.274ms        99.09%     279.743ms       9.325ms            30  
               aten::new_zeros         0.01%      17.630us         0.15%     435.588us      14.520us            30  
                   aten::zero_         0.01%      19.501us         0.15%     417.502us       6.958us            60  
                   aten::fill_         0.14%     398.001us         0.14%     398.001us      13.267us            30  
                 aten::squeeze         0.02%      46.137us         0.02%      53.252us       0.592us            90  
               aten::unsqueeze         0.01%      23.960us         0.01%      27.957us       0.932us            30  
                   aten::empty         0.01%      25.586us         0.01%      25.586us       0.284us            90  
              aten::as_strided         0.00%      11.112us         0.00%      11.112us       0.093us           120  
               aten::new_empty         0.00%       5.373us         0.00%      10.249us       0.342us            30  
              aten::contiguous         0.00%       3.504us         0.00%       3.504us       0.039us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 282.323ms

2026-02-08 10:47:53,149 - INFO - [39/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=95%
2026-02-08 10:47:53,519 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.46%      10.843ms       100.00%     167.862ms       5.595ms            30  
            aten::matmul         0.07%     117.336us        34.61%      58.093ms     968.220us            60  
               aten::bmm        34.36%      57.681ms        34.40%      57.752ms     962.527us            60  
           aten::softmax         0.02%      29.750us        23.41%      39.298ms       1.310ms            30  
          aten::_softmax        23.39%      39.268ms        23.39%      39.268ms       1.309ms            30  
       aten::masked_fill         0.05%      86.333us        22.08%      37.057ms       1.235ms            30  
      aten::masked_fill_        11.94%      20.038ms        11.94%      20.038ms     667.931us            30  
               aten::div        10.27%      17.232ms        10.32%      17.322ms     577.392us            30  
             aten::clone         0.02%      35.501us        10.09%      16.933ms     564.431us            30  
             aten::copy_        10.06%      16.890ms        10.06%      16.890ms     281.496us            60  
       aten::bitwise_not         3.07%       5.146ms         3.07%       5.146ms     171.530us            30  
           aten::reshape         0.03%      53.329us         0.07%     125.456us       1.045us           120  
                aten::to         0.01%      11.748us         0.05%      90.251us       3.008us            30  
            aten::expand         0.04%      70.001us         0.05%      84.126us       0.701us           120  
          aten::_to_copy         0.02%      27.838us         0.05%      78.503us       2.617us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 167.862ms

2026-02-08 10:47:54,266 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.39%      26.401ms       100.00%     412.843ms      13.761ms            30  
                   aten::index_add_        33.30%     137.497ms        33.32%     137.566ms       4.586ms            30  
                 aten::index_select        23.92%      98.770ms        23.93%      98.779ms       1.646ms            60  
    extension_cpp::sparse_matmul_vo        16.19%      66.827ms        16.20%      66.867ms       2.229ms            30  
                          aten::mul        14.06%      58.065ms        14.06%      58.065ms       1.935ms            30  
                    aten::index_add         0.01%      57.997us         4.56%      18.824ms     627.464us            30  
                 aten::scatter_add_         4.54%      18.728ms         4.54%      18.730ms     624.346us            30  
                          aten::div         0.49%       2.031ms         0.52%       2.148ms      35.797us            60  
                          aten::exp         0.41%       1.688ms         0.41%       1.688ms      56.272us            30  
                        aten::zeros         0.02%      76.336us         0.20%     843.254us      14.054us            60  
                        aten::zero_         0.01%      37.417us         0.17%     706.586us      11.776us            60  
                          aten::sub         0.17%     700.041us         0.17%     700.041us      23.335us            30  
                          aten::max         0.16%     660.507us         0.16%     679.714us      22.657us            30  
                        aten::fill_         0.16%     673.879us         0.16%     673.879us      11.231us            60  
                       aten::select         0.02%      98.684us         0.03%     121.422us       1.012us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 412.843ms

2026-02-08 10:47:54,546 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.55%     757.551us       100.00%     138.164ms       4.605ms            30  
    extension_cpp::sparse_attn        99.09%     136.907ms        99.40%     137.342ms       4.578ms            30  
               aten::new_zeros         0.01%      14.413us         0.30%     409.294us      13.643us            30  
                   aten::zero_         0.01%      14.666us         0.29%     393.792us       6.563us            60  
                   aten::fill_         0.27%     379.126us         0.27%     379.126us      12.638us            30  
                 aten::squeeze         0.03%      36.709us         0.03%      43.665us       0.485us            90  
               aten::unsqueeze         0.01%      17.956us         0.02%      20.913us       0.697us            30  
                   aten::empty         0.01%      19.662us         0.01%      19.662us       0.218us            90  
              aten::as_strided         0.01%       9.913us         0.01%       9.913us       0.083us           120  
               aten::new_empty         0.00%       4.213us         0.01%       8.296us       0.277us            30  
              aten::contiguous         0.00%       3.080us         0.00%       3.080us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 138.164ms

2026-02-08 10:47:54,549 - INFO - [40/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=99%
2026-02-08 10:47:54,908 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.85%      11.083ms       100.00%     161.775ms       5.392ms            30  
            aten::matmul         0.07%     113.931us        35.57%      57.551ms     959.185us            60  
               aten::bmm        35.32%      57.135ms        35.36%      57.202ms     953.374us            60  
           aten::softmax         0.02%      30.328us        24.51%      39.645ms       1.321ms            30  
          aten::_softmax        24.49%      39.615ms        24.49%      39.615ms       1.320ms            30  
       aten::masked_fill         0.06%      90.624us        19.26%      31.160ms       1.039ms            30  
               aten::div        10.48%      16.952ms        10.53%      17.042ms     568.050us            30  
             aten::clone         0.02%      35.626us        10.31%      16.685ms     556.156us            30  
             aten::copy_        10.29%      16.639ms        10.29%      16.639ms     277.320us            60  
      aten::masked_fill_         8.89%      14.385ms         8.89%      14.385ms     479.486us            30  
       aten::bitwise_not         3.21%       5.193ms         3.21%       5.193ms     173.085us            30  
           aten::reshape         0.03%      54.986us         0.08%     135.782us       1.132us           120  
                aten::to         0.01%      12.586us         0.06%      89.588us       2.986us            30  
            aten::expand         0.04%      69.832us         0.05%      83.535us       0.696us           120  
          aten::_to_copy         0.02%      27.089us         0.05%      77.002us       2.567us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 161.775ms

2026-02-08 10:47:55,101 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.38%       5.765ms       100.00%      78.089ms       2.603ms            30  
                   aten::index_add_        34.49%      26.936ms        34.53%      26.965ms     898.826us            30  
                 aten::index_select        21.18%      16.542ms        21.19%      16.549ms     275.818us            60  
    extension_cpp::sparse_matmul_vo        16.64%      12.992ms        16.66%      13.007ms     433.569us            30  
                          aten::mul        11.57%       9.038ms        11.57%       9.038ms     301.283us            30  
                    aten::index_add         0.04%      34.327us         5.01%       3.911ms     130.372us            30  
                 aten::scatter_add_         4.93%       3.849ms         4.93%       3.850ms     128.350us            30  
                          aten::div         1.00%     777.377us         1.05%     817.753us      13.629us            60  
                          aten::exp         0.73%     573.126us         0.73%     573.126us      19.104us            30  
                        aten::zeros         0.05%      35.370us         0.73%     566.626us       9.444us            60  
                        aten::zero_         0.02%      18.964us         0.65%     509.836us       8.497us            60  
                        aten::fill_         0.63%     493.914us         0.63%     493.914us       8.232us            60  
                          aten::max         0.51%     399.000us         0.53%     410.207us      13.674us            30  
                          aten::sub         0.44%     344.039us         0.44%     344.039us      11.468us            30  
                       aten::select         0.07%      53.831us         0.08%      65.668us       0.547us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 78.089ms

2026-02-08 10:47:55,199 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.98%     274.371us       100.00%      28.109ms     936.979us            30  
    extension_cpp::sparse_attn        97.10%      27.295ms        98.77%      27.765ms     925.497us            30  
               aten::new_zeros         0.06%      15.621us         1.57%     441.750us      14.725us            30  
                   aten::zero_         0.06%      16.668us         1.51%     425.001us       7.083us            60  
                   aten::fill_         1.45%     408.333us         1.45%     408.333us      13.611us            30  
                 aten::squeeze         0.14%      39.968us         0.17%      47.504us       0.528us            90  
               aten::unsqueeze         0.07%      18.958us         0.08%      22.584us       0.753us            30  
                   aten::empty         0.08%      21.544us         0.08%      21.544us       0.239us            90  
              aten::as_strided         0.04%      11.162us         0.04%      11.162us       0.093us           120  
               aten::new_empty         0.01%       3.960us         0.03%       8.127us       0.271us            30  
              aten::contiguous         0.01%       3.293us         0.01%       3.293us       0.037us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 28.109ms

2026-02-08 10:47:55,202 - INFO - [41/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=50%
2026-02-08 10:47:55,710 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         3.56%       8.565ms       100.00%     240.460ms       8.015ms            30  
       aten::masked_fill         0.03%      83.005us        42.59%     102.403ms       3.413ms            30  
      aten::masked_fill_        38.38%      92.295ms        38.38%      92.295ms       3.077ms            30  
            aten::matmul         0.06%     140.732us        33.43%      80.389ms       1.340ms            60  
               aten::bmm        33.22%      79.883ms        33.25%      79.963ms       1.333ms            60  
           aten::softmax         0.01%      30.915us        13.70%      32.949ms       1.098ms            30  
          aten::_softmax        13.69%      32.918ms        13.69%      32.918ms       1.097ms            30  
               aten::div         4.47%      10.743ms         4.51%      10.852ms     361.730us            30  
             aten::clone         0.01%      35.165us         4.17%      10.024ms     334.138us            30  
             aten::copy_         4.15%       9.989ms         4.15%       9.989ms     166.491us            60  
       aten::bitwise_not         2.15%       5.181ms         2.15%       5.181ms     172.695us            30  
           aten::reshape         0.03%      64.586us         0.07%     162.171us       1.351us           120  
                aten::to         0.01%      14.624us         0.05%     108.666us       3.622us            30  
            aten::expand         0.04%      90.375us         0.04%     105.299us       0.877us           120  
          aten::_to_copy         0.01%      33.173us         0.04%      94.042us       3.135us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 240.460ms

2026-02-08 10:48:08,999 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.49%     562.267ms       100.00%        7.506s     250.215ms            30  
                   aten::index_add_        26.21%        1.968s        26.22%        1.968s      65.597ms            30  
                 aten::index_select        25.75%        1.933s        25.75%        1.933s      32.215ms            60  
    extension_cpp::sparse_matmul_vo        23.64%        1.774s        23.64%        1.775s      59.150ms            30  
                          aten::mul        13.80%        1.036s        13.80%        1.036s      34.535ms            30  
                    aten::index_add         0.00%     132.288us         2.45%     184.254ms       6.142ms            30  
                 aten::scatter_add_         2.45%     184.024ms         2.45%     184.030ms       6.134ms            30  
                          aten::div         0.27%      20.484ms         0.28%      20.713ms     345.222us            60  
                          aten::exp         0.20%      14.863ms         0.20%      14.863ms     495.443us            30  
                          aten::sub         0.10%       7.582ms         0.10%       7.582ms     252.744us            30  
                          aten::max         0.04%       3.230ms         0.04%       3.284ms     109.459us            30  
                        aten::zeros         0.00%     139.502us         0.02%       1.433ms      23.883us            60  
                        aten::zero_         0.00%      57.585us         0.02%       1.193ms      19.880us            60  
                        aten::fill_         0.02%       1.153ms         0.02%       1.153ms      19.215us            60  
                        aten::empty         0.00%     245.080us         0.00%     245.080us       1.362us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.506s

2026-02-08 10:48:13,862 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.16%       4.624ms       100.00%        2.885s      96.153ms            30  
    extension_cpp::sparse_attn        99.79%        2.879s        99.83%        2.880s      95.992ms            30  
               aten::new_zeros         0.00%      52.664us         0.04%       1.096ms      36.547us            30  
                   aten::zero_         0.00%      79.964us         0.04%       1.063ms      17.720us            60  
                   aten::fill_         0.03%     983.248us         0.03%     983.248us      32.775us            30  
               aten::unsqueeze         0.00%      96.959us         0.00%     118.417us       3.947us            30  
                 aten::squeeze         0.00%      82.794us         0.00%      93.250us       1.036us            90  
                   aten::empty         0.00%      88.877us         0.00%      88.877us       0.988us            90  
              aten::as_strided         0.00%      31.914us         0.00%      31.914us       0.266us           120  
               aten::new_empty         0.00%      16.669us         0.00%      28.544us       0.951us            30  
              aten::contiguous         0.00%       6.957us         0.00%       6.957us       0.077us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.885s

2026-02-08 10:48:13,865 - INFO - [42/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=70%
2026-02-08 10:48:14,326 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         4.32%       9.344ms       100.00%     216.139ms       7.205ms            30  
            aten::matmul         0.09%     194.458us        39.34%      85.031ms       1.417ms            60  
               aten::bmm        39.03%      84.363ms        39.08%      84.461ms       1.408ms            60  
       aten::masked_fill         0.05%     110.877us        33.31%      71.990ms       2.400ms            30  
      aten::masked_fill_        28.58%      61.765ms        28.58%      61.765ms       2.059ms            30  
           aten::softmax         0.02%      39.590us        15.38%      33.245ms       1.108ms            30  
          aten::_softmax        15.36%      33.205ms        15.36%      33.205ms       1.107ms            30  
               aten::div         5.09%      11.002ms         5.15%      11.139ms     371.294us            30  
             aten::clone         0.02%      44.580us         4.68%      10.114ms     337.135us            30  
             aten::copy_         4.66%      10.068ms         4.66%      10.068ms     167.798us            60  
       aten::bitwise_not         2.42%       5.228ms         2.42%       5.228ms     174.274us            30  
           aten::reshape         0.04%      82.210us         0.10%     206.626us       1.722us           120  
            aten::expand         0.06%     121.577us         0.07%     142.334us       1.186us           120  
                aten::to         0.01%      17.585us         0.06%     136.541us       4.551us            30  
          aten::_to_copy         0.02%      41.794us         0.06%     118.956us       3.965us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 216.139ms

2026-02-08 10:48:21,874 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         7.45%     333.725ms       100.00%        4.478s     149.266ms            30  
                   aten::index_add_        25.85%        1.158s        25.85%        1.158s      38.589ms            30  
                 aten::index_select        25.85%        1.158s        25.85%        1.158s      19.292ms            60  
    extension_cpp::sparse_matmul_vo        24.08%        1.078s        24.08%        1.078s      35.944ms            30  
                          aten::mul        13.61%     609.604ms        13.61%     609.604ms      20.320ms            30  
                    aten::index_add         0.00%     118.337us         2.50%     112.022ms       3.734ms            30  
                 aten::scatter_add_         2.50%     111.817ms         2.50%     111.825ms       3.727ms            30  
                          aten::div         0.26%      11.640ms         0.26%      11.854ms     197.566us            60  
                          aten::exp         0.20%       9.004ms         0.20%       9.004ms     300.133us            30  
                          aten::sub         0.09%       4.247ms         0.09%       4.247ms     141.563us            30  
                          aten::max         0.04%       1.951ms         0.04%       1.999ms      66.633us            30  
                        aten::zeros         0.00%     133.760us         0.03%       1.409ms      23.491us            60  
                        aten::zero_         0.00%      54.332us         0.03%       1.183ms      19.719us            60  
                        aten::fill_         0.03%       1.145ms         0.03%       1.145ms      19.083us            60  
                           aten::to         0.00%      30.584us         0.00%     221.501us       3.692us            60  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.478s

2026-02-08 10:48:24,828 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.26%       4.453ms       100.00%        1.743s      58.110ms            30  
    extension_cpp::sparse_attn        99.67%        1.738s        99.73%        1.739s      57.956ms            30  
               aten::new_zeros         0.00%      46.086us         0.06%       1.019ms      33.950us            30  
                   aten::zero_         0.00%      69.579us         0.06%     989.836us      16.497us            60  
                   aten::fill_         0.05%     920.257us         0.05%     920.257us      30.675us            30  
                 aten::squeeze         0.00%      79.792us         0.01%      89.546us       0.995us            90  
               aten::unsqueeze         0.00%      68.708us         0.00%      85.042us       2.835us            30  
                   aten::empty         0.00%      73.536us         0.00%      73.536us       0.817us            90  
              aten::as_strided         0.00%      26.088us         0.00%      26.088us       0.217us           120  
               aten::new_empty         0.00%      13.706us         0.00%      21.623us       0.721us            30  
              aten::contiguous         0.00%       6.212us         0.00%       6.212us       0.069us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.743s

2026-02-08 10:48:24,831 - INFO - [43/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=90%
2026-02-08 10:48:25,267 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.08%      12.460ms       100.00%     204.888ms       6.830ms            30  
            aten::matmul         0.07%     136.927us        41.22%      84.459ms       1.408ms            60  
               aten::bmm        40.98%      83.966ms        41.02%      84.044ms       1.401ms            60  
       aten::masked_fill         0.05%      93.832us        22.35%      45.797ms       1.527ms            30  
           aten::softmax         0.01%      30.085us        19.21%      39.361ms       1.312ms            30  
          aten::_softmax        19.20%      39.331ms        19.20%      39.331ms       1.311ms            30  
      aten::masked_fill_        14.02%      28.719ms        14.02%      28.719ms     957.302us            30  
               aten::div         8.54%      17.487ms         8.60%      17.616ms     587.194us            30  
             aten::clone         0.02%      38.421us         8.29%      16.984ms     566.144us            30  
             aten::copy_         8.27%      16.954ms         8.27%      16.954ms     282.573us            60  
       aten::bitwise_not         2.47%       5.069ms         2.47%       5.069ms     168.970us            30  
           aten::reshape         0.03%      64.403us         0.08%     161.118us       1.343us           120  
                aten::to         0.01%      16.165us         0.06%     128.415us       4.280us            30  
          aten::_to_copy         0.02%      38.461us         0.05%     112.250us       3.742us            30  
            aten::expand         0.04%      80.653us         0.05%      96.369us       0.803us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 204.888ms

2026-02-08 10:48:27,883 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.77%     103.554ms       100.00%        1.530s      50.986ms            30  
                 aten::index_select        25.61%     391.728ms        25.61%     391.739ms       6.529ms            60  
                   aten::index_add_        25.49%     389.946ms        25.50%     390.028ms      13.001ms            30  
    extension_cpp::sparse_matmul_vo        23.60%     361.022ms        23.61%     361.085ms      12.036ms            30  
                          aten::mul        15.31%     234.242ms        15.31%     234.242ms       7.808ms            30  
                    aten::index_add         0.01%      84.336us         2.46%      37.678ms       1.256ms            30  
                 aten::scatter_add_         2.45%      37.539ms         2.45%      37.543ms       1.251ms            30  
                          aten::div         0.26%       3.965ms         0.27%       4.130ms      68.841us            60  
                          aten::exp         0.21%       3.138ms         0.21%       3.138ms     104.611us            30  
                          aten::sub         0.09%       1.329ms         0.09%       1.329ms      44.303us            30  
                        aten::zeros         0.01%     113.960us         0.09%       1.303ms      21.717us            60  
                        aten::zero_         0.00%      47.079us         0.07%       1.105ms      18.415us            60  
                        aten::fill_         0.07%       1.067ms         0.07%       1.067ms      17.790us            60  
                          aten::max         0.06%     906.539us         0.06%     938.418us      31.281us            30  
                        aten::empty         0.01%     173.130us         0.01%     173.130us       0.962us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.530s

2026-02-08 10:48:28,888 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.22%       1.270ms       100.00%     573.491ms      19.116ms            30  
    extension_cpp::sparse_attn        99.66%     571.517ms        99.76%     572.132ms      19.071ms            30  
               aten::new_zeros         0.00%      19.917us         0.10%     570.002us      19.000us            30  
                   aten::zero_         0.01%      29.704us         0.10%     554.414us       9.240us            60  
                   aten::fill_         0.09%     524.710us         0.09%     524.710us      17.490us            30  
                 aten::squeeze         0.01%      48.802us         0.01%      57.087us       0.634us            90  
               aten::unsqueeze         0.00%      28.126us         0.01%      33.167us       1.106us            30  
                   aten::empty         0.01%      29.456us         0.01%      29.456us       0.327us            90  
              aten::as_strided         0.00%      13.326us         0.00%      13.326us       0.111us           120  
               aten::new_empty         0.00%       6.669us         0.00%      11.502us       0.383us            30  
              aten::contiguous         0.00%       4.417us         0.00%       4.417us       0.049us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 573.491ms

2026-02-08 10:48:28,891 - INFO - [44/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=95%
2026-02-08 10:48:29,311 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.57%      12.877ms       100.00%     196.092ms       6.536ms            30  
            aten::matmul         0.08%     151.991us        42.35%      83.052ms       1.384ms            60  
               aten::bmm        42.10%      82.550ms        42.13%      82.621ms       1.377ms            60  
           aten::softmax         0.02%      32.669us        20.30%      39.810ms       1.327ms            30  
          aten::_softmax        20.29%      39.777ms        20.29%      39.777ms       1.326ms            30  
       aten::masked_fill         0.05%      88.715us        19.21%      37.673ms       1.256ms            30  
      aten::masked_fill_        10.47%      20.533ms        10.47%      20.533ms     684.445us            30  
               aten::div         8.85%      17.352ms         8.91%      17.469ms     582.289us            30  
             aten::clone         0.02%      39.205us         8.70%      17.051ms     568.363us            30  
             aten::copy_         8.68%      17.015ms         8.68%      17.015ms     283.577us            60  
       aten::bitwise_not         2.59%       5.080ms         2.59%       5.080ms     169.328us            30  
           aten::reshape         0.03%      66.923us         0.08%     157.466us       1.312us           120  
                aten::to         0.01%      15.840us         0.06%     116.670us       3.889us            30  
            aten::expand         0.04%      85.628us         0.05%     102.209us       0.852us           120  
          aten::_to_copy         0.02%      34.369us         0.05%     100.830us       3.361us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 196.092ms

2026-02-08 10:48:30,559 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         5.58%      39.786ms       100.00%     713.058ms      23.769ms            30  
                 aten::index_select        27.12%     193.397ms        27.12%     193.408ms       3.223ms            60  
    extension_cpp::sparse_matmul_vo        25.39%     181.027ms        25.39%     181.076ms       6.036ms            30  
                   aten::index_add_        22.19%     158.247ms        22.20%     158.325ms       5.277ms            30  
                          aten::mul        16.08%     114.678ms        16.08%     114.678ms       3.823ms            30  
                    aten::index_add         0.01%      70.960us         2.65%      18.919ms     630.640us            30  
                 aten::scatter_add_         2.64%      18.802ms         2.64%      18.806ms     626.867us            30  
                          aten::div         0.28%       2.023ms         0.30%       2.164ms      36.071us            60  
                          aten::exp         0.23%       1.645ms         0.23%       1.645ms      54.828us            30  
                        aten::zeros         0.01%      97.408us         0.20%       1.416ms      23.601us            60  
                        aten::zero_         0.01%      48.507us         0.17%       1.240ms      20.663us            60  
                        aten::fill_         0.17%       1.197ms         0.17%       1.197ms      19.958us            60  
                          aten::max         0.09%     672.919us         0.10%     699.001us      23.300us            30  
                          aten::sub         0.08%     586.500us         0.08%     586.500us      19.550us            30  
                        aten::empty         0.02%     153.373us         0.02%     153.373us       0.852us           180  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 713.058ms

2026-02-08 10:48:31,080 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.10%     273.417us       100.00%     283.910ms       9.464ms            30  
    extension_cpp::sparse_attn        99.70%     283.063ms        99.88%     283.566ms       9.452ms            30  
               aten::new_zeros         0.01%      16.302us         0.17%     473.672us      15.789us            30  
                   aten::zero_         0.01%      19.088us         0.16%     458.041us       7.634us            60  
                   aten::fill_         0.15%     438.953us         0.15%     438.953us      14.632us            30  
                 aten::squeeze         0.01%      41.175us         0.02%      48.379us       0.538us            90  
               aten::unsqueeze         0.01%      19.037us         0.01%      22.789us       0.760us            30  
                   aten::empty         0.01%      20.253us         0.01%      20.253us       0.225us            90  
              aten::as_strided         0.00%      10.956us         0.00%      10.956us       0.091us           120  
               aten::new_empty         0.00%       4.538us         0.00%       8.498us       0.283us            30  
              aten::contiguous         0.00%       3.252us         0.00%       3.252us       0.036us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 283.910ms

2026-02-08 10:48:31,083 - INFO - [45/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=99%
2026-02-08 10:48:31,494 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.48%      16.484ms       100.00%     194.362ms       6.479ms            30  
            aten::matmul         0.09%     168.420us        42.48%      82.561ms       1.376ms            60  
               aten::bmm        42.18%      81.987ms        42.23%      82.072ms       1.368ms            60  
           aten::softmax         0.02%      37.916us        20.10%      39.063ms       1.302ms            30  
          aten::_softmax        20.08%      39.025ms        20.08%      39.025ms       1.301ms            30  
       aten::masked_fill         0.06%     108.916us        16.85%      32.752ms       1.092ms            30  
               aten::div         9.37%      18.220ms         9.45%      18.365ms     612.167us            30  
             aten::clone         0.03%      48.626us         8.81%      17.114ms     570.468us            30  
             aten::copy_         8.78%      17.067ms         8.78%      17.067ms     284.454us            60  
      aten::masked_fill_         7.99%      15.529ms         7.99%      15.529ms     517.637us            30  
       aten::bitwise_not         2.57%       4.985ms         2.57%       4.985ms     166.181us            30  
           aten::reshape         0.04%      72.327us         0.09%     176.539us       1.471us           120  
                aten::to         0.01%      19.627us         0.07%     144.876us       4.829us            30  
          aten::_to_copy         0.02%      45.794us         0.06%     125.249us       4.175us            30  
            aten::expand         0.05%     101.218us         0.06%     121.044us       1.009us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 194.362ms

2026-02-08 10:48:31,785 - INFO - -----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                               Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                      ProfilerStep*         6.24%       8.490ms       100.00%     136.005ms       4.533ms            30  
    extension_cpp::sparse_matmul_vo        25.24%      34.328ms        25.25%      34.342ms       1.145ms            30  
                 aten::index_select        25.23%      34.310ms        25.23%      34.319ms     571.976us            60  
                   aten::index_add_        22.67%      30.833ms        22.70%      30.867ms       1.029ms            30  
                          aten::mul        15.38%      20.923ms        15.38%      20.923ms     697.448us            30  
                    aten::index_add         0.02%      33.672us         2.83%       3.846ms     128.189us            30  
                 aten::scatter_add_         2.78%       3.783ms         2.78%       3.784ms     126.141us            30  
                        aten::zeros         0.03%      37.371us         0.71%     970.754us      16.179us            60  
                        aten::zero_         0.01%      20.340us         0.67%     910.008us      15.167us            60  
                        aten::fill_         0.66%     892.710us         0.66%     892.710us      14.879us            60  
                          aten::div         0.56%     760.413us         0.59%     798.374us      13.306us            60  
                          aten::exp         0.40%     542.795us         0.40%     542.795us      18.093us            30  
                          aten::max         0.29%     395.128us         0.30%     406.502us      13.550us            30  
                          aten::sub         0.25%     346.623us         0.25%     346.623us      11.554us            30  
                       aten::select         0.04%      60.576us         0.05%      73.952us       0.616us           120  
-----------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 136.005ms

2026-02-08 10:48:31,925 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.44%     241.908us       100.00%      54.826ms       1.828ms            30  
    extension_cpp::sparse_attn        98.50%      54.005ms        99.44%      54.519ms       1.817ms            30  
               aten::new_zeros         0.03%      15.954us         0.89%     489.125us      16.304us            30  
                   aten::zero_         0.03%      16.208us         0.86%     472.834us       7.881us            60  
                   aten::fill_         0.83%     456.626us         0.83%     456.626us      15.221us            30  
                 aten::squeeze         0.07%      38.080us         0.08%      44.670us       0.496us            90  
               aten::unsqueeze         0.03%      16.503us         0.04%      19.585us       0.653us            30  
                   aten::empty         0.03%      18.291us         0.03%      18.291us       0.203us            90  
              aten::as_strided         0.02%       9.672us         0.02%       9.672us       0.081us           120  
               aten::new_empty         0.01%       4.089us         0.01%       7.879us       0.263us            30  
              aten::contiguous         0.01%       3.128us         0.01%       3.128us       0.035us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 54.826ms

