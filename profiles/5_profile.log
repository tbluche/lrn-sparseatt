2026-02-11 09:48:11,306 - INFO - [1/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=50%
2026-02-11 09:48:11,734 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.88%     827.964us       100.00%      14.070ms     469.014us            30  
       aten::masked_fill         0.18%      25.922us        46.07%       6.482ms     216.061us            30  
      aten::masked_fill_        42.53%       5.984ms        42.53%       5.984ms     199.465us            30  
            aten::matmul         0.53%      74.206us        20.28%       2.854ms      47.568us            60  
               aten::bmm        18.38%       2.586ms        18.78%       2.643ms      44.047us            60  
           aten::softmax         0.07%      10.168us        18.02%       2.536ms      84.519us            30  
          aten::_softmax        17.95%       2.525ms        17.95%       2.525ms      84.180us            30  
               aten::div         5.97%     840.382us         6.23%     876.174us      29.206us            30  
             aten::clone         0.10%      14.166us         3.35%     471.959us      15.732us            30  
             aten::copy_         3.24%     455.877us         3.24%     455.877us       7.598us            60  
       aten::bitwise_not         3.12%     438.920us         3.12%     438.920us      14.631us            30  
           aten::reshape         0.21%      29.828us         0.54%      75.703us       0.631us           120  
            aten::expand         0.29%      40.635us         0.37%      51.923us       0.433us           120  
            aten::select         0.26%      36.877us         0.36%      50.042us       0.278us           180  
                aten::to         0.04%       5.250us         0.25%      35.792us       1.193us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 14.070ms

2026-02-11 09:48:11,995 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         5.63%       3.491ms       100.00%      62.065ms       2.069ms            30  
                       aten::to_sparse_csr         0.01%       5.918us        35.59%      22.089ms     736.285us            30  
                      aten::_to_sparse_csr         0.78%     483.095us        35.58%      22.083ms     736.088us            30  
                             aten::nonzero        25.93%      16.096ms        25.99%      16.130ms     268.828us            60  
                            aten::to_dense         0.01%       7.585us        25.98%      16.125ms     537.499us            30  
                           aten::_to_dense         1.97%       1.224ms        25.97%      16.117ms     537.246us            30  
                               aten::copy_        12.26%       7.610ms        14.47%       8.982ms      19.961us           450  
                         aten::masked_fill         0.05%      30.749us        11.33%       7.031ms     234.377us            30  
                                 aten::mul         7.81%       4.847ms        10.28%       6.380ms      26.584us           240  
                        aten::masked_fill_        10.23%       6.348ms        10.23%       6.348ms     211.587us            30  
                aten::sparse_sampled_addmm         5.78%       3.586ms         8.36%       5.188ms     172.938us            30  
                            aten::_to_copy         0.19%     116.084us         7.56%       4.695ms      26.082us           180  
                                  aten::to         0.03%      18.116us         5.26%       3.265ms      27.205us           120  
                                  aten::ne         2.30%       1.428ms         4.99%       3.099ms     103.307us            30  
                             aten::softmax         0.02%      12.704us         4.89%       3.033ms     101.089us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 62.065ms

2026-02-11 09:48:12,150 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.33%     639.758us       100.00%      48.036ms       1.601ms            30  
    extension_cpp::sparse_attn        98.46%      47.298ms        98.56%      47.343ms       1.578ms            30  
                 aten::squeeze         0.07%      32.581us         0.08%      38.665us       0.430us            90  
               aten::new_zeros         0.02%       9.000us         0.05%      25.749us       0.858us            30  
                   aten::empty         0.03%      16.291us         0.03%      16.291us       0.181us            90  
               aten::unsqueeze         0.03%      12.085us         0.03%      14.457us       0.482us            30  
                   aten::zero_         0.03%      12.248us         0.03%      12.248us       0.204us            60  
              aten::as_strided         0.02%       8.456us         0.02%       8.456us       0.070us           120  
               aten::new_empty         0.01%       4.583us         0.02%       8.207us       0.274us            30  
              aten::contiguous         0.01%       2.710us         0.01%       2.710us       0.030us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 48.036ms

2026-02-11 09:48:12,152 - INFO - [2/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=70%
2026-02-11 09:48:12,251 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.58%       1.031ms       100.00%      13.603ms     453.444us            30  
       aten::masked_fill         0.22%      29.747us        38.06%       5.177ms     172.564us            30  
      aten::masked_fill_        33.51%       4.558ms        33.51%       4.558ms     151.936us            30  
           aten::softmax         0.09%      11.746us        22.57%       3.070ms     102.328us            30  
          aten::_softmax        22.48%       3.058ms        22.48%       3.058ms     101.937us            30  
            aten::matmul         0.56%      75.799us        20.52%       2.791ms      46.514us            60  
               aten::bmm        18.64%       2.536ms        19.05%       2.592ms      43.195us            60  
               aten::div         7.81%       1.062ms         8.07%       1.097ms      36.580us            30  
             aten::clone         0.12%      16.122us         4.33%     589.114us      19.637us            30  
             aten::copy_         4.16%     566.077us         4.16%     566.077us       9.435us            60  
       aten::bitwise_not         2.85%     387.493us         2.85%     387.493us      12.916us            30  
           aten::reshape         0.20%      27.246us         0.46%      62.540us       0.521us           120  
            aten::expand         0.29%      39.871us         0.37%      50.869us       0.424us           120  
            aten::select         0.26%      35.869us         0.36%      49.621us       0.276us           180  
                aten::to         0.04%       4.997us         0.26%      35.456us       1.182us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 13.603ms

2026-02-11 09:48:12,488 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         6.91%       3.242ms       100.00%      46.924ms       1.564ms            30  
                       aten::to_sparse_csr         0.01%       5.125us        36.77%      17.254ms     575.141us            30  
                      aten::_to_sparse_csr         1.28%     600.594us        36.76%      17.249ms     574.971us            30  
                             aten::nonzero        25.05%      11.754ms        25.11%      11.784ms     196.397us            60  
                            aten::to_dense         0.01%       5.996us        23.70%      11.120ms     370.658us            30  
                           aten::_to_dense         2.09%     978.795us        23.68%      11.114ms     370.458us            30  
                               aten::copy_        13.55%       6.357ms        15.82%       7.422ms      16.493us           450  
                         aten::masked_fill         0.06%      26.784us        10.90%       5.115ms     170.507us            30  
                                 aten::mul         7.25%       3.404ms         9.69%       4.545ms      18.939us           240  
                        aten::masked_fill_         8.93%       4.189ms         8.93%       4.189ms     139.633us            30  
                            aten::_to_copy         0.25%     115.071us         8.12%       3.809ms      21.161us           180  
                aten::sparse_sampled_addmm         4.82%       2.263ms         7.57%       3.552ms     118.409us            30  
                                  aten::ne         3.33%       1.562ms         6.86%       3.219ms     107.301us            30  
                                  aten::to         0.04%      16.960us         5.99%       2.811ms      23.429us           120  
                             aten::softmax         0.02%      11.205us         5.92%       2.779ms      92.647us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 46.924ms

2026-02-11 09:48:12,611 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.65%     182.708us       100.00%      28.070ms     935.655us            30  
    extension_cpp::sparse_attn        99.03%      27.797ms        99.17%      27.838ms     927.935us            30  
                 aten::squeeze         0.11%      30.745us         0.13%      35.665us       0.396us            90  
               aten::new_zeros         0.03%       8.875us         0.09%      24.208us       0.807us            30  
                   aten::empty         0.05%      14.751us         0.05%      14.751us       0.164us            90  
               aten::unsqueeze         0.04%      11.045us         0.05%      13.251us       0.442us            30  
                   aten::zero_         0.04%      11.042us         0.04%      11.042us       0.184us            60  
              aten::as_strided         0.03%       7.126us         0.03%       7.126us       0.059us           120  
               aten::new_empty         0.01%       3.960us         0.03%       7.084us       0.236us            30  
              aten::contiguous         0.01%       2.630us         0.01%       2.630us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 28.070ms

2026-02-11 09:48:12,614 - INFO - [3/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=90%
2026-02-11 09:48:12,706 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.71%     805.769us       100.00%      10.445ms     348.164us            30  
            aten::matmul         0.68%      70.660us        27.47%       2.869ms      47.814us            60  
       aten::masked_fill         0.25%      26.169us        26.42%       2.759ms      91.971us            30  
           aten::softmax         0.10%      10.255us        25.81%       2.696ms      89.865us            30  
          aten::_softmax        25.71%       2.686ms        25.71%       2.686ms      89.523us            30  
               aten::bmm        25.07%       2.619ms        25.63%       2.677ms      44.619us            60  
      aten::masked_fill_        21.17%       2.211ms        21.17%       2.211ms      73.712us            30  
               aten::div         8.22%     858.550us         8.53%     890.755us      29.692us            30  
             aten::clone         0.13%      13.503us         4.99%     521.595us      17.387us            30  
             aten::copy_         4.82%     503.719us         4.82%     503.719us       8.395us            60  
       aten::bitwise_not         3.59%     375.050us         3.59%     375.050us      12.502us            30  
           aten::reshape         0.26%      26.800us         0.59%      61.465us       0.512us           120  
            aten::select         0.36%      37.371us         0.50%      51.709us       0.287us           180  
            aten::expand         0.37%      39.167us         0.48%      50.499us       0.421us           120  
        aten::as_strided         0.34%      35.171us         0.34%      35.171us       0.098us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 10.445ms

2026-02-11 09:48:12,909 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.11%       1.125ms       100.00%      27.411ms     913.709us            30  
                       aten::to_sparse_csr         0.02%       5.333us        42.82%      11.739ms     391.285us            30  
                      aten::_to_sparse_csr         2.25%     616.952us        42.80%      11.733ms     391.107us            30  
                             aten::nonzero        26.95%       7.386ms        27.04%       7.411ms     123.519us            60  
                            aten::to_dense         0.02%       5.257us        17.96%       4.924ms     164.136us            30  
                           aten::_to_dense         2.51%     686.703us        17.94%       4.919ms     163.961us            30  
                               aten::copy_        12.00%       3.290ms        12.72%       3.486ms       7.746us           450  
                         aten::masked_fill         0.10%      26.706us        11.10%       3.044ms     101.456us            30  
                                  aten::ne         5.55%       1.521ms        10.97%       3.007ms     100.247us            30  
                             aten::softmax         0.04%      10.674us        10.13%       2.775ms      92.515us            30  
                            aten::_softmax        10.09%       2.765ms        10.09%       2.765ms      92.159us            30  
                        aten::masked_fill_         8.10%       2.221ms         8.10%       2.221ms      74.044us            30  
                            aten::_to_copy         0.27%      72.944us         7.72%       2.115ms      11.752us           180  
                                  aten::to         0.05%      14.428us         6.76%       1.852ms      15.437us           120  
                aten::sparse_sampled_addmm         4.44%       1.217ms         5.66%       1.553ms      51.759us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 27.411ms

2026-02-11 09:48:13,003 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         5.63%     561.035us       100.00%       9.970ms     332.338us            30  
    extension_cpp::sparse_attn        93.44%       9.316ms        93.87%       9.359ms     311.968us            30  
                 aten::squeeze         0.31%      31.006us         0.36%      36.251us       0.403us            90  
               aten::new_zeros         0.09%       8.675us         0.26%      26.001us       0.867us            30  
                   aten::empty         0.16%      15.792us         0.16%      15.792us       0.175us            90  
               aten::unsqueeze         0.12%      11.581us         0.14%      13.791us       0.460us            30  
                   aten::zero_         0.13%      13.244us         0.13%      13.244us       0.221us            60  
              aten::as_strided         0.07%       7.455us         0.07%       7.455us       0.062us           120  
               aten::new_empty         0.03%       3.291us         0.07%       7.165us       0.239us            30  
              aten::contiguous         0.02%       2.246us         0.02%       2.246us       0.025us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.970ms

2026-02-11 09:48:13,005 - INFO - [4/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=95%
2026-02-11 09:48:13,097 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.57%     715.582us       100.00%       9.455ms     315.175us            30  
           aten::softmax         0.10%       9.711us        28.43%       2.689ms      89.619us            30  
          aten::_softmax        28.33%       2.679ms        28.33%       2.679ms      89.295us            30  
            aten::matmul         0.75%      70.865us        26.26%       2.483ms      41.386us            60  
               aten::bmm        23.59%       2.230ms        24.22%       2.290ms      38.165us            60  
       aten::masked_fill         0.29%      27.462us        23.48%       2.220ms      74.008us            30  
      aten::masked_fill_        17.22%       1.628ms        17.22%       1.628ms      54.262us            30  
               aten::div         9.56%     903.493us         9.92%     937.744us      31.258us            30  
             aten::clone         0.16%      15.246us         5.97%     564.906us      18.830us            30  
             aten::copy_         5.76%     544.948us         5.76%     544.948us       9.082us            60  
       aten::bitwise_not         3.83%     361.706us         3.83%     361.706us      12.057us            30  
           aten::reshape         0.28%      26.157us         0.65%      61.200us       0.510us           120  
            aten::select         0.42%      39.742us         0.56%      53.033us       0.295us           180  
            aten::expand         0.43%      40.382us         0.55%      51.802us       0.432us           120  
                aten::to         0.05%       5.167us         0.36%      34.251us       1.142us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.455ms

2026-02-11 09:48:13,284 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.92%       1.083ms       100.00%      22.000ms     733.346us            30  
                       aten::to_sparse_csr         0.03%       5.544us        44.25%       9.735ms     324.507us            30  
                      aten::_to_sparse_csr         2.45%     538.508us        44.22%       9.730ms     324.322us            30  
                             aten::nonzero        26.52%       5.836ms        26.64%       5.861ms      97.676us            60  
                            aten::to_dense         0.03%       6.873us        13.34%       2.935ms      97.839us            30  
                           aten::_to_dense         1.57%     345.231us        13.31%       2.928ms      97.610us            30  
                                  aten::ne         6.61%       1.453ms        13.31%       2.928ms      97.598us            30  
                               aten::copy_        12.07%       2.655ms        12.64%       2.780ms       6.178us           450  
                             aten::softmax         0.05%      10.504us        12.52%       2.755ms      91.824us            30  
                            aten::_softmax        12.47%       2.744ms        12.47%       2.744ms      91.474us            30  
                         aten::masked_fill         0.12%      26.041us        11.22%       2.468ms      82.281us            30  
                            aten::_to_copy         0.35%      76.463us         8.69%       1.911ms      10.617us           180  
                                  aten::to         0.07%      15.507us         7.95%       1.750ms      14.579us           120  
                        aten::masked_fill_         7.65%       1.682ms         7.65%       1.682ms      56.067us            30  
                aten::sparse_sampled_addmm         3.79%     832.874us         4.99%       1.097ms      36.570us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 22.000ms

2026-02-11 09:48:13,366 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         3.66%     176.335us       100.00%       4.818ms     160.612us            30  
    extension_cpp::sparse_attn        94.47%       4.552ms        95.32%       4.593ms     153.091us            30  
                 aten::squeeze         0.62%      29.905us         0.73%      35.410us       0.393us            90  
               aten::new_zeros         0.18%       8.574us         0.49%      23.831us       0.794us            30  
                   aten::empty         0.30%      14.414us         0.30%      14.414us       0.160us            90  
               aten::unsqueeze         0.24%      11.705us         0.29%      13.873us       0.462us            30  
                   aten::zero_         0.24%      11.375us         0.24%      11.375us       0.190us            60  
              aten::as_strided         0.16%       7.673us         0.16%       7.673us       0.064us           120  
               aten::new_empty         0.08%       3.673us         0.15%       7.089us       0.236us            30  
              aten::contiguous         0.05%       2.584us         0.05%       2.584us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.818ms

2026-02-11 09:48:13,369 - INFO - [5/45] Profiling attention with seq_len=512, d_model=32, n_heads=1, sparsity=99%
2026-02-11 09:48:13,457 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        11.20%       1.062ms       100.00%       9.485ms     316.159us            30  
           aten::softmax         0.11%      10.126us        27.36%       2.595ms      86.502us            30  
          aten::_softmax        27.25%       2.585ms        27.25%       2.585ms      86.164us            30  
            aten::matmul         0.74%      70.326us        26.65%       2.528ms      42.135us            60  
               aten::bmm        24.03%       2.279ms        24.66%       2.339ms      38.988us            60  
       aten::masked_fill         0.28%      26.341us        20.29%       1.925ms      64.156us            30  
      aten::masked_fill_        13.91%       1.320ms        13.91%       1.320ms      43.984us            30  
               aten::div         9.18%     870.689us         9.50%     901.146us      30.038us            30  
             aten::clone         0.15%      13.956us         6.10%     578.798us      19.293us            30  
             aten::copy_         5.90%     559.255us         5.90%     559.255us       9.321us            60  
       aten::bitwise_not         4.48%     424.632us         4.48%     424.632us      14.154us            30  
           aten::reshape         0.27%      25.916us         0.63%      59.504us       0.496us           120  
            aten::select         0.42%      40.161us         0.56%      53.577us       0.298us           180  
            aten::expand         0.41%      39.251us         0.53%      50.422us       0.420us           120  
        aten::as_strided         0.36%      33.875us         0.36%      33.875us       0.094us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 9.485ms

2026-02-11 09:48:13,641 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         3.82%     740.662us       100.00%      19.398ms     646.594us            30  
                       aten::to_sparse_csr         0.03%       4.919us        45.85%       8.895ms     296.492us            30  
                      aten::_to_sparse_csr         2.66%     516.375us        45.83%       8.890ms     296.328us            30  
                             aten::nonzero        26.54%       5.148ms        26.67%       5.173ms      86.214us            60  
                                  aten::ne         7.42%       1.438ms        15.54%       3.014ms     100.461us            30  
                             aten::softmax         0.06%      11.374us        13.37%       2.593ms      86.418us            30  
                            aten::_softmax        13.31%       2.581ms        13.31%       2.581ms      86.039us            30  
                               aten::copy_        12.75%       2.474ms        13.11%       2.543ms       5.651us           450  
                         aten::masked_fill         0.13%      25.672us        11.21%       2.175ms      72.489us            30  
                            aten::to_dense         0.03%       6.502us        11.19%       2.171ms      72.354us            30  
                           aten::_to_dense         3.16%     612.077us        11.16%       2.164ms      72.137us            30  
                            aten::_to_copy         0.39%      75.329us         9.47%       1.836ms      10.203us           180  
                                  aten::to         0.07%      14.501us         9.09%       1.762ms      14.687us           120  
                        aten::masked_fill_         7.20%       1.397ms         7.20%       1.397ms      46.583us            30  
                              aten::matmul         0.20%      39.457us         6.92%       1.343ms      44.754us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 19.398ms

2026-02-11 09:48:13,718 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*        15.86%     182.150us       100.00%       1.149ms      38.284us            30  
    extension_cpp::sparse_attn        76.48%     878.359us        79.98%     918.627us      30.621us            30  
                 aten::squeeze         2.55%      29.283us         3.03%      34.826us       0.387us            90  
               aten::new_zeros         0.76%       8.706us         2.04%      23.412us       0.780us            30  
                   aten::empty         1.30%      14.953us         1.30%      14.953us       0.166us            90  
               aten::unsqueeze         0.95%      10.918us         1.12%      12.914us       0.430us            30  
                   aten::zero_         0.95%      10.864us         0.95%      10.864us       0.181us            60  
              aten::as_strided         0.66%       7.539us         0.66%       7.539us       0.063us           120  
               aten::new_empty         0.28%       3.167us         0.58%       6.626us       0.221us            30  
              aten::contiguous         0.22%       2.578us         0.22%       2.578us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.149ms

2026-02-11 09:48:13,721 - INFO - [6/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=50%
2026-02-11 09:48:13,821 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.46%     769.716us       100.00%      14.089ms     469.642us            30  
       aten::masked_fill         0.19%      26.705us        47.59%       6.705ms     223.496us            30  
      aten::masked_fill_        42.98%       6.055ms        42.98%       6.055ms     201.844us            30  
            aten::matmul         0.50%      70.832us        19.76%       2.784ms      46.400us            60  
           aten::softmax         0.07%       9.998us        19.62%       2.764ms      92.130us            30  
          aten::_softmax        19.55%       2.754ms        19.55%       2.754ms      91.797us            30  
               aten::bmm        18.01%       2.537ms        18.41%       2.594ms      43.237us            60  
               aten::div         4.51%     635.249us         4.75%     669.332us      22.311us            30  
             aten::clone         0.10%      14.418us         4.42%     622.835us      20.761us            30  
             aten::copy_         4.29%     604.083us         4.29%     604.083us      10.068us            60  
       aten::bitwise_not         2.48%     349.500us         2.48%     349.500us      11.650us            30  
           aten::reshape         0.18%      25.539us         0.42%      59.707us       0.498us           120  
            aten::select         0.26%      36.293us         0.36%      50.499us       0.281us           180  
            aten::expand         0.28%      38.918us         0.36%      50.208us       0.418us           120  
        aten::as_strided         0.25%      34.868us         0.25%      34.868us       0.097us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 14.089ms

2026-02-11 09:48:14,085 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         5.31%       3.381ms       100.00%      63.645ms       2.121ms            30  
                       aten::to_sparse_csr         0.01%       5.457us        34.32%      21.841ms     728.044us            30  
                      aten::_to_sparse_csr         0.63%     398.591us        34.31%      21.836ms     727.862us            30  
                            aten::to_dense         0.01%       6.914us        24.99%      15.903ms     530.089us            30  
                           aten::_to_dense         2.43%       1.549ms        24.98%      15.896ms     529.858us            30  
                             aten::nonzero        24.43%      15.551ms        24.49%      15.583ms     259.724us            60  
                               aten::copy_        12.32%       7.839ms        14.56%       9.264ms      20.587us           450  
                aten::sparse_sampled_addmm         9.65%       6.140ms        12.22%       7.780ms     259.335us            30  
                         aten::masked_fill         0.05%      31.378us        10.60%       6.747ms     224.903us            30  
                                 aten::mul         7.41%       4.717ms         9.83%       6.254ms      26.058us           240  
                        aten::masked_fill_         9.49%       6.040ms         9.49%       6.040ms     201.331us            30  
                            aten::_to_copy         0.19%     118.990us         7.28%       4.631ms      25.727us           180  
                                  aten::ne         2.47%       1.570ms         5.38%       3.422ms     114.083us            30  
                                  aten::to         0.03%      17.711us         5.22%       3.323ms      27.694us           120  
                          aten::index_add_         4.41%       2.809ms         4.41%       2.809ms      93.633us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 63.645ms

2026-02-11 09:48:14,292 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.43%     335.626us       100.00%      78.526ms       2.618ms            30  
    extension_cpp::sparse_attn        99.41%      78.060ms        99.50%      78.136ms       2.605ms            30  
               aten::new_zeros         0.01%       8.915us         0.08%      59.041us       1.968us            30  
                   aten::zero_         0.01%       5.965us         0.06%      46.004us       0.767us            60  
                   aten::fill_         0.05%      40.039us         0.05%      40.039us       1.335us            30  
                 aten::squeeze         0.04%      33.245us         0.05%      39.121us       0.435us            90  
                   aten::empty         0.02%      15.166us         0.02%      15.166us       0.169us            90  
               aten::unsqueeze         0.02%      12.375us         0.02%      14.749us       0.492us            30  
              aten::as_strided         0.01%       8.250us         0.01%       8.250us       0.069us           120  
               aten::new_empty         0.00%       3.622us         0.01%       6.997us       0.233us            30  
              aten::contiguous         0.00%       2.625us         0.00%       2.625us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 78.526ms

2026-02-11 09:48:14,295 - INFO - [7/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=70%
2026-02-11 09:48:14,392 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.24%     664.278us       100.00%      12.665ms     422.178us            30  
       aten::masked_fill         0.21%      27.160us        37.15%       4.705ms     156.830us            30  
      aten::masked_fill_        32.57%       4.125ms        32.57%       4.125ms     137.516us            30  
            aten::matmul         0.53%      67.002us        26.66%       3.377ms      56.287us            60  
               aten::bmm        24.82%       3.144ms        25.25%       3.198ms      53.307us            60  
           aten::softmax         0.08%      10.205us        20.69%       2.621ms      87.358us            30  
          aten::_softmax        20.61%       2.611ms        20.61%       2.611ms      87.018us            30  
               aten::div         6.66%     843.002us         6.90%     873.627us      29.121us            30  
             aten::clone         0.12%      15.208us         4.36%     552.252us      18.408us            30  
             aten::copy_         4.20%     531.371us         4.20%     531.371us       8.856us            60  
       aten::bitwise_not         2.99%     378.500us         2.99%     378.500us      12.617us            30  
           aten::reshape         0.19%      24.637us         0.44%      56.294us       0.469us           120  
            aten::select         0.29%      36.367us         0.39%      48.914us       0.272us           180  
            aten::expand         0.29%      36.702us         0.38%      47.623us       0.397us           120  
        aten::as_strided         0.26%      32.717us         0.26%      32.717us       0.091us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.665ms

2026-02-11 09:48:14,623 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         5.22%       2.426ms       100.00%      46.459ms       1.549ms            30  
                       aten::to_sparse_csr         0.01%       5.172us        36.16%      16.797ms     559.915us            30  
                      aten::_to_sparse_csr         1.00%     465.215us        36.14%      16.792ms     559.742us            30  
                             aten::nonzero        24.94%      11.586ms        25.00%      11.613ms     193.557us            60  
                            aten::to_dense         0.01%       5.952us        22.84%      10.612ms     353.724us            30  
                           aten::_to_dense         1.78%     826.853us        22.83%      10.606ms     353.526us            30  
                               aten::copy_        12.20%       5.670ms        14.03%       6.517ms      14.483us           450  
                         aten::masked_fill         0.06%      25.909us        10.50%       4.880ms     162.673us            30  
                aten::sparse_sampled_addmm         8.17%       3.797ms        10.46%       4.858ms     161.933us            30  
                                 aten::mul         7.13%       3.312ms         9.40%       4.367ms      18.194us           240  
                        aten::masked_fill_         8.92%       4.142ms         8.92%       4.142ms     138.079us            30  
                            aten::_to_copy         0.24%     110.031us         7.86%       3.653ms      20.296us           180  
                                  aten::ne         3.26%       1.513ms         6.68%       3.103ms     103.427us            30  
                             aten::softmax         0.02%      10.752us         6.02%       2.796ms      93.188us            30  
                            aten::_softmax         5.99%       2.785ms         5.99%       2.785ms      92.830us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 46.459ms

2026-02-11 09:48:14,775 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.39%     180.081us       100.00%      46.014ms       1.534ms            30  
    extension_cpp::sparse_attn        99.34%      45.709ms        99.50%      45.785ms       1.526ms            30  
               aten::new_zeros         0.02%       8.589us         0.13%      58.919us       1.964us            30  
                   aten::zero_         0.01%       6.664us         0.10%      46.204us       0.770us            60  
                   aten::fill_         0.09%      39.540us         0.09%      39.540us       1.318us            30  
                 aten::squeeze         0.07%      30.586us         0.08%      36.044us       0.400us            90  
                   aten::empty         0.03%      14.916us         0.03%      14.916us       0.166us            90  
               aten::unsqueeze         0.02%      11.166us         0.03%      13.458us       0.449us            30  
              aten::as_strided         0.02%       7.750us         0.02%       7.750us       0.065us           120  
               aten::new_empty         0.01%       3.791us         0.02%       7.207us       0.240us            30  
              aten::contiguous         0.01%       2.663us         0.01%       2.663us       0.030us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 46.014ms

2026-02-11 09:48:14,778 - INFO - [8/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=90%
2026-02-11 09:48:14,875 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.38%       1.060ms       100.00%      11.299ms     376.629us            30  
            aten::matmul         0.62%      70.496us        30.18%       3.410ms      56.826us            60  
               aten::bmm        27.99%       3.162ms        28.49%       3.219ms      53.646us            60  
       aten::masked_fill         0.24%      27.286us        24.95%       2.819ms      93.953us            30  
           aten::softmax         0.08%       9.418us        23.97%       2.709ms      90.293us            30  
          aten::_softmax        23.89%       2.699ms        23.89%       2.699ms      89.979us            30  
      aten::masked_fill_        19.70%       2.226ms        19.70%       2.226ms      74.200us            30  
               aten::div         7.63%     862.415us         7.93%     895.747us      29.858us            30  
             aten::clone         0.12%      13.709us         5.00%     565.292us      18.843us            30  
             aten::copy_         4.84%     546.917us         4.84%     546.917us       9.115us            60  
       aten::bitwise_not         3.17%     358.625us         3.17%     358.625us      11.954us            30  
           aten::reshape         0.23%      25.988us         0.54%      61.370us       0.511us           120  
            aten::expand         0.34%      38.374us         0.44%      49.965us       0.416us           120  
            aten::select         0.31%      35.462us         0.44%      49.792us       0.277us           180  
        aten::as_strided         0.31%      34.965us         0.31%      34.965us       0.097us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 11.299ms

2026-02-11 09:48:15,079 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         3.85%       1.074ms       100.00%      27.910ms     930.330us            30  
                       aten::to_sparse_csr         0.02%       5.289us        41.62%      11.615ms     387.174us            30  
                      aten::_to_sparse_csr         2.80%     780.800us        41.60%      11.610ms     386.997us            30  
                             aten::nonzero        25.04%       6.989ms        25.14%       7.015ms     116.921us            60  
                            aten::to_dense         0.02%       5.709us        16.77%       4.681ms     156.040us            30  
                           aten::_to_dense         2.30%     641.081us        16.75%       4.675ms     155.850us            30  
                               aten::copy_        11.90%       3.322ms        12.61%       3.520ms       7.822us           450  
                                  aten::ne         5.36%       1.496ms        11.15%       3.112ms     103.740us            30  
                         aten::masked_fill         0.10%      26.833us        10.68%       2.980ms      99.327us            30  
                             aten::softmax         0.04%      11.130us         9.94%       2.775ms      92.503us            30  
                            aten::_softmax         9.90%       2.764ms         9.90%       2.764ms      92.132us            30  
                            aten::_to_copy         0.26%      72.221us         8.26%       2.305ms      12.808us           180  
                        aten::masked_fill_         7.70%       2.148ms         7.70%       2.148ms      71.605us            30  
                aten::sparse_sampled_addmm         6.28%       1.753ms         7.51%       2.096ms      69.858us            30  
                                  aten::to         0.05%      14.410us         7.21%       2.014ms      16.780us           120  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 27.910ms

2026-02-11 09:48:15,180 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.15%     178.791us       100.00%      15.538ms     517.935us            30  
    extension_cpp::sparse_attn        98.05%      15.235ms        98.54%      15.310ms     510.350us            30  
               aten::new_zeros         0.06%       9.083us         0.38%      59.752us       1.992us            30  
                   aten::zero_         0.04%       5.870us         0.30%      46.208us       0.770us            60  
                   aten::fill_         0.26%      40.338us         0.26%      40.338us       1.345us            30  
                 aten::squeeze         0.19%      29.797us         0.23%      35.208us       0.391us            90  
                   aten::empty         0.09%      14.667us         0.09%      14.667us       0.163us            90  
               aten::unsqueeze         0.07%      11.295us         0.09%      13.545us       0.452us            30  
              aten::as_strided         0.05%       7.661us         0.05%       7.661us       0.064us           120  
               aten::new_empty         0.02%       3.289us         0.05%       7.375us       0.246us            30  
              aten::contiguous         0.02%       2.420us         0.02%       2.420us       0.027us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 15.538ms

2026-02-11 09:48:15,182 - INFO - [9/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=95%
2026-02-11 09:48:15,276 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.72%     975.127us       100.00%      11.180ms     372.674us            30  
            aten::matmul         0.61%      68.114us        33.87%       3.786ms      63.107us            60  
               aten::bmm        31.74%       3.548ms        32.23%       3.604ms      60.059us            60  
           aten::softmax         0.08%       8.794us        24.07%       2.691ms      89.703us            30  
          aten::_softmax        23.99%       2.682ms        23.99%       2.682ms      89.410us            30  
       aten::masked_fill         0.23%      26.168us        21.00%       2.347ms      78.249us            30  
      aten::masked_fill_        15.04%       1.681ms        15.04%       1.681ms      56.048us            30  
               aten::div         8.41%     940.652us         8.69%     971.903us      32.397us            30  
             aten::clone         0.12%      13.875us         5.72%     639.867us      21.329us            30  
             aten::copy_         5.54%     619.914us         5.54%     619.914us      10.332us            60  
       aten::bitwise_not         3.23%     361.282us         3.23%     361.282us      12.043us            30  
           aten::reshape         0.23%      25.835us         0.52%      58.330us       0.486us           120  
            aten::select         0.31%      35.207us         0.43%      48.587us       0.270us           180  
            aten::expand         0.33%      36.748us         0.43%      48.002us       0.400us           120  
        aten::as_strided         0.30%      33.425us         0.30%      33.425us       0.093us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 11.180ms

2026-02-11 09:48:15,468 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         5.51%       1.306ms       100.00%      23.690ms     789.665us            30  
                       aten::to_sparse_csr         0.02%       5.412us        41.21%       9.763ms     325.420us            30  
                      aten::_to_sparse_csr         1.50%     355.291us        41.19%       9.757ms     325.240us            30  
                             aten::nonzero        24.96%       5.913ms        25.07%       5.938ms      98.967us            60  
                            aten::to_dense         0.02%       5.626us        13.53%       3.205ms     106.847us            30  
                           aten::_to_dense         1.98%     468.606us        13.51%       3.200ms     106.659us            30  
                                  aten::ne         6.21%       1.472ms        12.90%       3.057ms     101.899us            30  
                               aten::copy_        12.03%       2.851ms        12.57%       2.978ms       6.617us           450  
                             aten::softmax         0.04%       9.707us        11.73%       2.779ms      92.634us            30  
                            aten::_softmax        11.69%       2.769ms        11.69%       2.769ms      92.311us            30  
                         aten::masked_fill         0.11%      25.170us        10.64%       2.521ms      84.046us            30  
                            aten::_to_copy         0.32%      76.000us         8.63%       2.045ms      11.359us           180  
                                  aten::to         0.06%      15.176us         7.90%       1.872ms      15.599us           120  
                        aten::masked_fill_         7.27%       1.721ms         7.27%       1.721ms      57.379us            30  
                              aten::matmul         0.16%      38.168us         7.19%       1.704ms      56.785us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 23.690ms

2026-02-11 09:48:15,557 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         2.28%     179.953us       100.00%       7.882ms     262.718us            30  
    extension_cpp::sparse_attn        96.11%       7.575ms        97.08%       7.652ms     255.053us            30  
               aten::new_zeros         0.12%       9.121us         0.75%      59.245us       1.975us            30  
                   aten::zero_         0.08%       6.125us         0.59%      46.580us       0.776us            60  
                   aten::fill_         0.51%      40.455us         0.51%      40.455us       1.348us            30  
                 aten::squeeze         0.39%      30.835us         0.46%      36.372us       0.404us            90  
                   aten::empty         0.18%      14.499us         0.18%      14.499us       0.161us            90  
               aten::unsqueeze         0.14%      11.250us         0.17%      13.626us       0.454us            30  
              aten::as_strided         0.10%       7.913us         0.10%       7.913us       0.066us           120  
               aten::new_empty         0.04%       3.295us         0.08%       6.418us       0.214us            30  
              aten::contiguous         0.03%       2.755us         0.03%       2.755us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.882ms

2026-02-11 09:48:15,559 - INFO - [10/45] Profiling attention with seq_len=512, d_model=64, n_heads=1, sparsity=99%
2026-02-11 09:48:15,652 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.89%     727.613us       100.00%      10.559ms     351.963us            30  
            aten::matmul         0.64%      67.744us        36.14%       3.816ms      63.599us            60  
               aten::bmm        33.86%       3.575ms        34.40%       3.633ms      60.543us            60  
           aten::softmax         0.09%       9.627us        24.96%       2.636ms      87.859us            30  
          aten::_softmax        24.87%       2.626ms        24.87%       2.626ms      87.538us            30  
       aten::masked_fill         0.24%      25.667us        18.38%       1.941ms      64.696us            30  
      aten::masked_fill_        13.11%       1.385ms        13.11%       1.385ms      46.150us            30  
               aten::div         9.30%     982.152us         9.59%       1.013ms      33.758us            30  
             aten::clone         0.13%      13.416us         5.03%     530.722us      17.691us            30  
             aten::copy_         4.85%     512.385us         4.85%     512.385us       8.540us            60  
       aten::bitwise_not         3.58%     378.348us         3.58%     378.348us      12.612us            30  
           aten::reshape         0.23%      24.545us         0.54%      57.502us       0.479us           120  
            aten::select         0.35%      36.490us         0.48%      50.367us       0.280us           180  
            aten::expand         0.36%      38.216us         0.47%      49.717us       0.414us           120  
        aten::as_strided         0.33%      34.421us         0.33%      34.421us       0.096us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 10.559ms

2026-02-11 09:48:15,843 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.49%     885.831us       100.00%      19.749ms     658.286us            30  
                       aten::to_sparse_csr         0.03%       5.326us        44.74%       8.835ms     294.514us            30  
                      aten::_to_sparse_csr         3.04%     600.548us        44.71%       8.830ms     294.337us            30  
                             aten::nonzero        25.66%       5.067ms        25.78%       5.092ms      84.860us            60  
                                  aten::ne         7.28%       1.437ms        14.99%       2.960ms      98.671us            30  
                             aten::softmax         0.05%      10.671us        13.63%       2.692ms      89.747us            30  
                            aten::_softmax        13.58%       2.682ms        13.58%       2.682ms      89.392us            30  
                               aten::copy_        12.76%       2.520ms        13.11%       2.589ms       5.753us           450  
                         aten::masked_fill         0.13%      26.331us        11.66%       2.303ms      76.774us            30  
                            aten::to_dense         0.03%       6.707us         9.26%       1.829ms      60.954us            30  
                           aten::_to_dense         2.04%     403.260us         9.23%       1.822ms      60.731us            30  
                            aten::_to_copy         0.36%      70.134us         8.92%       1.763ms       9.792us           180  
                                  aten::to         0.07%      14.039us         8.59%       1.696ms      14.130us           120  
                              aten::matmul         0.20%      38.661us         8.49%       1.676ms      55.857us            30  
                                 aten::bmm         7.81%       1.543ms         7.95%       1.570ms      52.329us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 19.749ms

2026-02-11 09:48:15,931 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*        10.01%     183.456us       100.00%       1.832ms      61.073us            30  
    extension_cpp::sparse_attn        83.02%       1.521ms        87.28%       1.599ms      53.307us            30  
               aten::new_zeros         0.56%      10.211us         3.37%      61.668us       2.056us            30  
                   aten::zero_         0.35%       6.328us         2.59%      47.414us       0.790us            60  
                   aten::fill_         2.24%      41.086us         2.24%      41.086us       1.370us            30  
                 aten::squeeze         1.67%      30.661us         1.96%      36.000us       0.400us            90  
                   aten::empty         0.77%      14.039us         0.77%      14.039us       0.156us            90  
               aten::unsqueeze         0.61%      11.162us         0.74%      13.539us       0.451us            30  
              aten::as_strided         0.42%       7.716us         0.42%       7.716us       0.064us           120  
               aten::new_empty         0.23%       4.212us         0.39%       7.128us       0.238us            30  
              aten::contiguous         0.12%       2.247us         0.12%       2.247us       0.025us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.832ms

2026-02-11 09:48:15,933 - INFO - [11/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=50%
2026-02-11 09:48:16,040 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         4.73%     799.034us       100.00%      16.906ms     563.521us            30  
       aten::masked_fill         0.15%      24.583us        39.83%       6.734ms     224.453us            30  
      aten::masked_fill_        36.46%       6.164ms        36.46%       6.164ms     205.454us            30  
            aten::matmul         0.36%      61.324us        31.50%       5.326ms      88.760us            60  
               aten::bmm        30.21%       5.108ms        30.51%       5.158ms      85.963us            60  
           aten::softmax         0.05%       9.167us        15.56%       2.630ms      87.674us            30  
          aten::_softmax        15.50%       2.621ms        15.50%       2.621ms      87.369us            30  
               aten::div         5.72%     966.196us         5.89%     995.906us      33.197us            30  
             aten::clone         0.08%      13.960us         3.23%     545.376us      18.179us            30  
             aten::copy_         3.12%     526.914us         3.12%     526.914us       8.782us            60  
       aten::bitwise_not         2.23%     376.786us         2.23%     376.786us      12.560us            30  
           aten::reshape         0.14%      24.340us         0.32%      54.543us       0.455us           120  
            aten::expand         0.20%      34.257us         0.26%      44.430us       0.370us           120  
            aten::select         0.19%      32.679us         0.26%      44.423us       0.247us           180  
        aten::as_strided         0.18%      30.208us         0.18%      30.208us       0.084us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 16.906ms

2026-02-11 09:48:16,307 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.37%       2.969ms       100.00%      67.976ms       2.266ms            30  
                       aten::to_sparse_csr         0.01%       4.831us        30.36%      20.639ms     687.975us            30  
                      aten::_to_sparse_csr         0.75%     507.127us        30.36%      20.634ms     687.814us            30  
                            aten::to_dense         0.01%       6.834us        22.61%      15.367ms     512.225us            30  
                           aten::_to_dense         2.11%       1.433ms        22.60%      15.360ms     511.998us            30  
                             aten::nonzero        21.69%      14.744ms        21.73%      14.773ms     246.213us            60  
                aten::sparse_sampled_addmm        18.27%      12.418ms        20.67%      14.050ms     468.339us            30  
                               aten::copy_        10.78%       7.329ms        12.87%       8.746ms      19.435us           450  
                         aten::masked_fill         0.04%      27.042us         9.71%       6.602ms     220.083us            30  
                                 aten::mul         6.90%       4.690ms         9.25%       6.288ms      26.199us           240  
                        aten::masked_fill_         8.78%       5.971ms         8.78%       5.971ms     199.026us            30  
                            aten::_to_copy         0.17%     114.580us         6.43%       4.371ms      24.281us           180  
                                  aten::ne         2.30%       1.563ms         4.61%       3.130ms     104.346us            30  
                                  aten::to         0.02%      16.838us         4.48%       3.047ms      25.393us           120  
                          aten::index_add_         3.95%       2.684ms         3.95%       2.684ms      89.481us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 67.976ms

2026-02-11 09:48:16,660 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.18%     307.670us       100.00%     167.251ms       5.575ms            30  
    extension_cpp::sparse_attn        99.51%     166.437ms        99.78%     166.882ms       5.563ms            30  
               aten::new_zeros         0.01%      15.543us         0.25%     423.585us      14.120us            30  
                   aten::zero_         0.01%      12.582us         0.24%     403.962us       6.733us            60  
                   aten::fill_         0.23%     391.380us         0.23%     391.380us      13.046us            30  
                 aten::squeeze         0.02%      35.372us         0.02%      41.415us       0.460us            90  
               aten::unsqueeze         0.01%      16.708us         0.01%      19.791us       0.660us            30  
                   aten::empty         0.01%      18.296us         0.01%      18.296us       0.203us            90  
              aten::as_strided         0.01%       9.126us         0.01%       9.126us       0.076us           120  
               aten::new_empty         0.00%       4.373us         0.00%       8.081us       0.269us            30  
              aten::contiguous         0.00%       2.967us         0.00%       2.967us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 167.251ms

2026-02-11 09:48:16,663 - INFO - [12/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=70%
2026-02-11 09:48:16,767 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.84%     862.201us       100.00%      14.770ms     492.320us            30  
            aten::matmul         0.44%      64.927us        33.69%       4.975ms      82.923us            60  
               aten::bmm        32.16%       4.751ms        32.52%       4.803ms      80.042us            60  
       aten::masked_fill         0.18%      27.034us        31.85%       4.704ms     156.799us            30  
      aten::masked_fill_        28.04%       4.141ms        28.04%       4.141ms     138.031us            30  
           aten::softmax         0.07%       9.874us        18.98%       2.803ms      93.445us            30  
          aten::_softmax        18.91%       2.793ms        18.91%       2.793ms      93.116us            30  
               aten::div         6.62%     977.274us         6.82%       1.007ms      33.576us            30  
             aten::clone         0.10%      14.380us         3.63%     536.016us      17.867us            30  
             aten::copy_         3.50%     516.261us         3.50%     516.261us       8.604us            60  
       aten::bitwise_not         2.50%     368.965us         2.50%     368.965us      12.299us            30  
           aten::reshape         0.15%      22.413us         0.36%      53.868us       0.449us           120  
            aten::expand         0.25%      36.253us         0.31%      46.083us       0.384us           120  
            aten::select         0.23%      33.996us         0.31%      45.833us       0.255us           180  
                aten::to         0.03%       4.667us         0.20%      30.001us       1.000us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 14.770ms

2026-02-11 09:48:17,014 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.24%       2.266ms       100.00%      53.396ms       1.780ms            30  
                       aten::to_sparse_csr         0.01%       4.621us        33.40%      17.832ms     594.401us            30  
                      aten::_to_sparse_csr         1.16%     621.087us        33.39%      17.827ms     594.247us            30  
                             aten::nonzero        23.08%      12.325ms        23.13%      12.353ms     205.881us            60  
                            aten::to_dense         0.01%       6.418us        20.71%      11.057ms     368.573us            30  
                           aten::_to_dense         2.27%       1.210ms        20.70%      11.051ms     368.359us            30  
                aten::sparse_sampled_addmm        14.88%       7.945ms        17.02%       9.090ms     303.013us            30  
                               aten::copy_        11.59%       6.186ms        13.31%       7.109ms      15.799us           450  
                         aten::masked_fill         0.05%      26.333us        10.14%       5.412ms     180.390us            30  
                        aten::masked_fill_         8.44%       4.505ms         8.44%       4.505ms     150.162us            30  
                                 aten::mul         6.19%       3.305ms         8.26%       4.410ms      18.375us           240  
                            aten::_to_copy         0.21%     111.949us         6.91%       3.692ms      20.511us           180  
                                  aten::ne         2.84%       1.517ms         5.95%       3.175ms     105.834us            30  
                             aten::softmax         0.02%      10.878us         5.29%       2.822ms      94.075us            30  
                            aten::_softmax         5.27%       2.811ms         5.27%       2.811ms      93.712us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 53.396ms

2026-02-11 09:48:17,257 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.24%     237.835us       100.00%     100.482ms       3.349ms            30  
    extension_cpp::sparse_attn        99.26%      99.738ms        99.71%     100.186ms       3.340ms            30  
               aten::new_zeros         0.01%      14.709us         0.43%     428.171us      14.272us            30  
                   aten::zero_         0.01%      12.663us         0.41%     410.295us       6.838us            60  
                   aten::fill_         0.40%     397.632us         0.40%     397.632us      13.254us            30  
                 aten::squeeze         0.03%      34.166us         0.04%      40.040us       0.445us            90  
               aten::unsqueeze         0.01%      14.999us         0.02%      18.000us       0.600us            30  
                   aten::empty         0.02%      16.829us         0.02%      16.829us       0.187us            90  
              aten::as_strided         0.01%       8.875us         0.01%       8.875us       0.074us           120  
               aten::new_empty         0.00%       3.585us         0.01%       7.377us       0.246us            30  
              aten::contiguous         0.00%       2.420us         0.00%       2.420us       0.027us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 100.482ms

2026-02-11 09:48:17,260 - INFO - [13/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=90%
2026-02-11 09:48:17,358 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.16%     871.464us       100.00%      12.164ms     405.474us            30  
            aten::matmul         0.53%      64.869us        36.51%       4.441ms      74.020us            60  
               aten::bmm        34.60%       4.209ms        35.06%       4.265ms      71.088us            60  
       aten::masked_fill         0.23%      27.502us        23.34%       2.839ms      94.623us            30  
           aten::softmax         0.09%      10.418us        22.15%       2.694ms      89.793us            30  
          aten::_softmax        22.06%       2.683ms        22.06%       2.683ms      89.446us            30  
      aten::masked_fill_        18.27%       2.222ms        18.27%       2.222ms      74.063us            30  
               aten::div         7.05%     857.291us         7.30%     887.586us      29.586us            30  
             aten::clone         0.12%      14.376us         4.84%     589.297us      19.643us            30  
             aten::copy_         4.68%     569.213us         4.68%     569.213us       9.487us            60  
       aten::bitwise_not         3.18%     386.708us         3.18%     386.708us      12.890us            30  
           aten::reshape         0.20%      24.799us         0.47%      56.961us       0.475us           120  
            aten::select         0.30%      36.982us         0.41%      50.364us       0.280us           180  
            aten::expand         0.30%      35.922us         0.38%      46.293us       0.386us           120  
        aten::as_strided         0.26%      31.879us         0.26%      31.879us       0.089us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.164ms

2026-02-11 09:48:17,561 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.18%       1.226ms       100.00%      29.335ms     977.837us            30  
                       aten::to_sparse_csr         0.02%       4.959us        38.82%      11.388ms     379.610us            30  
                      aten::_to_sparse_csr         1.83%     537.672us        38.80%      11.383ms     379.444us            30  
                             aten::nonzero        23.99%       7.038ms        24.08%       7.064ms     117.733us            60  
                            aten::to_dense         0.02%       6.416us        15.68%       4.599ms     153.294us            30  
                           aten::_to_dense         1.79%     524.684us        15.65%       4.592ms     153.080us            30  
                               aten::copy_        11.08%       3.250ms        11.75%       3.447ms       7.660us           450  
                aten::sparse_sampled_addmm         9.97%       2.926ms        11.13%       3.266ms     108.869us            30  
                                  aten::ne         5.13%       1.506ms        10.46%       3.067ms     102.234us            30  
                         aten::masked_fill         0.09%      26.497us         9.99%       2.931ms      97.708us            30  
                             aten::softmax         0.04%      10.458us         9.47%       2.778ms      92.608us            30  
                            aten::_softmax         9.43%       2.768ms         9.43%       2.768ms      92.259us            30  
                            aten::_to_copy         0.24%      71.807us         7.86%       2.307ms      12.816us           180  
                        aten::masked_fill_         7.45%       2.186ms         7.45%       2.186ms      72.873us            30  
                                  aten::to         0.05%      14.615us         6.78%       1.988ms      16.567us           120  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 29.335ms

2026-02-11 09:48:17,694 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.66%     224.620us       100.00%      34.250ms       1.142ms            30  
    extension_cpp::sparse_attn        97.97%      33.555ms        99.18%      33.969ms       1.132ms            30  
               aten::new_zeros         0.04%      13.369us         1.15%     395.000us      13.167us            30  
                   aten::zero_         0.03%      11.751us         1.10%     377.667us       6.294us            60  
                   aten::fill_         1.07%     365.916us         1.07%     365.916us      12.197us            30  
                 aten::squeeze         0.10%      33.086us         0.11%      39.129us       0.435us            90  
                   aten::empty         0.05%      17.378us         0.05%      17.378us       0.193us            90  
               aten::unsqueeze         0.04%      14.707us         0.05%      17.374us       0.579us            30  
              aten::as_strided         0.03%       8.710us         0.03%       8.710us       0.073us           120  
               aten::new_empty         0.01%       3.509us         0.02%       7.839us       0.261us            30  
              aten::contiguous         0.01%       2.583us         0.01%       2.583us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 34.250ms

2026-02-11 09:48:17,696 - INFO - [14/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=95%
2026-02-11 09:48:17,822 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        31.57%       6.112ms       100.00%      19.360ms     645.343us            30  
            aten::matmul         0.34%      65.790us        32.05%       6.204ms     103.406us            60  
               aten::bmm        30.80%       5.964ms        31.12%       6.026ms     100.427us            60  
           aten::softmax         0.05%       9.164us        16.30%       3.156ms     105.211us            30  
          aten::_softmax        16.26%       3.147ms        16.26%       3.147ms     104.906us            30  
       aten::masked_fill         0.13%      25.794us        13.38%       2.591ms      86.357us            30  
      aten::masked_fill_        10.08%       1.952ms        10.08%       1.952ms      65.072us            30  
               aten::div         4.32%     837.223us         4.48%     867.309us      28.910us            30  
             aten::clone         0.07%      13.128us         3.17%     612.763us      20.425us            30  
             aten::copy_         3.07%     594.303us         3.07%     594.303us       9.905us            60  
       aten::bitwise_not         1.99%     384.546us         1.99%     384.546us      12.818us            30  
           aten::reshape         0.12%      23.869us         0.30%      57.751us       0.481us           120  
            aten::select         0.22%      42.868us         0.29%      55.913us       0.311us           180  
            aten::expand         0.19%      36.835us         0.25%      47.461us       0.396us           120  
        aten::as_strided         0.17%      32.169us         0.17%      32.169us       0.089us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 19.360ms

2026-02-11 09:48:18,024 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.62%       1.208ms       100.00%      26.132ms     871.069us            30  
                       aten::to_sparse_csr         0.02%       4.785us        41.95%      10.961ms     365.383us            30  
                      aten::_to_sparse_csr         2.64%     689.725us        41.93%      10.957ms     365.223us            30  
                             aten::nonzero        25.49%       6.661ms        25.59%       6.687ms     111.452us            60  
                            aten::to_dense         0.02%       6.000us        12.32%       3.221ms     107.354us            30  
                           aten::_to_dense         1.20%     313.098us        12.30%       3.215ms     107.154us            30  
                                  aten::ne         5.80%       1.517ms        12.13%       3.169ms     105.628us            30  
                               aten::copy_        11.40%       2.979ms        11.91%       3.113ms       6.918us           450  
                             aten::softmax         0.04%      10.963us        11.16%       2.918ms      97.253us            30  
                            aten::_softmax        11.12%       2.907ms        11.12%       2.907ms      96.888us            30  
                         aten::masked_fill         0.11%      27.707us        10.41%       2.721ms      90.713us            30  
                aten::sparse_sampled_addmm         7.23%       1.888ms         8.33%       2.177ms      72.556us            30  
                            aten::_to_copy         0.30%      78.277us         8.02%       2.097ms      11.650us           180  
                              aten::matmul         0.15%      40.327us         7.73%       2.020ms      67.321us            30  
                                  aten::to         0.06%      14.502us         7.40%       1.933ms      16.105us           120  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 26.132ms

2026-02-11 09:48:18,128 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.29%     222.246us       100.00%      17.295ms     576.494us            30  
    extension_cpp::sparse_attn        96.27%      16.650ms        98.39%      17.017ms     567.222us            30  
               aten::new_zeros         0.08%      14.461us         2.01%     346.997us      11.567us            30  
                   aten::zero_         0.07%      11.669us         1.91%     329.704us       5.495us            60  
                   aten::fill_         1.84%     318.035us         1.84%     318.035us      10.601us            30  
                 aten::squeeze         0.19%      33.251us         0.23%      39.006us       0.433us            90  
               aten::unsqueeze         0.08%      14.163us         0.10%      16.915us       0.564us            30  
                   aten::empty         0.09%      16.333us         0.09%      16.333us       0.181us            90  
              aten::as_strided         0.05%       8.507us         0.05%       8.507us       0.071us           120  
               aten::new_empty         0.02%       3.579us         0.04%       6.706us       0.224us            30  
              aten::contiguous         0.01%       2.504us         0.01%       2.504us       0.028us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 17.295ms

2026-02-11 09:48:18,131 - INFO - [15/45] Profiling attention with seq_len=512, d_model=128, n_heads=1, sparsity=99%
2026-02-11 09:48:18,230 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.19%     873.499us       100.00%      12.153ms     405.092us            30  
            aten::matmul         0.54%      66.126us        42.74%       5.194ms      86.573us            60  
               aten::bmm        40.82%       4.961ms        41.27%       5.015ms      83.586us            60  
           aten::softmax         0.09%      10.704us        22.28%       2.708ms      90.251us            30  
          aten::_softmax        22.19%       2.697ms        22.19%       2.697ms      89.894us            30  
       aten::masked_fill         0.22%      26.707us        16.15%       1.962ms      65.413us            30  
      aten::masked_fill_        11.30%       1.373ms        11.30%       1.373ms      45.778us            30  
               aten::div         7.82%     950.037us         8.08%     981.869us      32.729us            30  
             aten::clone         0.12%      14.201us         4.63%     562.365us      18.745us            30  
             aten::copy_         4.47%     543.449us         4.47%     543.449us       9.057us            60  
       aten::bitwise_not         3.19%     388.247us         3.19%     388.247us      12.942us            30  
           aten::reshape         0.20%      24.420us         0.48%      58.291us       0.486us           120  
            aten::select         0.28%      34.414us         0.39%      47.872us       0.266us           180  
            aten::expand         0.30%      35.960us         0.38%      46.627us       0.389us           120  
        aten::as_strided         0.27%      32.627us         0.27%      32.627us       0.091us           360  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 12.153ms

2026-02-11 09:48:18,419 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.30%     880.044us       100.00%      20.482ms     682.733us            30  
                       aten::to_sparse_csr         0.02%       4.870us        43.56%       8.921ms     297.373us            30  
                      aten::_to_sparse_csr         2.63%     538.256us        43.53%       8.916ms     297.211us            30  
                             aten::nonzero        25.24%       5.170ms        25.36%       5.195ms      86.582us            60  
                                  aten::ne         7.12%       1.458ms        14.60%       2.991ms      99.700us            30  
                             aten::softmax         0.05%      10.418us        12.94%       2.651ms      88.363us            30  
                            aten::_softmax        12.89%       2.640ms        12.89%       2.640ms      88.015us            30  
                               aten::copy_        11.93%       2.443ms        12.26%       2.512ms       5.582us           450  
                         aten::masked_fill         0.12%      25.375us        10.77%       2.207ms      73.554us            30  
                              aten::matmul         0.18%      37.634us        10.27%       2.104ms      70.146us            30  
                                 aten::bmm         9.61%       1.968ms         9.75%       1.996ms      66.536us            30  
                            aten::to_dense         0.03%       6.379us         9.72%       1.992ms      66.388us            30  
                           aten::_to_dense         2.75%     562.788us         9.69%       1.985ms      66.175us            30  
                            aten::_to_copy         0.36%      74.331us         8.77%       1.795ms       9.974us           180  
                                  aten::to         0.07%      14.673us         8.40%       1.721ms      14.342us           120  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 20.482ms

2026-02-11 09:48:18,503 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         5.81%     248.101us       100.00%       4.267ms     142.234us            30  
    extension_cpp::sparse_attn        83.65%       3.569ms        92.74%       3.957ms     131.909us            30  
               aten::new_zeros         0.33%      13.964us         8.63%     368.269us      12.276us            30  
                   aten::zero_         0.26%      11.207us         8.22%     350.893us       5.848us            60  
                   aten::fill_         7.96%     339.686us         7.96%     339.686us      11.323us            30  
                 aten::squeeze         0.78%      33.086us         0.91%      38.789us       0.431us            90  
               aten::unsqueeze         0.45%      19.292us         0.54%      22.875us       0.763us            30  
                   aten::empty         0.39%      16.792us         0.39%      16.792us       0.187us            90  
              aten::as_strided         0.22%       9.286us         0.22%       9.286us       0.077us           120  
               aten::new_empty         0.08%       3.246us         0.16%       6.789us       0.226us            30  
              aten::contiguous         0.07%       2.876us         0.07%       2.876us       0.032us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.267ms

2026-02-11 09:48:18,506 - INFO - [16/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=50%
2026-02-11 09:48:18,688 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.66%       3.787ms       100.00%      56.832ms       1.894ms            30  
       aten::masked_fill         0.05%      29.870us        46.79%      26.593ms     886.422us            30  
      aten::masked_fill_        41.22%      23.429ms        41.22%      23.429ms     780.955us            30  
            aten::matmul         0.12%      65.748us        20.94%      11.902ms     198.360us            60  
               aten::bmm        20.54%      11.672ms        20.62%      11.721ms     195.349us            60  
           aten::softmax         0.02%       9.965us        17.69%      10.055ms     335.162us            30  
          aten::_softmax        17.67%      10.045ms        17.67%      10.045ms     334.830us            30  
               aten::div         5.94%       3.374ms         5.99%       3.407ms     113.567us            30  
             aten::clone         0.03%      14.254us         5.51%       3.134ms     104.471us            30  
             aten::copy_         5.48%       3.115ms         5.48%       3.115ms      51.912us            60  
       aten::bitwise_not         1.83%       1.041ms         1.83%       1.041ms      34.690us            30  
           aten::reshape         0.04%      24.046us         0.10%      59.624us       0.497us           120  
            aten::expand         0.06%      36.669us         0.08%      47.001us       0.392us           120  
            aten::select         0.05%      30.880us         0.08%      43.042us       0.239us           180  
                aten::to         0.01%       4.872us         0.06%      33.333us       1.111us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 56.832ms

2026-02-11 09:48:19,280 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         8.48%      21.372ms       100.00%     252.165ms       8.405ms            30  
                       aten::to_sparse_csr         0.01%      16.663us        32.07%      80.866ms       2.696ms            30  
                      aten::_to_sparse_csr         0.89%       2.251ms        32.06%      80.849ms       2.695ms            30  
                            aten::to_dense         0.01%      17.537us        29.53%      74.459ms       2.482ms            30  
                           aten::_to_dense         5.44%      13.717ms        29.52%      74.442ms       2.481ms            30  
                             aten::nonzero        23.14%      58.355ms        23.17%      58.423ms     973.719us            60  
                               aten::copy_        14.38%      36.268ms        16.77%      42.279ms      93.954us           450  
                         aten::masked_fill         0.02%      59.828us        10.74%      27.087ms     902.902us            30  
                                 aten::mul         7.78%      19.606ms        10.33%      26.061ms     108.588us           240  
                        aten::masked_fill_         9.25%      23.334ms         9.25%      23.334ms     777.785us            30  
                            aten::_to_copy         0.07%     184.737us         8.84%      22.290ms     123.831us           180  
                aten::sparse_sampled_addmm         4.54%      11.444ms         7.04%      17.755ms     591.838us            30  
                                  aten::to         0.01%      34.836us         6.02%      15.181ms     126.512us           120  
                                  aten::ne         1.79%       4.508ms         4.89%      12.328ms     410.923us            30  
    aten::_convert_indices_from_csr_to_coo         2.90%       7.318ms         4.61%      11.635ms     387.817us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 252.165ms

2026-02-11 09:48:19,677 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.44%     842.508us       100.00%     193.478ms       6.449ms            30  
    extension_cpp::sparse_attn        99.49%     192.494ms        99.53%     192.578ms       6.419ms            30  
               aten::new_zeros         0.01%       9.705us         0.03%      63.793us       2.126us            30  
                   aten::zero_         0.00%       8.504us         0.03%      49.879us       0.831us            60  
                   aten::fill_         0.02%      41.375us         0.02%      41.375us       1.379us            30  
                 aten::squeeze         0.02%      35.334us         0.02%      41.204us       0.458us            90  
                   aten::empty         0.01%      17.211us         0.01%      17.211us       0.191us            90  
               aten::unsqueeze         0.01%      14.123us         0.01%      17.082us       0.569us            30  
              aten::as_strided         0.00%       8.829us         0.00%       8.829us       0.074us           120  
               aten::new_empty         0.00%       4.504us         0.00%       8.670us       0.289us            30  
              aten::contiguous         0.00%       2.625us         0.00%       2.625us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 193.478ms

2026-02-11 09:48:19,679 - INFO - [17/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=70%
2026-02-11 09:48:19,862 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        14.90%       8.580ms       100.00%      57.566ms       1.919ms            30  
       aten::masked_fill         0.06%      35.083us        32.69%      18.820ms     627.349us            30  
      aten::masked_fill_        26.72%      15.381ms        26.72%      15.381ms     512.685us            30  
            aten::matmul         0.14%      78.828us        25.45%      14.650ms     244.173us            60  
               aten::bmm        24.97%      14.372ms        25.06%      14.427ms     240.453us            60  
           aten::softmax         0.02%      12.083us        18.64%      10.733ms     357.752us            30  
          aten::_softmax        18.62%      10.720ms        18.62%      10.720ms     357.350us            30  
               aten::div         6.15%       3.541ms         6.23%       3.585ms     119.511us            30  
             aten::clone         0.03%      14.668us         5.91%       3.405ms     113.494us            30  
             aten::copy_         5.88%       3.387ms         5.88%       3.387ms      56.444us            60  
       aten::bitwise_not         1.98%       1.142ms         1.98%       1.142ms      38.080us            30  
           aten::reshape         0.05%      30.959us         0.13%      77.046us       0.642us           120  
            aten::expand         0.07%      41.793us         0.10%      59.004us       0.492us           120  
            aten::select         0.06%      36.378us         0.09%      49.709us       0.276us           180  
                aten::to         0.01%       5.917us         0.08%      44.708us       1.490us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 57.566ms

2026-02-11 09:48:20,338 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         9.64%      18.171ms       100.00%     188.508ms       6.284ms            30  
                       aten::to_sparse_csr         0.01%      10.795us        34.55%      65.129ms       2.171ms            30  
                      aten::_to_sparse_csr         2.04%       3.846ms        34.54%      65.118ms       2.171ms            30  
                            aten::to_dense         0.01%      14.500us        25.90%      48.821ms       1.627ms            30  
                           aten::_to_dense         6.22%      11.730ms        25.89%      48.807ms       1.627ms            30  
                             aten::nonzero        23.53%      44.359ms        23.56%      44.407ms     740.121us            60  
                               aten::copy_        14.01%      26.409ms        15.94%      30.053ms      66.784us           450  
                         aten::masked_fill         0.03%      49.125us        10.29%      19.405ms     646.847us            30  
                            aten::_to_copy         0.08%     149.878us         8.77%      16.538ms      91.878us           180  
                                 aten::mul         6.20%      11.681ms         8.32%      15.678ms      65.324us           240  
                        aten::masked_fill_         8.22%      15.499ms         8.22%      15.499ms     516.645us            30  
                                  aten::to         0.01%      24.825us         6.48%      12.211ms     101.761us           120  
                                  aten::ne         2.24%       4.231ms         6.32%      11.909ms     396.983us            30  
                aten::sparse_sampled_addmm         3.74%       7.044ms         5.81%      10.952ms     365.076us            30  
                             aten::softmax         0.01%      17.583us         5.43%      10.227ms     340.909us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 188.508ms

2026-02-11 09:48:20,610 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.55%     647.499us       100.00%     118.740ms       3.958ms            30  
    extension_cpp::sparse_attn        99.33%     117.946ms        99.41%     118.037ms       3.935ms            30  
               aten::new_zeros         0.01%      10.626us         0.06%      72.502us       2.417us            30  
                   aten::zero_         0.01%       7.670us         0.05%      56.541us       0.942us            60  
                   aten::fill_         0.04%      48.871us         0.04%      48.871us       1.629us            30  
                 aten::squeeze         0.03%      33.913us         0.03%      39.791us       0.442us            90  
                   aten::empty         0.01%      16.033us         0.01%      16.033us       0.178us            90  
               aten::unsqueeze         0.01%      13.171us         0.01%      15.752us       0.525us            30  
               aten::new_empty         0.00%       5.251us         0.01%       9.334us       0.311us            30  
              aten::as_strided         0.01%       8.459us         0.01%       8.459us       0.070us           120  
              aten::contiguous         0.00%       2.835us         0.00%       2.835us       0.032us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 118.740ms

2026-02-11 09:48:20,612 - INFO - [18/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=90%
2026-02-11 09:48:20,776 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        17.65%       8.663ms       100.00%      49.078ms       1.636ms            30  
            aten::matmul         0.16%      76.158us        29.14%      14.303ms     238.376us            60  
               aten::bmm        28.61%      14.042ms        28.73%      14.099ms     234.980us            60  
       aten::masked_fill         0.07%      32.503us        22.45%      11.016ms     367.189us            30  
           aten::softmax         0.02%      11.335us        20.71%      10.163ms     338.767us            30  
          aten::_softmax        20.68%      10.152ms        20.68%      10.152ms     338.389us            30  
      aten::masked_fill_        15.07%       7.395ms        15.07%       7.395ms     246.503us            30  
               aten::div         7.40%       3.631ms         7.48%       3.670ms     122.322us            30  
             aten::clone         0.03%      14.491us         7.31%       3.588ms     119.603us            30  
             aten::copy_         7.27%       3.569ms         7.27%       3.569ms      59.489us            60  
       aten::bitwise_not         2.47%       1.214ms         2.47%       1.214ms      40.468us            30  
           aten::reshape         0.05%      25.877us         0.14%      68.880us       0.574us           120  
            aten::select         0.08%      37.674us         0.10%      51.006us       0.283us           180  
            aten::expand         0.08%      40.999us         0.10%      50.960us       0.425us           120  
                aten::to         0.01%       5.332us         0.08%      38.209us       1.274us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 49.078ms

2026-02-11 09:48:21,137 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        14.44%      17.529ms       100.00%     121.406ms       4.047ms            30  
                       aten::to_sparse_csr         0.01%      10.792us        35.31%      42.864ms       1.429ms            30  
                      aten::_to_sparse_csr         2.08%       2.519ms        35.30%      42.854ms       1.428ms            30  
                             aten::nonzero        21.48%      26.083ms        21.52%      26.130ms     435.502us            60  
                            aten::to_dense         0.01%      12.837us        19.52%      23.693ms     789.752us            30  
                           aten::_to_dense         6.00%       7.281ms        19.50%      23.680ms     789.324us            30  
                               aten::copy_        13.95%      16.940ms        15.15%      18.398ms      40.884us           450  
                                  aten::ne         3.71%       4.500ms        10.04%      12.185ms     406.161us            30  
                         aten::masked_fill         0.04%      45.584us         9.39%      11.396ms     379.859us            30  
                            aten::_to_copy         0.13%     157.835us         8.87%      10.771ms      59.841us           180  
                             aten::softmax         0.02%      20.630us         8.62%      10.460ms     348.663us            30  
                            aten::_softmax         8.60%      10.439ms         8.60%      10.439ms     347.976us            30  
                                  aten::to         0.02%      22.871us         7.68%       9.327ms      77.728us           120  
                        aten::masked_fill_         6.23%       7.568ms         6.23%       7.568ms     252.256us            30  
                                 aten::mul         3.73%       4.531ms         5.10%       6.189ms      25.786us           240  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 121.406ms

2026-02-11 09:48:21,276 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.50%     192.917us       100.00%      38.803ms       1.293ms            30  
    extension_cpp::sparse_attn        99.16%      38.477ms        99.36%      38.555ms       1.285ms            30  
               aten::new_zeros         0.02%       9.666us         0.15%      60.085us       2.003us            30  
                   aten::zero_         0.02%       7.416us         0.12%      47.001us       0.783us            60  
                   aten::fill_         0.10%      39.585us         0.10%      39.585us       1.319us            30  
                 aten::squeeze         0.09%      33.221us         0.10%      39.003us       0.433us            90  
               aten::unsqueeze         0.03%      13.459us         0.04%      15.877us       0.529us            30  
                   aten::empty         0.04%      14.710us         0.04%      14.710us       0.163us            90  
              aten::as_strided         0.02%       8.200us         0.02%       8.200us       0.068us           120  
               aten::new_empty         0.01%       4.249us         0.02%       7.708us       0.257us            30  
              aten::contiguous         0.01%       2.543us         0.01%       2.543us       0.028us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 38.803ms

2026-02-11 09:48:21,279 - INFO - [19/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=95%
2026-02-11 09:48:21,436 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        17.85%       8.157ms       100.00%      45.693ms       1.523ms            30  
            aten::matmul         0.15%      68.611us        30.36%      13.871ms     231.179us            60  
               aten::bmm        29.81%      13.620ms        29.92%      13.671ms     227.848us            60  
           aten::softmax         0.02%      10.622us        21.94%      10.023ms     334.110us            30  
          aten::_softmax        21.91%      10.013ms        21.91%      10.013ms     333.755us            30  
       aten::masked_fill         0.07%      30.459us        19.43%       8.879ms     295.975us            30  
      aten::masked_fill_        11.81%       5.399ms        11.81%       5.399ms     179.953us            30  
               aten::div         7.72%       3.527ms         7.80%       3.563ms     118.772us            30  
             aten::clone         0.03%      14.291us         7.55%       3.450ms     115.007us            30  
             aten::copy_         7.51%       3.431ms         7.51%       3.431ms      57.185us            60  
       aten::bitwise_not         2.52%       1.151ms         2.52%       1.151ms      38.362us            30  
           aten::reshape         0.06%      28.590us         0.16%      73.507us       0.613us           120  
            aten::expand         0.09%      40.202us         0.11%      49.927us       0.416us           120  
            aten::select         0.07%      31.993us         0.10%      45.497us       0.253us           180  
                aten::to         0.01%       4.541us         0.08%      36.042us       1.201us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 45.693ms

2026-02-11 09:48:21,743 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        12.09%      11.001ms       100.00%      91.016ms       3.034ms            30  
                       aten::to_sparse_csr         0.01%       5.543us        38.74%      35.263ms       1.175ms            30  
                      aten::_to_sparse_csr         2.77%       2.520ms        38.74%      35.258ms       1.175ms            30  
                             aten::nonzero        21.63%      19.686ms        21.66%      19.716ms     328.606us            60  
                               aten::copy_        15.97%      14.531ms        16.88%      15.366ms      34.146us           450  
                            aten::to_dense         0.01%       8.416us        16.20%      14.742ms     491.384us            30  
                           aten::_to_dense         3.24%       2.953ms        16.19%      14.733ms     491.103us            30  
                                  aten::ne         4.52%       4.114ms        12.81%      11.657ms     388.560us            30  
                             aten::softmax         0.02%      13.914us        11.07%      10.072ms     335.733us            30  
                            aten::_softmax        11.05%      10.058ms        11.05%      10.058ms     335.269us            30  
                            aten::_to_copy         0.13%     114.673us        10.45%       9.507ms      52.817us           180  
                         aten::masked_fill         0.04%      31.876us         9.78%       8.905ms     296.823us            30  
                                  aten::to         0.02%      16.994us         9.45%       8.602ms      71.681us           120  
                        aten::masked_fill_         5.92%       5.384ms         5.92%       5.384ms     179.478us            30  
                              aten::matmul         0.06%      52.002us         5.38%       4.895ms     163.155us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 91.016ms

2026-02-11 09:48:21,850 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.01%     196.918us       100.00%      19.534ms     651.144us            30  
    extension_cpp::sparse_attn        98.29%      19.201ms        98.72%      19.283ms     642.781us            30  
               aten::new_zeros         0.05%       9.375us         0.32%      63.333us       2.111us            30  
                   aten::zero_         0.04%       8.126us         0.26%      51.083us       0.851us            60  
                   aten::fill_         0.22%      42.957us         0.22%      42.957us       1.432us            30  
                 aten::squeeze         0.17%      32.996us         0.20%      39.205us       0.436us            90  
                   aten::empty         0.08%      15.540us         0.08%      15.540us       0.173us            90  
               aten::unsqueeze         0.06%      12.542us         0.08%      14.793us       0.493us            30  
              aten::as_strided         0.04%       8.460us         0.04%       8.460us       0.071us           120  
               aten::new_empty         0.02%       4.001us         0.04%       7.373us       0.246us            30  
              aten::contiguous         0.01%       2.585us         0.01%       2.585us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 19.534ms

2026-02-11 09:48:21,853 - INFO - [20/45] Profiling attention with seq_len=1024, d_model=32, n_heads=1, sparsity=99%
2026-02-11 09:48:22,017 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        20.49%       9.430ms       100.00%      46.021ms       1.534ms            30  
            aten::matmul         0.16%      75.677us        29.72%      13.677ms     227.956us            60  
               aten::bmm        29.14%      13.411ms        29.26%      13.464ms     224.408us            60  
           aten::softmax         0.02%      10.954us        22.46%      10.335ms     344.492us            30  
          aten::_softmax        22.43%      10.324ms        22.43%      10.324ms     344.127us            30  
       aten::masked_fill         0.07%      34.244us        16.71%       7.690ms     256.319us            30  
      aten::masked_fill_         8.91%       4.101ms         8.91%       4.101ms     136.692us            30  
               aten::div         7.85%       3.613ms         7.95%       3.657ms     121.884us            30  
             aten::clone         0.03%      15.794us         7.72%       3.555ms     118.485us            30  
             aten::copy_         7.68%       3.534ms         7.68%       3.534ms      58.904us            60  
       aten::bitwise_not         2.56%       1.178ms         2.56%       1.178ms      39.278us            30  
           aten::reshape         0.06%      29.160us         0.17%      77.994us       0.650us           120  
            aten::expand         0.09%      40.165us         0.11%      50.917us       0.424us           120  
            aten::select         0.08%      35.006us         0.10%      48.167us       0.268us           180  
                aten::to         0.01%       5.420us         0.09%      43.292us       1.443us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 46.021ms

2026-02-11 09:48:22,298 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        10.59%       7.914ms       100.00%      74.740ms       2.491ms            30  
                       aten::to_sparse_csr         0.01%       5.999us        44.75%      33.444ms       1.115ms            30  
                      aten::_to_sparse_csr         6.14%       4.586ms        44.74%      33.438ms       1.115ms            30  
                             aten::nonzero        22.15%      16.557ms        22.20%      16.589ms     276.480us            60  
                               aten::copy_        15.56%      11.633ms        15.72%      11.750ms      26.111us           450  
                                  aten::ne         5.75%       4.301ms        15.69%      11.724ms     390.790us            30  
                             aten::softmax         0.02%      14.001us        13.83%      10.339ms     344.623us            30  
                            aten::_softmax        13.81%      10.325ms        13.81%      10.325ms     344.157us            30  
                            aten::_to_copy         0.11%      85.338us        10.54%       7.879ms      43.772us           180  
                         aten::masked_fill         0.04%      31.955us        10.54%       7.875ms     262.484us            30  
                                  aten::to         0.02%      16.170us        10.32%       7.712ms      64.270us           120  
                            aten::to_dense         0.01%       8.793us         9.22%       6.894ms     229.803us            30  
                           aten::_to_dense         2.22%       1.658ms         9.21%       6.885ms     229.510us            30  
                              aten::matmul         0.07%      52.624us         7.36%       5.499ms     183.284us            30  
                                 aten::bmm         7.11%       5.316ms         7.15%       5.344ms     178.137us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 74.740ms

2026-02-11 09:48:22,382 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         4.59%     186.794us       100.00%       4.069ms     135.626us            30  
    extension_cpp::sparse_attn        92.24%       3.753ms        94.17%       3.832ms     127.717us            30  
               aten::new_zeros         0.24%       9.628us         1.49%      60.627us       2.021us            30  
                   aten::zero_         0.17%       6.788us         1.18%      47.833us       0.797us            60  
                   aten::fill_         1.01%      41.045us         1.01%      41.045us       1.368us            30  
                 aten::squeeze         0.76%      30.923us         0.90%      36.459us       0.405us            90  
                   aten::empty         0.36%      14.550us         0.36%      14.550us       0.162us            90  
               aten::unsqueeze         0.29%      11.961us         0.34%      14.001us       0.467us            30  
              aten::as_strided         0.19%       7.576us         0.19%       7.576us       0.063us           120  
               aten::new_empty         0.09%       3.625us         0.17%       6.834us       0.228us            30  
              aten::contiguous         0.07%       2.748us         0.07%       2.748us       0.031us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.069ms

2026-02-11 09:48:22,384 - INFO - [21/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=50%
2026-02-11 09:48:22,583 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        11.84%       7.941ms       100.00%      67.042ms       2.235ms            30  
       aten::masked_fill         0.05%      33.500us        40.06%      26.854ms     895.123us            30  
      aten::masked_fill_        34.65%      23.233ms        34.65%      23.233ms     774.443us            30  
            aten::matmul         0.11%      72.004us        25.31%      16.971ms     282.848us            60  
               aten::bmm        24.93%      16.716ms        25.01%      16.768ms     279.468us            60  
           aten::softmax         0.02%      11.003us        15.43%      10.344ms     344.813us            30  
          aten::_softmax        15.41%      10.333ms        15.41%      10.333ms     344.446us            30  
               aten::div         5.54%       3.716ms         5.61%       3.758ms     125.263us            30  
             aten::clone         0.02%      15.709us         5.35%       3.587ms     119.564us            30  
             aten::copy_         5.32%       3.568ms         5.32%       3.568ms      59.462us            60  
       aten::bitwise_not         1.68%       1.123ms         1.68%       1.123ms      37.436us            30  
           aten::reshape         0.04%      28.867us         0.11%      71.958us       0.600us           120  
            aten::expand         0.06%      40.956us         0.08%      50.872us       0.424us           120  
            aten::select         0.05%      34.749us         0.07%      46.624us       0.259us           180  
                aten::to         0.01%       5.876us         0.06%      42.251us       1.408us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 67.042ms

2026-02-11 09:48:23,210 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         8.32%      24.024ms       100.00%     288.892ms       9.630ms            30  
                       aten::to_sparse_csr         0.01%      16.376us        29.59%      85.495ms       2.850ms            30  
                      aten::_to_sparse_csr         1.35%       3.895ms        29.59%      85.479ms       2.849ms            30  
                            aten::to_dense         0.01%      19.835us        27.69%      79.997ms       2.667ms            30  
                           aten::_to_dense         5.75%      16.623ms        27.68%      79.977ms       2.666ms            30  
                             aten::nonzero        21.13%      61.042ms        21.16%      61.117ms       1.019ms            60  
                               aten::copy_        12.94%      37.388ms        15.11%      43.665ms      97.034us           450  
                aten::sparse_sampled_addmm        10.98%      31.716ms        13.27%      38.326ms       1.278ms            30  
                         aten::masked_fill         0.02%      66.130us         9.64%      27.852ms     928.388us            30  
                                 aten::mul         7.17%      20.721ms         9.59%      27.691ms     115.378us           240  
                        aten::masked_fill_         8.25%      23.828ms         8.25%      23.828ms     794.264us            30  
                            aten::_to_copy         0.08%     220.403us         7.73%      22.340ms     124.109us           180  
                                  aten::to         0.01%      38.459us         5.26%      15.197ms     126.643us           120  
                                  aten::ne         1.62%       4.666ms         4.30%      12.434ms     414.482us            30  
    aten::_convert_indices_from_csr_to_coo         2.71%       7.839ms         4.22%      12.199ms     406.622us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 288.892ms

2026-02-11 09:48:23,826 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.71%       2.309ms       100.00%     324.531ms      10.818ms            30  
    extension_cpp::sparse_attn        99.14%     321.731ms        99.27%     322.155ms      10.739ms            30  
               aten::new_zeros         0.01%      16.795us         0.12%     398.755us      13.292us            30  
                   aten::zero_         0.00%      15.956us         0.12%     380.000us       6.333us            60  
                   aten::fill_         0.11%     364.044us         0.11%     364.044us      12.135us            30  
                 aten::squeeze         0.01%      38.882us         0.01%      45.295us       0.503us            90  
               aten::unsqueeze         0.01%      17.667us         0.01%      21.333us       0.711us            30  
                   aten::empty         0.01%      19.833us         0.01%      19.833us       0.220us            90  
              aten::as_strided         0.00%      10.079us         0.00%      10.079us       0.084us           120  
               aten::new_empty         0.00%       4.127us         0.00%       8.627us       0.288us            30  
              aten::contiguous         0.00%       2.962us         0.00%       2.962us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 324.531ms

2026-02-11 09:48:23,828 - INFO - [22/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=70%
2026-02-11 09:48:24,021 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        12.61%       7.528ms       100.00%      59.691ms       1.990ms            30  
       aten::masked_fill         0.06%      38.706us        31.90%      19.042ms     634.740us            30  
            aten::matmul         0.14%      81.701us        29.92%      17.860ms     297.663us            60  
               aten::bmm        29.43%      17.567ms        29.52%      17.624ms     293.727us            60  
      aten::masked_fill_        25.72%      15.352ms        25.72%      15.352ms     511.732us            30  
           aten::softmax         0.03%      14.956us        17.38%      10.374ms     345.797us            30  
          aten::_softmax        17.35%      10.359ms        17.35%      10.359ms     345.298us            30  
               aten::div         6.06%       3.614ms         6.14%       3.668ms     122.257us            30  
             aten::clone         0.03%      17.040us         6.12%       3.652ms     121.718us            30  
             aten::copy_         6.08%       3.630ms         6.08%       3.630ms      60.492us            60  
       aten::bitwise_not         1.94%       1.155ms         1.94%       1.155ms      38.507us            30  
           aten::reshape         0.06%      33.918us         0.15%      87.751us       0.731us           120  
            aten::expand         0.08%      45.836us         0.10%      57.878us       0.482us           120  
                aten::to         0.01%       6.537us         0.09%      53.331us       1.778us            30  
            aten::select         0.06%      37.298us         0.08%      50.667us       0.281us           180  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 59.691ms

2026-02-11 09:48:24,505 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         8.77%      17.220ms       100.00%     196.367ms       6.546ms            30  
                       aten::to_sparse_csr         0.01%      11.497us        32.87%      64.541ms       2.151ms            30  
                      aten::_to_sparse_csr         1.85%       3.635ms        32.86%      64.530ms       2.151ms            30  
                            aten::to_dense         0.01%      14.332us        25.07%      49.228ms       1.641ms            30  
                           aten::_to_dense         6.20%      12.167ms        25.06%      49.214ms       1.640ms            30  
                             aten::nonzero        22.61%      44.407ms        22.64%      44.458ms     740.961us            60  
                               aten::copy_        13.25%      26.027ms        15.09%      29.638ms      65.863us           450  
                         aten::masked_fill         0.03%      51.378us         9.76%      19.173ms     639.104us            30  
                aten::sparse_sampled_addmm         7.77%      15.266ms         9.75%      19.149ms     638.295us            30  
                            aten::_to_copy         0.08%     154.372us         8.21%      16.126ms      89.591us           180  
                                 aten::mul         5.99%      11.756ms         8.04%      15.778ms      65.744us           240  
                        aten::masked_fill_         7.79%      15.296ms         7.79%      15.296ms     509.877us            30  
                                  aten::to         0.01%      23.459us         6.05%      11.881ms      99.010us           120  
                                  aten::ne         2.06%       4.054ms         5.85%      11.489ms     382.972us            30  
                             aten::softmax         0.01%      20.167us         5.15%      10.119ms     337.284us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 196.367ms

2026-02-11 09:48:24,907 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.19%       2.329ms       100.00%     195.792ms       6.526ms            30  
    extension_cpp::sparse_attn        98.56%     192.966ms        98.77%     193.393ms       6.446ms            30  
               aten::new_zeros         0.01%      15.876us         0.20%     400.126us      13.338us            30  
                   aten::zero_         0.01%      16.540us         0.20%     382.124us       6.369us            60  
                   aten::fill_         0.19%     365.584us         0.19%     365.584us      12.186us            30  
                 aten::squeeze         0.02%      39.497us         0.02%      46.207us       0.513us            90  
               aten::unsqueeze         0.01%      20.426us         0.01%      24.422us       0.814us            30  
                   aten::empty         0.01%      21.001us         0.01%      21.001us       0.233us            90  
              aten::as_strided         0.01%      10.706us         0.01%      10.706us       0.089us           120  
               aten::new_empty         0.00%       4.707us         0.00%       8.707us       0.290us            30  
              aten::contiguous         0.00%       3.006us         0.00%       3.006us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 195.792ms

2026-02-11 09:48:24,910 - INFO - [23/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=90%
2026-02-11 09:48:25,089 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        16.55%       9.240ms       100.00%      55.840ms       1.861ms            30  
            aten::matmul         0.15%      85.748us        31.11%      17.369ms     289.488us            60  
               aten::bmm        30.59%      17.081ms        30.69%      17.138ms     285.626us            60  
       aten::masked_fill         0.07%      37.424us        21.78%      12.164ms     405.452us            30  
           aten::softmax         0.02%      13.623us        19.74%      11.021ms     367.363us            30  
          aten::_softmax        19.71%      11.007ms        19.71%      11.007ms     366.909us            30  
      aten::masked_fill_        14.76%       8.239ms        14.76%       8.239ms     274.646us            30  
               aten::div         8.20%       4.579ms         8.28%       4.626ms     154.203us            30  
             aten::clone         0.03%      16.090us         6.96%       3.887ms     129.559us            30  
             aten::copy_         6.93%       3.868ms         6.93%       3.868ms      64.463us            60  
       aten::bitwise_not         2.44%       1.364ms         2.44%       1.364ms      45.460us            30  
           aten::reshape         0.06%      30.888us         0.15%      82.175us       0.685us           120  
            aten::expand         0.08%      43.075us         0.10%      54.412us       0.453us           120  
            aten::select         0.07%      37.872us         0.09%      50.703us       0.282us           180  
                aten::to         0.01%       6.210us         0.08%      46.626us       1.554us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 55.840ms

2026-02-11 09:48:25,436 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        10.71%      12.287ms       100.00%     114.722ms       3.824ms            30  
                       aten::to_sparse_csr         0.01%       6.790us        36.17%      41.497ms       1.383ms            30  
                      aten::_to_sparse_csr         2.22%       2.549ms        36.17%      41.491ms       1.383ms            30  
                             aten::nonzero        21.73%      24.927ms        21.76%      24.960ms     415.994us            60  
                            aten::to_dense         0.01%       9.205us        18.80%      21.573ms     719.090us            30  
                           aten::_to_dense         5.03%       5.776ms        18.80%      21.563ms     718.783us            30  
                               aten::copy_        14.54%      16.679ms        15.72%      18.029ms      40.064us           450  
                                  aten::ne         3.70%       4.242ms        10.46%      12.005ms     400.154us            30  
                         aten::masked_fill         0.03%      39.711us         9.68%      11.108ms     370.257us            30  
                            aten::_to_copy         0.11%     127.303us         9.29%      10.663ms      59.237us           180  
                             aten::softmax         0.01%      13.751us         8.88%      10.190ms     339.664us            30  
                            aten::_softmax         8.87%      10.176ms         8.87%      10.176ms     339.206us            30  
                                  aten::to         0.02%      18.084us         8.10%       9.295ms      77.458us           120  
                        aten::masked_fill_         6.45%       7.398ms         6.45%       7.398ms     246.594us            30  
                aten::sparse_sampled_addmm         4.87%       5.582ms         6.25%       7.168ms     238.928us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 114.722ms

2026-02-11 09:48:25,617 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.34%     220.160us       100.00%      63.912ms       2.130ms            30  
    extension_cpp::sparse_attn        98.85%      63.177ms        99.57%      63.635ms       2.121ms            30  
               aten::new_zeros         0.02%      14.373us         0.68%     437.584us      14.586us            30  
                   aten::zero_         0.02%      12.173us         0.66%     419.754us       6.996us            60  
                   aten::fill_         0.64%     407.581us         0.64%     407.581us      13.586us            30  
                 aten::squeeze         0.05%      33.587us         0.06%      39.338us       0.437us            90  
                   aten::empty         0.03%      17.249us         0.03%      17.249us       0.192us            90  
               aten::unsqueeze         0.02%      14.293us         0.03%      17.042us       0.568us            30  
              aten::as_strided         0.01%       8.500us         0.01%       8.500us       0.071us           120  
               aten::new_empty         0.01%       4.163us         0.01%       8.081us       0.269us            30  
              aten::contiguous         0.00%       3.085us         0.00%       3.085us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 63.912ms

2026-02-11 09:48:25,620 - INFO - [24/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=95%
2026-02-11 09:48:25,786 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        16.86%       8.261ms       100.00%      49.010ms       1.634ms            30  
            aten::matmul         0.15%      71.493us        33.95%      16.640ms     277.328us            60  
               aten::bmm        33.42%      16.380ms        33.53%      16.433ms     273.877us            60  
           aten::softmax         0.02%      11.917us        20.77%      10.178ms     339.271us            30  
          aten::_softmax        20.74%      10.166ms        20.74%      10.166ms     338.874us            30  
       aten::masked_fill         0.07%      34.248us        18.61%       9.120ms     304.001us            30  
      aten::masked_fill_        11.14%       5.458ms        11.14%       5.458ms     181.934us            30  
               aten::div         7.37%       3.612ms         7.45%       3.653ms     121.771us            30  
             aten::clone         0.03%      15.254us         7.40%       3.628ms     120.926us            30  
             aten::copy_         7.37%       3.610ms         7.37%       3.610ms      60.164us            60  
       aten::bitwise_not         2.26%       1.108ms         2.26%       1.108ms      36.935us            30  
           aten::reshape         0.06%      30.745us         0.16%      78.872us       0.657us           120  
            aten::expand         0.08%      38.999us         0.10%      48.923us       0.408us           120  
            aten::select         0.07%      33.131us         0.10%      46.747us       0.260us           180  
                aten::to         0.01%       6.079us         0.08%      40.832us       1.361us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 49.010ms

2026-02-11 09:48:26,115 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        14.05%      14.553ms       100.00%     103.546ms       3.452ms            30  
                       aten::to_sparse_csr         0.01%       8.956us        37.34%      38.660ms       1.289ms            30  
                      aten::_to_sparse_csr         3.34%       3.457ms        37.33%      38.651ms       1.288ms            30  
                             aten::nonzero        20.07%      20.786ms        20.12%      20.833ms     347.221us            60  
                               aten::copy_        15.00%      15.530ms        15.92%      16.484ms      36.630us           450  
                            aten::to_dense         0.01%      12.083us        14.52%      15.033ms     501.087us            30  
                           aten::_to_dense         2.59%       2.683ms        14.51%      15.021ms     500.684us            30  
                                  aten::ne         4.79%       4.959ms        12.54%      12.986ms     432.854us            30  
                             aten::softmax         0.02%      18.794us        10.70%      11.075ms     369.156us            30  
                            aten::_softmax        10.68%      11.056ms        10.68%      11.056ms     368.529us            30  
                            aten::_to_copy         0.14%     142.667us         9.88%      10.227ms      56.814us           180  
                         aten::masked_fill         0.04%      43.326us         9.46%       9.795ms     326.485us            30  
                                  aten::to         0.02%      20.959us         8.91%       9.221ms      76.842us           120  
                              aten::matmul         0.07%      69.078us         6.04%       6.252ms     208.415us            30  
                                 aten::bmm         5.83%       6.032ms         5.86%       6.063ms     202.096us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 103.546ms

2026-02-11 09:48:26,246 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.72%     233.547us       100.00%      32.543ms       1.085ms            30  
    extension_cpp::sparse_attn        97.79%      31.824ms        99.10%      32.252ms       1.075ms            30  
               aten::new_zeros         0.04%      14.209us         1.25%     405.877us      13.529us            30  
                   aten::zero_         0.04%      12.374us         1.20%     389.003us       6.483us            60  
                   aten::fill_         1.16%     376.629us         1.16%     376.629us      12.554us            30  
                 aten::squeeze         0.11%      34.454us         0.13%      40.705us       0.452us            90  
               aten::unsqueeze         0.05%      14.710us         0.05%      17.587us       0.586us            30  
                   aten::empty         0.05%      17.131us         0.05%      17.131us       0.190us            90  
              aten::as_strided         0.03%       9.128us         0.03%       9.128us       0.076us           120  
               aten::new_empty         0.01%       3.995us         0.02%       7.332us       0.244us            30  
              aten::contiguous         0.01%       3.005us         0.01%       3.005us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 32.543ms

2026-02-11 09:48:26,248 - INFO - [25/45] Profiling attention with seq_len=1024, d_model=64, n_heads=1, sparsity=99%
2026-02-11 09:48:26,410 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        18.06%       8.631ms       100.00%      47.778ms       1.593ms            30  
            aten::matmul         0.15%      70.615us        34.60%      16.531ms     275.515us            60  
               aten::bmm        34.07%      16.279ms        34.18%      16.331ms     272.189us            60  
           aten::softmax         0.02%       9.872us        20.99%      10.029ms     334.303us            30  
          aten::_softmax        20.97%      10.019ms        20.97%      10.019ms     333.974us            30  
       aten::masked_fill         0.07%      31.587us        16.13%       7.705ms     256.848us            30  
      aten::masked_fill_         8.47%       4.045ms         8.47%       4.045ms     134.827us            30  
               aten::div         7.57%       3.615ms         7.65%       3.653ms     121.778us            30  
             aten::clone         0.03%      14.912us         7.60%       3.629ms     120.968us            30  
             aten::copy_         7.56%       3.611ms         7.56%       3.611ms      60.180us            60  
       aten::bitwise_not         2.47%       1.180ms         2.47%       1.180ms      39.344us            30  
           aten::reshape         0.06%      29.963us         0.15%      71.920us       0.599us           120  
            aten::expand         0.08%      38.421us         0.10%      49.413us       0.412us           120  
            aten::select         0.07%      32.575us         0.10%      46.334us       0.257us           180  
                aten::to         0.01%       4.711us         0.08%      38.837us       1.295us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 47.778ms

2026-02-11 09:48:26,693 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         9.00%       6.627ms       100.00%      73.618ms       2.454ms            30  
                       aten::to_sparse_csr         0.01%       5.497us        46.58%      34.289ms       1.143ms            30  
                      aten::_to_sparse_csr         8.09%       5.956ms        46.57%      34.283ms       1.143ms            30  
                             aten::nonzero        21.82%      16.062ms        21.86%      16.090ms     268.168us            60  
                                  aten::ne         5.87%       4.322ms        15.94%      11.735ms     391.176us            30  
                               aten::copy_        15.65%      11.525ms        15.81%      11.642ms      25.872us           450  
                             aten::softmax         0.01%      10.787us        13.57%       9.991ms     333.030us            30  
                            aten::_softmax        13.56%       9.980ms        13.56%       9.980ms     332.670us            30  
                            aten::_to_copy         0.11%      79.281us        10.68%       7.861ms      43.675us           180  
                                  aten::to         0.02%      14.418us        10.45%       7.695ms      64.127us           120  
                         aten::masked_fill         0.04%      29.922us        10.36%       7.629ms     254.291us            30  
                            aten::to_dense         0.01%       7.671us         8.27%       6.092ms     203.059us            30  
                           aten::_to_dense         1.14%     839.155us         8.26%       6.084ms     202.803us            30  
                              aten::matmul         0.06%      44.756us         8.06%       5.937ms     197.887us            30  
                                 aten::bmm         7.85%       5.776ms         7.89%       5.805ms     193.494us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 73.618ms

2026-02-11 09:48:26,781 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         3.00%     220.129us       100.00%       7.327ms     244.248us            30  
    extension_cpp::sparse_attn        90.53%       6.634ms        96.22%       7.051ms     235.021us            30  
               aten::new_zeros         0.18%      13.374us         5.42%     397.465us      13.249us            30  
                   aten::zero_         0.15%      11.334us         5.20%     381.216us       6.354us            60  
                   aten::fill_         5.05%     369.882us         5.05%     369.882us      12.329us            30  
                 aten::squeeze         0.46%      33.421us         0.54%      39.422us       0.438us            90  
               aten::unsqueeze         0.20%      14.454us         0.24%      17.249us       0.575us            30  
                   aten::empty         0.22%      16.249us         0.22%      16.249us       0.181us            90  
              aten::as_strided         0.12%       8.796us         0.12%       8.796us       0.073us           120  
               aten::new_empty         0.05%       3.540us         0.10%       6.999us       0.233us            30  
              aten::contiguous         0.03%       2.417us         0.03%       2.417us       0.027us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.327ms

2026-02-11 09:48:26,784 - INFO - [26/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=50%
2026-02-11 09:48:26,995 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        11.77%       8.869ms       100.00%      75.321ms       2.511ms            30  
       aten::masked_fill         0.05%      39.707us        37.37%      28.150ms     938.320us            30  
      aten::masked_fill_        32.17%      24.228ms        32.17%      24.228ms     807.616us            30  
            aten::matmul         0.12%      89.621us        29.91%      22.530ms     375.502us            60  
               aten::bmm        29.49%      22.215ms        29.57%      22.274ms     371.231us            60  
           aten::softmax         0.02%      16.795us        14.03%      10.565ms     352.179us            30  
          aten::_softmax        14.00%      10.549ms        14.00%      10.549ms     351.619us            30  
               aten::div         5.08%       3.823ms         5.16%       3.883ms     129.433us            30  
             aten::clone         0.02%      17.380us         5.15%       3.881ms     129.380us            30  
             aten::copy_         5.13%       3.862ms         5.13%       3.862ms      64.368us            60  
       aten::bitwise_not         1.67%       1.256ms         1.67%       1.256ms      41.857us            30  
           aten::reshape         0.05%      37.553us         0.13%      96.919us       0.808us           120  
            aten::expand         0.07%      49.381us         0.08%      60.875us       0.507us           120  
                aten::to         0.01%       7.168us         0.08%      59.668us       1.989us            30  
            aten::select         0.05%      38.999us         0.07%      52.791us       0.293us           180  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 75.321ms

2026-02-11 09:48:27,667 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         7.64%      23.549ms       100.00%     308.050ms      10.268ms            30  
                       aten::to_sparse_csr         0.01%      15.540us        26.75%      82.413ms       2.747ms            30  
                      aten::_to_sparse_csr         1.24%       3.820ms        26.75%      82.398ms       2.747ms            30  
                            aten::to_dense         0.01%      17.326us        24.67%      75.987ms       2.533ms            30  
                           aten::_to_dense         5.08%      15.663ms        24.66%      75.970ms       2.532ms            30  
                aten::sparse_sampled_addmm        18.69%      57.564ms        20.76%      63.958ms       2.132ms            30  
                             aten::nonzero        19.04%      58.657ms        19.06%      58.728ms     978.799us            60  
                               aten::copy_        11.83%      36.440ms        13.81%      42.540ms      94.534us           450  
                         aten::masked_fill         0.02%      61.541us         8.91%      27.459ms     915.285us            30  
                                 aten::mul         6.39%      19.695ms         8.54%      26.309ms     109.619us           240  
                        aten::masked_fill_         7.65%      23.573ms         7.65%      23.573ms     785.764us            30  
                            aten::_to_copy         0.06%     188.304us         7.30%      22.489ms     124.940us           180  
                                  aten::to         0.01%      35.414us         4.96%      15.293ms     127.445us           120  
                                  aten::ne         1.41%       4.350ms         3.96%      12.187ms     406.242us            30  
                               aten::clone         0.03%      84.867us         3.74%      11.521ms      76.804us           150  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 308.050ms

2026-02-11 09:48:28,874 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.12%     793.919us       100.00%     677.266ms      22.576ms            30  
    extension_cpp::sparse_attn        99.80%     675.917ms        99.87%     676.396ms      22.547ms            30  
               aten::new_zeros         0.00%      17.173us         0.07%     442.801us      14.760us            30  
                   aten::zero_         0.00%      18.792us         0.06%     424.671us       7.078us            60  
                   aten::fill_         0.06%     405.879us         0.06%     405.879us      13.529us            30  
                 aten::squeeze         0.01%      41.754us         0.01%      48.958us       0.544us            90  
                   aten::empty         0.00%      29.124us         0.00%      29.124us       0.324us            90  
               aten::unsqueeze         0.00%      22.705us         0.00%      26.956us       0.899us            30  
              aten::as_strided         0.00%      11.455us         0.00%      11.455us       0.095us           120  
               aten::new_empty         0.00%       4.291us         0.00%       9.916us       0.331us            30  
              aten::contiguous         0.00%       3.458us         0.00%       3.458us       0.038us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 677.266ms

2026-02-11 09:48:28,877 - INFO - [27/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=70%
2026-02-11 09:48:29,079 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        13.05%       8.488ms       100.00%      65.033ms       2.168ms            30  
            aten::matmul         0.12%      74.841us        34.70%      22.570ms     376.162us            60  
               aten::bmm        34.28%      22.293ms        34.36%      22.347ms     372.443us            60  
       aten::masked_fill         0.05%      34.753us        29.16%      18.963ms     632.109us            30  
      aten::masked_fill_        23.87%      15.524ms        23.87%      15.524ms     517.466us            30  
           aten::softmax         0.02%      12.371us        15.46%      10.055ms     335.161us            30  
          aten::_softmax        15.44%      10.042ms        15.44%      10.042ms     334.749us            30  
               aten::div         5.63%       3.662ms         5.70%       3.709ms     123.632us            30  
             aten::clone         0.02%      16.166us         5.24%       3.405ms     113.485us            30  
             aten::copy_         5.20%       3.383ms         5.20%       3.383ms      56.376us            60  
       aten::bitwise_not         1.84%       1.194ms         1.84%       1.194ms      39.792us            30  
           aten::reshape         0.05%      32.780us         0.13%      87.286us       0.727us           120  
            aten::expand         0.07%      42.625us         0.08%      52.495us       0.437us           120  
            aten::select         0.05%      35.754us         0.07%      48.379us       0.269us           180  
                aten::to         0.01%       6.329us         0.07%      46.538us       1.551us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 65.033ms

2026-02-11 09:48:29,611 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         9.30%      20.983ms       100.00%     225.727ms       7.524ms            30  
                       aten::to_sparse_csr         0.01%      11.411us        29.16%      65.828ms       2.194ms            30  
                      aten::_to_sparse_csr         1.98%       4.467ms        29.16%      65.816ms       2.194ms            30  
                            aten::to_dense         0.01%      14.748us        22.12%      49.925ms       1.664ms            30  
                           aten::_to_dense         5.68%      12.820ms        22.11%      49.910ms       1.664ms            30  
                             aten::nonzero        19.63%      44.303ms        19.65%      44.360ms     739.328us            60  
                aten::sparse_sampled_addmm        15.85%      35.776ms        17.62%      39.776ms       1.326ms            30  
                               aten::copy_        11.96%      26.995ms        13.61%      30.717ms      68.260us           450  
                         aten::masked_fill         0.02%      53.165us         8.48%      19.137ms     637.907us            30  
                            aten::_to_copy         0.07%     166.072us         7.69%      17.361ms      96.453us           180  
                                 aten::mul         5.17%      11.670ms         7.07%      15.957ms      66.486us           240  
                        aten::masked_fill_         6.75%      15.227ms         6.75%      15.227ms     507.551us            30  
                                  aten::to         0.01%      24.416us         5.61%      12.662ms     105.520us           120  
                                  aten::ne         1.95%       4.402ms         5.38%      12.146ms     404.874us            30  
                             aten::softmax         0.01%      19.663us         4.49%      10.138ms     337.944us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 225.727ms

2026-02-11 09:48:30,365 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.27%       1.099ms       100.00%     406.305ms      13.543ms            30  
    extension_cpp::sparse_attn        99.59%     404.651ms        99.71%     405.128ms      13.504ms            30  
               aten::new_zeros         0.00%      16.918us         0.11%     444.170us      14.806us            30  
                   aten::zero_         0.00%      18.707us         0.10%     426.047us       7.101us            60  
                   aten::fill_         0.10%     407.340us         0.10%     407.340us      13.578us            30  
                 aten::squeeze         0.01%      43.375us         0.01%      50.463us       0.561us            90  
               aten::unsqueeze         0.01%      22.541us         0.01%      27.250us       0.908us            30  
                   aten::empty         0.01%      25.749us         0.01%      25.749us       0.286us            90  
              aten::as_strided         0.00%      11.797us         0.00%      11.797us       0.098us           120  
               aten::new_empty         0.00%       4.499us         0.00%       9.165us       0.305us            30  
              aten::contiguous         0.00%       3.749us         0.00%       3.749us       0.042us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 406.305ms

2026-02-11 09:48:30,368 - INFO - [28/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=90%
2026-02-11 09:48:30,552 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        16.39%       9.534ms       100.00%      58.163ms       1.939ms            30  
            aten::matmul         0.13%      74.540us        38.84%      22.592ms     376.536us            60  
               aten::bmm        38.39%      22.326ms        38.49%      22.385ms     373.076us            60  
       aten::masked_fill         0.06%      34.044us        18.65%      10.850ms     361.667us            30  
           aten::softmax         0.02%      11.627us        17.41%      10.129ms     337.634us            30  
          aten::_softmax        17.39%      10.117ms        17.39%      10.117ms     337.246us            30  
      aten::masked_fill_        12.69%       7.379ms        12.69%       7.379ms     245.956us            30  
               aten::div         6.55%       3.809ms         6.62%       3.853ms     128.425us            30  
             aten::clone         0.03%      16.333us         5.91%       3.437ms     114.576us            30  
             aten::copy_         5.88%       3.418ms         5.88%       3.418ms      56.960us            60  
       aten::bitwise_not         1.98%       1.151ms         1.98%       1.151ms      38.375us            30  
           aten::reshape         0.05%      30.033us         0.13%      73.619us       0.613us           120  
            aten::select         0.07%      38.667us         0.09%      52.251us       0.290us           180  
            aten::expand         0.07%      40.876us         0.09%      51.504us       0.429us           120  
                aten::to         0.01%       5.708us         0.07%      43.335us       1.444us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 58.163ms

2026-02-11 09:48:30,929 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        11.67%      15.431ms       100.00%     132.181ms       4.406ms            30  
                       aten::to_sparse_csr         0.01%      10.838us        33.23%      43.930ms       1.464ms            30  
                      aten::_to_sparse_csr         2.39%       3.163ms        33.23%      43.919ms       1.464ms            30  
                             aten::nonzero        19.68%      26.014ms        19.72%      26.061ms     434.354us            60  
                            aten::to_dense         0.01%      12.582us        17.77%      23.485ms     782.827us            30  
                           aten::_to_dense         5.61%       7.411ms        17.76%      23.472ms     782.408us            30  
                               aten::copy_        12.90%      17.057ms        13.90%      18.372ms      40.826us           450  
                aten::sparse_sampled_addmm         8.57%      11.326ms         9.76%      12.896ms     429.857us            30  
                                  aten::ne         3.54%       4.678ms         9.63%      12.726ms     424.212us            30  
                         aten::masked_fill         0.04%      47.337us         8.71%      11.518ms     383.948us            30  
                            aten::_to_copy         0.11%     143.290us         8.35%      11.038ms      61.323us           180  
                             aten::softmax         0.01%      17.830us         8.16%      10.784ms     359.472us            30  
                            aten::_softmax         8.15%      10.766ms         8.15%      10.766ms     358.877us            30  
                              aten::matmul         0.05%      71.837us         7.30%       9.651ms     321.695us            30  
                                  aten::to         0.02%      20.747us         7.29%       9.636ms      80.303us           120  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 132.181ms

2026-02-11 09:48:31,236 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.20%     269.466us       100.00%     134.480ms       4.483ms            30  
    extension_cpp::sparse_attn        99.40%     133.674ms        99.75%     134.145ms       4.472ms            30  
               aten::new_zeros         0.01%      16.417us         0.33%     446.961us      14.899us            30  
                   aten::zero_         0.01%      14.710us         0.32%     427.461us       7.124us            60  
                   aten::fill_         0.31%     412.751us         0.31%     412.751us      13.758us            30  
                 aten::squeeze         0.03%      37.659us         0.03%      44.201us       0.491us            90  
               aten::unsqueeze         0.01%      17.669us         0.02%      21.001us       0.700us            30  
                   aten::empty         0.01%      19.544us         0.01%      19.544us       0.217us            90  
              aten::as_strided         0.01%       9.874us         0.01%       9.874us       0.082us           120  
               aten::new_empty         0.00%       4.416us         0.01%       8.583us       0.286us            30  
              aten::contiguous         0.00%       3.208us         0.00%       3.208us       0.036us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 134.480ms

2026-02-11 09:48:31,239 - INFO - [29/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=95%
2026-02-11 09:48:31,416 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        16.15%       8.835ms       100.00%      54.716ms       1.824ms            30  
            aten::matmul         0.14%      74.540us        40.05%      21.912ms     365.205us            60  
               aten::bmm        39.56%      21.647ms        39.66%      21.701ms     361.691us            60  
           aten::softmax         0.02%      10.336us        18.47%      10.106ms     336.856us            30  
          aten::_softmax        18.45%      10.095ms        18.45%      10.095ms     336.511us            30  
       aten::masked_fill         0.06%      32.250us        16.18%       8.852ms     295.054us            30  
      aten::masked_fill_         9.89%       5.411ms         9.89%       5.411ms     180.351us            30  
               aten::div         6.74%       3.690ms         6.82%       3.733ms     124.428us            30  
             aten::clone         0.04%      21.037us         6.23%       3.409ms     113.628us            30  
             aten::copy_         6.18%       3.384ms         6.18%       3.384ms      56.393us            60  
       aten::bitwise_not         2.23%       1.222ms         2.23%       1.222ms      40.747us            30  
           aten::reshape         0.05%      28.208us         0.14%      73.882us       0.616us           120  
            aten::expand         0.08%      43.954us         0.10%      54.417us       0.453us           120  
            aten::select         0.07%      35.706us         0.09%      48.833us       0.271us           180  
                aten::to         0.01%       5.542us         0.08%      42.628us       1.421us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 54.716ms

2026-02-11 09:48:31,744 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*        10.04%       9.977ms       100.00%      99.380ms       3.313ms            30  
                       aten::to_sparse_csr         0.01%       6.290us        36.70%      36.471ms       1.216ms            30  
                      aten::_to_sparse_csr         3.44%       3.421ms        36.69%      36.465ms       1.216ms            30  
                             aten::nonzero        19.56%      19.437ms        19.59%      19.469ms     324.489us            60  
                               aten::copy_        15.09%      14.996ms        16.03%      15.931ms      35.402us           450  
                            aten::to_dense         0.01%       8.330us        16.01%      15.910ms     530.324us            30  
                           aten::_to_dense         4.08%       4.059ms        16.00%      15.901ms     530.046us            30  
                                  aten::ne         4.37%       4.340ms        12.29%      12.209ms     406.970us            30  
                             aten::softmax         0.01%      13.794us        10.19%      10.129ms     337.632us            30  
                            aten::_softmax        10.18%      10.115ms        10.18%      10.115ms     337.172us            30  
                            aten::_to_copy         0.12%     117.383us        10.01%       9.945ms      55.249us           180  
                                  aten::to         0.02%      17.868us         9.04%       8.987ms      74.889us           120  
                         aten::masked_fill         0.03%      33.159us         9.03%       8.971ms     299.023us            30  
                              aten::matmul         0.05%      50.590us         7.65%       7.604ms     253.453us            30  
                                 aten::bmm         7.48%       7.429ms         7.50%       7.457ms     248.557us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 99.380ms

2026-02-11 09:48:31,933 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.51%     348.455us       100.00%      68.107ms       2.270ms            30  
    extension_cpp::sparse_attn        98.76%      67.261ms        99.40%      67.696ms       2.257ms            30  
               aten::new_zeros         0.02%      14.466us         0.60%     411.379us      13.713us            30  
                   aten::zero_         0.02%      13.244us         0.58%     394.579us       6.576us            60  
                   aten::fill_         0.56%     381.335us         0.56%     381.335us      12.711us            30  
                 aten::squeeze         0.05%      34.997us         0.06%      41.623us       0.462us            90  
               aten::unsqueeze         0.03%      17.212us         0.03%      20.501us       0.683us            30  
                   aten::empty         0.03%      18.879us         0.03%      18.879us       0.210us            90  
              aten::as_strided         0.01%       9.915us         0.01%       9.915us       0.083us           120  
               aten::new_empty         0.01%       3.705us         0.01%       7.457us       0.249us            30  
              aten::contiguous         0.00%       3.042us         0.00%       3.042us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 68.107ms

2026-02-11 09:48:31,935 - INFO - [30/45] Profiling attention with seq_len=1024, d_model=128, n_heads=1, sparsity=99%
2026-02-11 09:48:32,116 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        17.46%       9.400ms       100.00%      53.840ms       1.795ms            30  
            aten::matmul         0.14%      77.830us        40.75%      21.941ms     365.677us            60  
               aten::bmm        40.25%      21.670ms        40.35%      21.722ms     362.036us            60  
           aten::softmax         0.02%      10.293us        18.73%      10.084ms     336.132us            30  
          aten::_softmax        18.71%      10.074ms        18.71%      10.074ms     335.789us            30  
       aten::masked_fill         0.06%      32.450us        13.93%       7.500ms     249.992us            30  
      aten::masked_fill_         7.71%       4.149ms         7.71%       4.149ms     138.311us            30  
               aten::div         6.91%       3.723ms         7.00%       3.768ms     125.586us            30  
             aten::clone         0.03%      15.798us         6.16%       3.318ms     110.600us            30  
             aten::copy_         6.12%       3.297ms         6.12%       3.297ms      54.945us            60  
       aten::bitwise_not         2.04%       1.098ms         2.04%       1.098ms      36.586us            30  
           aten::reshape         0.05%      28.792us         0.15%      79.459us       0.662us           120  
            aten::expand         0.08%      42.334us         0.10%      52.873us       0.441us           120  
            aten::select         0.06%      33.471us         0.09%      46.341us       0.257us           180  
                aten::to         0.01%       6.583us         0.08%      44.875us       1.496us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 53.840ms

2026-02-11 09:48:32,409 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         9.34%       7.343ms       100.00%      78.643ms       2.621ms            30  
                       aten::to_sparse_csr         0.01%       6.796us        42.75%      33.619ms       1.121ms            30  
                      aten::_to_sparse_csr         6.13%       4.823ms        42.74%      33.612ms       1.120ms            30  
                             aten::nonzero        20.55%      16.163ms        20.59%      16.193ms     269.888us            60  
                               aten::copy_        15.28%      12.017ms        15.43%      12.135ms      26.967us           450  
                                  aten::ne         5.59%       4.395ms        15.34%      12.062ms     402.080us            30  
                             aten::softmax         0.02%      12.878us        12.84%      10.102ms     336.718us            30  
                            aten::_softmax        12.83%      10.089ms        12.83%      10.089ms     336.289us            30  
                              aten::matmul         0.06%      49.802us        12.26%       9.645ms     321.506us            30  
                                 aten::bmm        12.05%       9.478ms        12.09%       9.505ms     316.818us            30  
                         aten::masked_fill         0.04%      31.378us        10.31%       8.112ms     270.400us            30  
                            aten::_to_copy         0.10%      81.954us        10.30%       8.103ms      45.018us           180  
                                  aten::to         0.02%      15.164us        10.10%       7.944ms      66.201us           120  
                            aten::to_dense         0.01%       7.750us         7.81%       6.141ms     204.705us            30  
                           aten::_to_dense         1.18%     930.844us         7.80%       6.133ms     204.447us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 78.643ms

2026-02-11 09:48:32,508 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.51%     214.181us       100.00%      14.196ms     473.186us            30  
    extension_cpp::sparse_attn        94.91%      13.474ms        98.09%      13.925ms     464.154us            30  
               aten::new_zeros         0.10%      14.212us         3.03%     430.312us      14.344us            30  
                   aten::zero_         0.08%      11.916us         2.91%     413.349us       6.889us            60  
                   aten::fill_         2.83%     401.433us         2.83%     401.433us      13.381us            30  
                 aten::squeeze         0.24%      33.783us         0.28%      39.414us       0.438us            90  
                   aten::empty         0.12%      17.547us         0.12%      17.547us       0.195us            90  
               aten::unsqueeze         0.10%      14.621us         0.12%      17.375us       0.579us            30  
              aten::as_strided         0.06%       8.385us         0.06%       8.385us       0.070us           120  
               aten::new_empty         0.02%       3.376us         0.05%       7.337us       0.245us            30  
              aten::contiguous         0.02%       2.622us         0.02%       2.622us       0.029us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 14.196ms

2026-02-11 09:48:32,511 - INFO - [31/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=50%
2026-02-11 09:48:32,981 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         3.57%       7.408ms       100.00%     207.713ms       6.924ms            30  
       aten::masked_fill         0.04%      80.251us        49.47%     102.753ms       3.425ms            30  
      aten::masked_fill_        44.57%      92.574ms        44.57%      92.574ms       3.086ms            30  
            aten::matmul         0.07%     154.107us        23.25%      48.286ms     804.769us            60  
               aten::bmm        23.00%      47.778ms        23.04%      47.857ms     797.623us            60  
           aten::softmax         0.01%      27.749us        16.17%      33.597ms       1.120ms            30  
          aten::_softmax        16.16%      33.569ms        16.16%      33.569ms       1.119ms            30  
               aten::div         4.94%      10.267ms         4.99%      10.364ms     345.459us            30  
             aten::clone         0.02%      35.378us         4.86%      10.098ms     336.615us            30  
             aten::copy_         4.84%      10.060ms         4.84%      10.060ms     167.665us            60  
       aten::bitwise_not         2.50%       5.200ms         2.50%       5.200ms     173.323us            30  
           aten::reshape         0.03%      60.543us         0.07%     154.877us       1.291us           120  
            aten::expand         0.04%      85.253us         0.05%     103.840us       0.865us           120  
                aten::to         0.01%      14.498us         0.05%      96.497us       3.217us            30  
          aten::_to_copy         0.01%      29.247us         0.04%      81.999us       2.733us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 207.713ms

2026-02-11 09:48:34,781 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.16%      40.676ms       100.00%     976.760ms      32.559ms            30  
                       aten::to_sparse_csr         0.00%      19.125us        32.99%     322.270ms      10.742ms            30  
                      aten::_to_sparse_csr         0.58%       5.667ms        32.99%     322.251ms      10.742ms            30  
                            aten::to_dense         0.00%      24.753us        29.16%     284.832ms       9.494ms            30  
                           aten::_to_dense         3.30%      32.220ms        29.16%     284.808ms       9.494ms            30  
                             aten::nonzero        23.59%     230.422ms        23.60%     230.533ms       3.842ms            60  
                               aten::copy_        16.07%     156.921ms        18.79%     183.533ms     407.851us           450  
                                 aten::mul         8.59%      83.949ms        11.46%     111.901ms     466.254us           240  
                         aten::masked_fill         0.01%      97.295us        11.30%     110.399ms       3.680ms            30  
                aten::sparse_sampled_addmm         7.67%      74.895ms        10.43%     101.922ms       3.397ms            30  
                        aten::masked_fill_         9.49%      92.681ms         9.49%      92.681ms       3.089ms            30  
                            aten::_to_copy         0.03%     303.664us         9.12%      89.058ms     494.769us           180  
                                  aten::to         0.01%      56.834us         6.31%      61.672ms     513.930us           120  
                                  aten::ne         2.01%      19.656ms         5.48%      53.541ms       1.785ms            30  
    aten::_convert_indices_from_csr_to_coo         3.37%      32.887ms         5.29%      51.712ms       1.724ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 976.760ms

2026-02-11 09:48:36,178 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.09%     735.794us       100.00%     789.178ms      26.306ms            30  
    extension_cpp::sparse_attn        99.81%     787.694ms        99.89%     788.339ms      26.278ms            30  
               aten::new_zeros         0.00%      34.248us         0.07%     566.339us      18.878us            30  
                   aten::zero_         0.01%      42.541us         0.07%     541.962us       9.033us            60  
                   aten::fill_         0.06%     499.421us         0.06%     499.421us      16.647us            30  
                   aten::empty         0.01%      55.041us         0.01%      55.041us       0.612us            90  
                 aten::squeeze         0.01%      46.538us         0.01%      53.077us       0.590us            90  
               aten::unsqueeze         0.01%      43.500us         0.01%      49.752us       1.658us            30  
               aten::new_empty         0.00%      10.338us         0.00%      17.585us       0.586us            30  
              aten::as_strided         0.00%      12.791us         0.00%      12.791us       0.107us           120  
              aten::contiguous         0.00%       3.705us         0.00%       3.705us       0.041us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 789.178ms

2026-02-11 09:48:36,181 - INFO - [32/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=70%
2026-02-11 09:48:36,658 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         7.39%      14.670ms       100.00%     198.506ms       6.617ms            30  
       aten::masked_fill         0.04%      79.545us        38.37%      76.172ms       2.539ms            30  
      aten::masked_fill_        29.79%      59.131ms        29.79%      59.131ms       1.971ms            30  
            aten::matmul         0.06%     126.591us        23.54%      46.731ms     778.856us            60  
               aten::bmm        23.33%      46.302ms        23.36%      46.371ms     772.850us            60  
           aten::softmax         0.01%      25.374us        19.62%      38.953ms       1.298ms            30  
          aten::_softmax        19.61%      38.928ms        19.61%      38.928ms       1.298ms            30  
             aten::clone         0.02%      35.539us         8.54%      16.961ms     565.379us            30  
             aten::copy_         8.53%      16.924ms         8.53%      16.924ms     282.064us            60  
               aten::div         8.38%      16.633ms         8.43%      16.727ms     557.567us            30  
       aten::bitwise_not         2.60%       5.151ms         2.60%       5.151ms     171.711us            30  
           aten::reshape         0.03%      53.758us         0.07%     141.755us       1.181us           120  
                aten::to         0.01%      14.289us         0.05%      93.955us       3.132us            30  
          aten::_to_copy         0.01%      26.413us         0.04%      79.666us       2.656us            30  
            aten::expand         0.03%      64.408us         0.04%      78.949us       0.658us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 198.506ms

2026-02-11 09:48:38,033 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         6.77%      49.173ms       100.00%     726.563ms      24.219ms            30  
                       aten::to_sparse_csr         0.00%      20.752us        35.44%     257.519ms       8.584ms            30  
                      aten::_to_sparse_csr         0.76%       5.539ms        35.44%     257.498ms       8.583ms            30  
                            aten::to_dense         0.00%      25.034us        24.85%     180.547ms       6.018ms            30  
                           aten::_to_dense         3.40%      24.699ms        24.85%     180.522ms       6.017ms            30  
                             aten::nonzero        24.32%     176.671ms        24.33%     176.785ms       2.946ms            60  
                               aten::copy_        16.14%     117.245ms        18.24%     132.549ms     294.554us           450  
                         aten::masked_fill         0.01%      98.164us        10.85%      78.865ms       2.629ms            30  
                            aten::_to_copy         0.04%     299.262us         9.56%      69.482ms     386.010us           180  
                                 aten::mul         6.90%      50.123ms         9.42%      68.452ms     285.218us           240  
                aten::sparse_sampled_addmm         6.35%      46.108ms         8.51%      61.816ms       2.061ms            30  
                        aten::masked_fill_         8.35%      60.700ms         8.35%      60.700ms       2.023ms            30  
                                  aten::ne         2.84%      20.669ms         7.71%      56.015ms       1.867ms            30  
                                  aten::to         0.01%      56.163us         7.24%      52.608ms     438.402us           120  
                             aten::softmax         0.00%      35.163us         5.67%      41.190ms       1.373ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 726.563ms

2026-02-11 09:48:38,942 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.52%       2.601ms       100.00%     500.235ms      16.675ms            30  
    extension_cpp::sparse_attn        99.36%     497.045ms        99.46%     497.538ms      16.585ms            30  
               aten::new_zeros         0.00%      22.205us         0.09%     449.832us      14.994us            30  
                   aten::zero_         0.01%      26.543us         0.09%     429.004us       7.150us            60  
                   aten::fill_         0.08%     402.461us         0.08%     402.461us      13.415us            30  
                 aten::squeeze         0.01%      54.041us         0.01%      61.749us       0.686us            90  
               aten::unsqueeze         0.01%      29.550us         0.01%      34.961us       1.165us            30  
                   aten::empty         0.01%      30.008us         0.01%      30.008us       0.333us            90  
               aten::new_empty         0.00%       7.710us         0.00%      13.252us       0.442us            30  
              aten::as_strided         0.00%      13.119us         0.00%      13.119us       0.109us           120  
              aten::contiguous         0.00%       3.499us         0.00%       3.499us       0.039us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 500.235ms

2026-02-11 09:48:38,945 - INFO - [33/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=90%
2026-02-11 09:48:39,327 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.11%      13.458ms       100.00%     165.860ms       5.529ms            30  
            aten::matmul         0.08%     134.424us        27.89%      46.251ms     770.846us            60  
               aten::bmm        27.61%      45.801ms        27.66%      45.869ms     764.491us            60  
       aten::masked_fill         0.05%      83.665us        27.19%      45.099ms       1.503ms            30  
           aten::softmax         0.02%      29.457us        23.76%      39.416ms       1.314ms            30  
          aten::_softmax        23.75%      39.386ms        23.75%      39.386ms       1.313ms            30  
      aten::masked_fill_        16.99%      28.179ms        16.99%      28.179ms     939.285us            30  
             aten::clone         0.02%      32.629us        10.15%      16.837ms     561.219us            30  
             aten::copy_        10.13%      16.793ms        10.13%      16.793ms     279.890us            60  
               aten::div         9.79%      16.233ms         9.84%      16.322ms     544.075us            30  
       aten::bitwise_not         3.14%       5.211ms         3.14%       5.211ms     173.684us            30  
           aten::reshape         0.03%      53.918us         0.09%     144.621us       1.205us           120  
                aten::to         0.01%      12.247us         0.05%      89.709us       2.990us            30  
            aten::expand         0.04%      71.548us         0.05%      87.964us       0.733us           120  
          aten::_to_copy         0.02%      28.540us         0.05%      77.462us       2.582us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 165.860ms

2026-02-11 09:48:40,214 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         9.03%      41.739ms       100.00%     462.430ms      15.414ms            30  
                       aten::to_sparse_csr         0.00%      21.543us        37.37%     172.805ms       5.760ms            30  
                      aten::_to_sparse_csr         0.84%       3.889ms        37.36%     172.783ms       5.759ms            30  
                             aten::nonzero        21.68%     100.245ms        21.70%     100.359ms       1.673ms            60  
                            aten::to_dense         0.00%      22.132us        20.55%      95.031ms       3.168ms            30  
                           aten::_to_dense         5.05%      23.336ms        20.55%      95.009ms       3.167ms            30  
                               aten::copy_        17.71%      81.907ms        18.93%      87.526ms     194.501us           450  
                                  aten::ne         5.15%      23.821ms        13.34%      61.709ms       2.057ms            30  
                         aten::masked_fill         0.02%      86.164us        11.22%      51.893ms       1.730ms            30  
                            aten::_to_copy         0.06%     268.334us        10.99%      50.834ms     282.409us           180  
                                  aten::to         0.01%      44.710us         9.63%      44.526ms     371.047us           120  
                             aten::softmax         0.01%      37.000us         9.56%      44.189ms       1.473ms            30  
                            aten::_softmax         9.55%      44.152ms         9.55%      44.152ms       1.472ms            30  
                        aten::masked_fill_         6.68%      30.902ms         6.68%      30.902ms       1.030ms            30  
                               aten::clone         0.03%     120.087us         6.09%      28.157ms     187.714us           150  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 462.430ms

2026-02-11 09:48:40,557 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.92%       1.465ms       100.00%     159.482ms       5.316ms            30  
    extension_cpp::sparse_attn        98.80%     157.569ms        99.04%     157.953ms       5.265ms            30  
               aten::new_zeros         0.01%      14.211us         0.23%     359.417us      11.981us            30  
                   aten::zero_         0.01%      14.413us         0.22%     343.000us       5.717us            60  
                   aten::fill_         0.21%     328.587us         0.21%     328.587us      10.953us            30  
                 aten::squeeze         0.02%      37.118us         0.03%      43.829us       0.487us            90  
               aten::unsqueeze         0.01%      16.837us         0.01%      20.085us       0.670us            30  
                   aten::empty         0.01%      19.541us         0.01%      19.541us       0.217us            90  
              aten::as_strided         0.01%       9.959us         0.01%       9.959us       0.083us           120  
               aten::new_empty         0.00%       4.418us         0.01%       8.332us       0.278us            30  
              aten::contiguous         0.00%       3.000us         0.00%       3.000us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 159.482ms

2026-02-11 09:48:40,560 - INFO - [34/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=95%
2026-02-11 09:48:40,934 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.72%      13.783ms       100.00%     158.138ms       5.271ms            30  
            aten::matmul         0.08%     123.617us        29.38%      46.458ms     774.296us            60  
               aten::bmm        29.11%      46.029ms        29.15%      46.101ms     768.344us            60  
           aten::softmax         0.02%      25.787us        24.58%      38.863ms       1.295ms            30  
          aten::_softmax        24.56%      38.837ms        24.56%      38.837ms       1.295ms            30  
       aten::masked_fill         0.05%      86.499us        23.45%      37.088ms       1.236ms            30  
      aten::masked_fill_        12.73%      20.130ms        12.73%      20.130ms     671.014us            30  
             aten::clone         0.02%      33.250us        10.67%      16.871ms     562.381us            30  
             aten::copy_        10.64%      16.831ms        10.64%      16.831ms     280.520us            60  
               aten::div        10.42%      16.486ms        10.48%      16.578ms     552.587us            30  
       aten::bitwise_not         3.33%       5.264ms         3.33%       5.264ms     175.452us            30  
           aten::reshape         0.03%      53.668us         0.08%     134.126us       1.118us           120  
                aten::to         0.01%      12.251us         0.06%      91.710us       3.057us            30  
            aten::expand         0.04%      69.720us         0.05%      84.631us       0.705us           120  
          aten::_to_copy         0.02%      28.041us         0.05%      79.459us       2.649us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 158.138ms

2026-02-11 09:48:41,644 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         7.62%      24.773ms       100.00%     324.968ms      10.832ms            30  
                       aten::to_sparse_csr         0.00%      15.250us        40.91%     132.955ms       4.432ms            30  
                      aten::_to_sparse_csr         0.68%       2.217ms        40.91%     132.940ms       4.431ms            30  
                             aten::nonzero        22.40%      72.779ms        22.42%      72.870ms       1.215ms            60  
                               aten::copy_        19.39%      63.001ms        20.18%      65.567ms     145.705us           450  
                                  aten::ne         6.23%      20.234ms        16.69%      54.235ms       1.808ms            30  
                            aten::to_dense         0.01%      17.043us        16.17%      52.543ms       1.751ms            30  
                           aten::_to_dense         2.97%       9.666ms        16.16%      52.526ms       1.751ms            30  
                            aten::_to_copy         0.06%     208.039us        12.38%      40.229ms     223.494us           180  
                             aten::softmax         0.01%      27.259us        12.21%      39.692ms       1.323ms            30  
                            aten::_softmax        12.21%      39.665ms        12.21%      39.665ms       1.322ms            30  
                         aten::masked_fill         0.02%      68.624us        11.91%      38.696ms       1.290ms            30  
                                  aten::to         0.01%      36.799us        11.46%      37.248ms     310.403us           120  
                               aten::clone         0.03%      92.959us         6.72%      21.833ms     145.551us           150  
                        aten::masked_fill_         6.24%      20.290ms         6.24%      20.290ms     676.347us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 324.968ms

2026-02-11 09:48:41,853 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.44%     342.921us       100.00%      78.403ms       2.613ms            30  
    extension_cpp::sparse_attn        98.98%      77.600ms        99.48%      77.999ms       2.600ms            30  
               aten::new_zeros         0.02%      14.080us         0.48%     373.249us      12.442us            30  
                   aten::zero_         0.02%      15.913us         0.46%     358.501us       5.975us            60  
                   aten::fill_         0.44%     342.588us         0.44%     342.588us      11.420us            30  
                 aten::squeeze         0.05%      35.872us         0.05%      42.665us       0.474us            90  
                   aten::empty         0.02%      19.078us         0.02%      19.078us       0.212us            90  
               aten::unsqueeze         0.02%      15.412us         0.02%      18.497us       0.617us            30  
              aten::as_strided         0.01%       9.878us         0.01%       9.878us       0.082us           120  
               aten::new_empty         0.01%       4.585us         0.01%       8.376us       0.279us            30  
              aten::contiguous         0.00%       3.081us         0.00%       3.081us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 78.403ms

2026-02-11 09:48:41,856 - INFO - [35/45] Profiling attention with seq_len=2048, d_model=32, n_heads=1, sparsity=99%
2026-02-11 09:48:42,229 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         9.35%      15.480ms       100.00%     165.495ms       5.516ms            30  
            aten::matmul         0.10%     172.637us        31.12%      51.506ms     858.436us            60  
               aten::bmm        30.79%      50.953ms        30.84%      51.031ms     850.523us            60  
           aten::softmax         0.02%      34.585us        25.12%      41.578ms       1.386ms            30  
          aten::_softmax        25.10%      41.543ms        25.10%      41.543ms       1.385ms            30  
       aten::masked_fill         0.06%      99.795us        20.18%      33.404ms       1.113ms            30  
             aten::clone         0.02%      40.542us        10.92%      18.073ms     602.424us            30  
             aten::copy_        10.90%      18.032ms        10.90%      18.032ms     300.532us            60  
               aten::div        10.68%      17.680ms        10.76%      17.806ms     593.530us            30  
      aten::masked_fill_         9.20%      15.231ms         9.20%      15.231ms     507.700us            30  
       aten::bitwise_not         3.37%       5.583ms         3.37%       5.583ms     186.102us            30  
           aten::reshape         0.04%      71.990us         0.10%     171.744us       1.431us           120  
                aten::to         0.01%      15.542us         0.08%     126.001us       4.200us            30  
          aten::_to_copy         0.02%      37.877us         0.07%     110.459us       3.682us            30  
            aten::expand         0.05%      89.045us         0.07%     108.372us       0.903us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 165.495ms

2026-02-11 09:48:42,859 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         6.27%      16.134ms       100.00%     257.292ms       8.576ms            30  
                       aten::to_sparse_csr         0.01%      15.703us        45.62%     117.383ms       3.913ms            30  
                      aten::_to_sparse_csr         0.72%       1.852ms        45.62%     117.368ms       3.912ms            30  
                             aten::nonzero        22.64%      58.255ms        22.67%      58.334ms     972.240us            60  
                               aten::copy_        21.23%      54.629ms        21.56%      55.464ms     123.252us           450  
                                  aten::ne         8.20%      21.087ms        21.31%      54.818ms       1.827ms            30  
                             aten::softmax         0.01%      24.122us        15.59%      40.099ms       1.337ms            30  
                            aten::_softmax        15.58%      40.075ms        15.58%      40.075ms       1.336ms            30  
                            aten::_to_copy         0.07%     186.463us        13.92%      35.807ms     198.927us           180  
                                  aten::to         0.01%      30.208us        13.56%      34.887ms     290.729us           120  
                         aten::masked_fill         0.02%      61.834us        12.65%      32.541ms       1.085ms            30  
                            aten::to_dense         0.01%      17.209us        10.23%      26.320ms     877.338us            30  
                           aten::_to_dense         1.14%       2.935ms        10.22%      26.303ms     876.764us            30  
                               aten::clone         0.03%      77.267us         7.32%      18.847ms     125.644us           150  
                              aten::matmul         0.04%      99.872us         5.87%      15.101ms     503.382us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 257.292ms

2026-02-11 09:48:42,965 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         1.49%     243.344us       100.00%      16.293ms     543.110us            30  
    extension_cpp::sparse_attn        95.76%      15.603ms        98.14%      15.990ms     533.010us            30  
               aten::new_zeros         0.09%      14.334us         2.23%     363.721us      12.124us            30  
                   aten::zero_         0.09%      14.255us         2.13%     347.387us       5.790us            60  
                   aten::fill_         2.04%     333.132us         2.04%     333.132us      11.104us            30  
                 aten::squeeze         0.21%      34.881us         0.25%      40.920us       0.455us            90  
                   aten::empty         0.12%      18.752us         0.12%      18.752us       0.208us            90  
               aten::unsqueeze         0.10%      15.786us         0.12%      18.749us       0.625us            30  
              aten::as_strided         0.06%       9.002us         0.06%       9.002us       0.075us           120  
               aten::new_empty         0.02%       3.963us         0.05%       7.752us       0.258us            30  
              aten::contiguous         0.02%       3.039us         0.02%       3.039us       0.034us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 16.293ms

2026-02-11 09:48:42,967 - INFO - [36/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=50%
2026-02-11 09:48:43,494 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.87%      14.285ms       100.00%     243.155ms       8.105ms            30  
       aten::masked_fill         0.04%      86.509us        45.16%     109.799ms       3.660ms            30  
      aten::masked_fill_        38.18%      92.848ms        38.18%      92.848ms       3.095ms            30  
            aten::matmul         0.06%     139.492us        23.23%      56.474ms     941.237us            60  
               aten::bmm        23.03%      56.000ms        23.06%      56.078ms     934.637us            60  
           aten::softmax         0.01%      29.165us        16.33%      39.702ms       1.323ms            30  
          aten::_softmax        16.32%      39.673ms        16.32%      39.673ms       1.322ms            30  
               aten::div         7.21%      17.532ms         7.25%      17.631ms     587.693us            30  
             aten::clone         0.01%      31.963us         6.94%      16.865ms     562.164us            30  
             aten::copy_         6.92%      16.836ms         6.92%      16.836ms     280.604us            60  
       aten::bitwise_not         2.12%       5.151ms         2.12%       5.151ms     171.706us            30  
           aten::reshape         0.02%      57.928us         0.06%     142.757us       1.190us           120  
                aten::to         0.00%      12.086us         0.04%      98.627us       3.288us            30  
            aten::expand         0.03%      80.096us         0.04%      96.424us       0.804us           120  
          aten::_to_copy         0.01%      29.374us         0.04%      86.541us       2.885us            30  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 243.155ms

2026-02-11 09:48:45,409 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.00%      41.461ms       100.00%        1.037s      34.580ms            30  
                       aten::to_sparse_csr         0.00%      20.040us        31.16%     323.299ms      10.777ms            30  
                      aten::_to_sparse_csr         0.58%       6.018ms        31.16%     323.279ms      10.776ms            30  
                            aten::to_dense         0.00%      26.667us        26.91%     279.195ms       9.307ms            30  
                           aten::_to_dense         2.88%      29.897ms        26.91%     279.169ms       9.306ms            30  
                             aten::nonzero        22.14%     229.697ms        22.15%     229.819ms       3.830ms            60  
                               aten::copy_        15.08%     156.466ms        17.59%     182.487ms     405.526us           450  
                aten::sparse_sampled_addmm        12.47%     129.365ms        15.02%     155.809ms       5.194ms            30  
                         aten::masked_fill         0.01%     107.119us        10.96%     113.652ms       3.788ms            30  
                                 aten::mul         7.90%      81.982ms        10.63%     110.275ms     459.479us           240  
                        aten::masked_fill_         9.22%      95.619ms         9.22%      95.619ms       3.187ms            30  
                            aten::_to_copy         0.03%     309.923us         8.60%      89.266ms     495.921us           180  
                                  aten::to         0.01%      57.251us         5.98%      62.043ms     517.027us           120  
                                  aten::ne         1.96%      20.298ms         5.27%      54.704ms       1.823ms            30  
    aten::_convert_indices_from_csr_to_coo         3.12%      32.340ms         4.91%      50.955ms       1.699ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.037s

2026-02-11 09:48:47,753 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.32%       4.337ms       100.00%        1.356s      45.210ms            30  
    extension_cpp::sparse_attn        99.60%        1.351s        99.67%        1.352s      45.060ms            30  
               aten::new_zeros         0.00%      44.165us         0.06%     845.084us      28.169us            30  
                   aten::zero_         0.00%      58.628us         0.06%     813.796us      13.563us            60  
                   aten::fill_         0.06%     755.168us         0.06%     755.168us      25.172us            30  
                 aten::squeeze         0.01%      75.954us         0.01%      84.625us       0.940us            90  
               aten::unsqueeze         0.00%      63.500us         0.01%      79.002us       2.633us            30  
                   aten::empty         0.00%      61.291us         0.00%      61.291us       0.681us            90  
              aten::as_strided         0.00%      24.173us         0.00%      24.173us       0.201us           120  
               aten::new_empty         0.00%      14.293us         0.00%      22.710us       0.757us            30  
              aten::contiguous         0.00%       4.999us         0.00%       4.999us       0.056us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.356s

2026-02-11 09:48:47,756 - INFO - [37/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=70%
2026-02-11 09:48:48,237 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.46%      14.002ms       100.00%     216.706ms       7.224ms            30  
       aten::masked_fill         0.04%      95.418us        36.26%      78.569ms       2.619ms            30  
      aten::masked_fill_        28.14%      60.991ms        28.14%      60.991ms       2.033ms            30  
            aten::matmul         0.08%     173.372us        27.44%      59.462ms     991.038us            60  
               aten::bmm        27.18%      58.899ms        27.22%      58.982ms     983.037us            60  
           aten::softmax         0.02%      42.627us        18.62%      40.349ms       1.345ms            30  
          aten::_softmax        18.60%      40.306ms        18.60%      40.306ms       1.344ms            30  
               aten::div         8.65%      18.745ms         8.71%      18.878ms     629.278us            30  
             aten::clone         0.02%      46.626us         8.07%      17.483ms     582.775us            30  
             aten::copy_         8.05%      17.441ms         8.05%      17.441ms     290.686us            60  
       aten::bitwise_not         2.45%       5.304ms         2.45%       5.304ms     176.798us            30  
           aten::reshape         0.03%      71.959us         0.08%     179.043us       1.492us           120  
                aten::to         0.01%      17.160us         0.06%     133.040us       4.435us            30  
          aten::_to_copy         0.02%      41.089us         0.05%     115.880us       3.863us            30  
            aten::expand         0.04%      92.184us         0.05%     108.384us       0.903us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 216.706ms

2026-02-11 09:48:49,643 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         5.19%      38.911ms       100.00%     749.107ms      24.970ms            30  
                       aten::to_sparse_csr         0.00%      22.080us        33.99%     254.629ms       8.488ms            30  
                      aten::_to_sparse_csr         0.84%       6.316ms        33.99%     254.607ms       8.487ms            30  
                            aten::to_dense         0.00%      20.543us        24.73%     185.274ms       6.176ms            30  
                           aten::_to_dense         3.85%      28.813ms        24.73%     185.254ms       6.175ms            30  
                             aten::nonzero        23.27%     174.317ms        23.29%     174.432ms       2.907ms            60  
                               aten::copy_        15.38%     115.195ms        17.42%     130.465ms     289.923us           450  
                aten::sparse_sampled_addmm         9.87%      73.928ms        11.96%      89.589ms       2.986ms            30  
                         aten::masked_fill         0.01%      98.084us        10.51%      78.733ms       2.624ms            30  
                            aten::_to_copy         0.04%     297.165us         9.01%      67.507ms     375.039us           180  
                                 aten::mul         6.62%      49.577ms         8.90%      66.666ms     277.776us           240  
                        aten::masked_fill_         8.07%      60.485ms         8.07%      60.485ms       2.016ms            30  
                                  aten::ne         2.68%      20.056ms         7.26%      54.376ms       1.813ms            30  
                                  aten::to         0.01%      53.297us         6.82%      51.097ms     425.811us           120  
                             aten::softmax         0.00%      37.128us         5.31%      39.787ms       1.326ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 749.107ms

2026-02-11 09:48:51,115 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.46%       3.812ms       100.00%     832.184ms      27.739ms            30  
    extension_cpp::sparse_attn        99.43%     827.435ms        99.53%     828.250ms      27.608ms            30  
               aten::new_zeros         0.00%      39.079us         0.09%     739.417us      24.647us            30  
                   aten::zero_         0.01%      47.376us         0.09%     708.083us      11.801us            60  
                   aten::fill_         0.08%     660.707us         0.08%     660.707us      22.024us            30  
                 aten::squeeze         0.01%      59.410us         0.01%      67.579us       0.751us            90  
               aten::unsqueeze         0.01%      44.331us         0.01%      54.124us       1.804us            30  
                   aten::empty         0.01%      52.293us         0.01%      52.293us       0.581us            90  
               aten::new_empty         0.00%      11.420us         0.00%      18.796us       0.627us            30  
              aten::as_strided         0.00%      17.962us         0.00%      17.962us       0.150us           120  
              aten::contiguous         0.00%       4.417us         0.00%       4.417us       0.049us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 832.184ms

2026-02-11 09:48:51,118 - INFO - [38/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=90%
2026-02-11 09:48:51,531 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.97%      10.664ms       100.00%     178.507ms       5.950ms            30  
            aten::matmul         0.07%     126.269us        33.86%      60.448ms       1.007ms            60  
               aten::bmm        33.64%      60.043ms        33.67%      60.108ms       1.002ms            60  
       aten::masked_fill         0.05%      92.635us        25.28%      45.124ms       1.504ms            30  
           aten::softmax         0.02%      29.124us        21.98%      39.227ms       1.308ms            30  
          aten::_softmax        21.96%      39.198ms        21.96%      39.198ms       1.307ms            30  
      aten::masked_fill_        15.71%      28.037ms        15.71%      28.037ms     934.564us            30  
               aten::div         9.91%      17.697ms         9.97%      17.788ms     592.946us            30  
             aten::clone         0.02%      35.329us         9.52%      16.994ms     566.468us            30  
             aten::copy_         9.50%      16.952ms         9.50%      16.952ms     282.539us            60  
       aten::bitwise_not         2.89%       5.158ms         2.89%       5.158ms     171.931us            30  
           aten::reshape         0.03%      54.329us         0.07%     122.117us       1.018us           120  
                aten::to         0.01%      12.587us         0.05%      91.376us       3.046us            30  
          aten::_to_copy         0.02%      27.995us         0.04%      78.789us       2.626us            30  
            aten::expand         0.04%      64.084us         0.04%      78.123us       0.651us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 178.507ms

2026-02-11 09:48:52,407 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         7.46%      31.803ms       100.00%     426.394ms      14.213ms            30  
                       aten::to_sparse_csr         0.00%      18.710us        37.46%     159.708ms       5.324ms            30  
                      aten::_to_sparse_csr         0.81%       3.449ms        37.45%     159.689ms       5.323ms            30  
                             aten::nonzero        21.92%      93.463ms        21.95%      93.572ms       1.560ms            60  
                               aten::copy_        17.51%      74.646ms        18.71%      79.767ms     177.259us           450  
                            aten::to_dense         0.00%      19.292us        18.29%      77.991ms       2.600ms            30  
                           aten::_to_dense         3.10%      13.214ms        18.29%      77.971ms       2.599ms            30  
                                  aten::ne         4.90%      20.893ms        13.03%      55.571ms       1.852ms            30  
                         aten::masked_fill         0.02%      84.171us        11.31%      48.242ms       1.608ms            30  
                            aten::_to_copy         0.06%     248.912us        10.95%      46.678ms     259.320us           180  
                                  aten::to         0.01%      44.924us         9.58%      40.834ms     340.286us           120  
                             aten::softmax         0.01%      32.502us         9.33%      39.779ms       1.326ms            30  
                            aten::_softmax         9.32%      39.747ms         9.32%      39.747ms       1.325ms            30  
                        aten::masked_fill_         6.82%      29.075ms         6.82%      29.075ms     969.171us            30  
                aten::sparse_sampled_addmm         5.36%      22.861ms         6.64%      28.323ms     944.097us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 426.394ms

2026-02-11 09:48:52,941 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.18%     471.205us       100.00%     268.844ms       8.961ms            30  
    extension_cpp::sparse_attn        99.64%     267.879ms        99.80%     268.302ms       8.943ms            30  
               aten::new_zeros         0.01%      15.039us         0.15%     391.419us      13.047us            30  
                   aten::zero_         0.01%      15.547us         0.14%     374.922us       6.249us            60  
                   aten::fill_         0.13%     359.375us         0.13%     359.375us      11.979us            30  
                 aten::squeeze         0.01%      39.928us         0.02%      47.336us       0.526us            90  
                   aten::empty         0.01%      24.703us         0.01%      24.703us       0.274us            90  
               aten::unsqueeze         0.01%      19.292us         0.01%      23.292us       0.776us            30  
              aten::as_strided         0.00%      11.408us         0.00%      11.408us       0.095us           120  
               aten::new_empty         0.00%       4.459us         0.00%       8.293us       0.276us            30  
              aten::contiguous         0.00%       3.502us         0.00%       3.502us       0.039us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 268.844ms

2026-02-11 09:48:52,944 - INFO - [39/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=95%
2026-02-11 09:48:53,344 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.24%      14.361ms       100.00%     174.246ms       5.808ms            30  
            aten::matmul         0.09%     149.169us        34.36%      59.865ms     997.753us            60  
               aten::bmm        34.07%      59.371ms        34.12%      59.446ms     990.759us            60  
           aten::softmax         0.02%      30.541us        22.65%      39.473ms       1.316ms            30  
          aten::_softmax        22.64%      39.443ms        22.64%      39.443ms       1.315ms            30  
       aten::masked_fill         0.05%      92.043us        21.54%      37.536ms       1.251ms            30  
      aten::masked_fill_        11.64%      20.277ms        11.64%      20.277ms     675.891us            30  
               aten::div        10.09%      17.581ms        10.16%      17.695ms     589.838us            30  
             aten::clone         0.02%      37.247us         9.85%      17.167ms     572.239us            30  
             aten::copy_         9.83%      17.128ms         9.83%      17.128ms     285.461us            60  
       aten::bitwise_not         2.98%       5.196ms         2.98%       5.196ms     173.216us            30  
           aten::reshape         0.04%      64.575us         0.09%     156.578us       1.305us           120  
                aten::to         0.01%      14.877us         0.07%     114.000us       3.800us            30  
          aten::_to_copy         0.02%      34.908us         0.06%      99.123us       3.304us            30  
            aten::expand         0.05%      78.881us         0.05%      95.337us       0.794us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 174.246ms

2026-02-11 09:48:54,079 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         8.29%      28.376ms       100.00%     342.356ms      11.412ms            30  
                       aten::to_sparse_csr         0.00%      16.335us        38.45%     131.619ms       4.387ms            30  
                      aten::_to_sparse_csr         0.53%       1.819ms        38.44%     131.603ms       4.387ms            30  
                             aten::nonzero        21.16%      72.445ms        21.19%      72.529ms       1.209ms            60  
                               aten::copy_        18.17%      62.211ms        18.89%      64.685ms     143.744us           450  
                            aten::to_dense         0.01%      19.003us        16.32%      55.876ms       1.863ms            30  
                           aten::_to_dense         3.78%      12.927ms        16.32%      55.857ms       1.862ms            30  
                                  aten::ne         5.85%      20.036ms        15.69%      53.716ms       1.791ms            30  
                            aten::_to_copy         0.06%     211.547us        11.61%      39.760ms     220.887us           180  
                             aten::softmax         0.01%      22.622us        11.45%      39.212ms       1.307ms            30  
                            aten::_softmax        11.45%      39.189ms        11.45%      39.189ms       1.306ms            30  
                         aten::masked_fill         0.02%      68.792us        11.19%      38.313ms       1.277ms            30  
                                  aten::to         0.01%      36.418us        10.76%      36.855ms     307.121us           120  
                              aten::matmul         0.03%     107.498us         6.95%      23.782ms     792.718us            30  
                                 aten::bmm         6.85%      23.468ms         6.87%      23.507ms     783.573us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 342.356ms

2026-02-11 09:48:54,382 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.25%     341.748us       100.00%     135.569ms       4.519ms            30  
    extension_cpp::sparse_attn        99.40%     134.751ms        99.70%     135.165ms       4.505ms            30  
               aten::new_zeros         0.01%      14.584us         0.29%     388.547us      12.952us            30  
                   aten::zero_         0.01%      14.415us         0.27%     372.375us       6.206us            60  
                   aten::fill_         0.26%     357.960us         0.26%     357.960us      11.932us            30  
                 aten::squeeze         0.03%      36.135us         0.03%      42.756us       0.475us            90  
               aten::unsqueeze         0.01%      16.335us         0.01%      19.667us       0.656us            30  
                   aten::empty         0.01%      19.655us         0.01%      19.655us       0.218us            90  
              aten::as_strided         0.01%       9.953us         0.01%       9.953us       0.083us           120  
               aten::new_empty         0.00%       3.709us         0.01%       7.877us       0.263us            30  
              aten::contiguous         0.00%       3.250us         0.00%       3.250us       0.036us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 135.569ms

2026-02-11 09:48:54,385 - INFO - [40/45] Profiling attention with seq_len=2048, d_model=64, n_heads=1, sparsity=99%
2026-02-11 09:48:54,765 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         8.93%      15.102ms       100.00%     169.165ms       5.639ms            30  
            aten::matmul         0.07%     124.929us        35.70%      60.396ms       1.007ms            60  
               aten::bmm        35.46%      59.981ms        35.50%      60.048ms       1.001ms            60  
           aten::softmax         0.02%      28.498us        23.20%      39.239ms       1.308ms            30  
          aten::_softmax        23.18%      39.211ms        23.18%      39.211ms       1.307ms            30  
       aten::masked_fill         0.05%      85.954us        18.55%      31.373ms       1.046ms            30  
               aten::div        10.33%      17.474ms        10.39%      17.573ms     585.754us            30  
             aten::clone         0.02%      35.548us         9.99%      16.906ms     563.530us            30  
             aten::copy_         9.97%      16.869ms         9.97%      16.869ms     281.144us            60  
      aten::masked_fill_         8.50%      14.381ms         8.50%      14.381ms     479.372us            30  
       aten::bitwise_not         3.18%       5.376ms         3.18%       5.376ms     179.205us            30  
           aten::reshape         0.03%      51.911us         0.08%     127.789us       1.065us           120  
                aten::to         0.01%      13.791us         0.06%      99.040us       3.301us            30  
          aten::_to_copy         0.02%      29.457us         0.05%      85.249us       2.842us            30  
            aten::expand         0.04%      65.076us         0.05%      79.245us       0.660us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 169.165ms

2026-02-11 09:48:55,385 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         8.20%      22.533ms       100.00%     274.770ms       9.159ms            30  
                       aten::to_sparse_csr         0.01%      18.082us        43.17%     118.619ms       3.954ms            30  
                      aten::_to_sparse_csr         0.50%       1.372ms        43.16%     118.601ms       3.953ms            30  
                             aten::nonzero        21.74%      59.741ms        21.77%      59.830ms     997.160us            60  
                               aten::copy_        19.88%      54.628ms        20.19%      55.465ms     123.255us           450  
                                  aten::ne         7.72%      21.207ms        19.98%      54.890ms       1.830ms            30  
                             aten::softmax         0.01%      31.543us        14.86%      40.828ms       1.361ms            30  
                            aten::_softmax        14.85%      40.796ms        14.85%      40.796ms       1.360ms            30  
                            aten::_to_copy         0.07%     204.203us        13.02%      35.772ms     198.731us           180  
                                  aten::to         0.01%      35.464us        12.68%      34.853ms     290.439us           120  
                         aten::masked_fill         0.03%      72.961us        11.86%      32.580ms       1.086ms            30  
                            aten::to_dense         0.01%      17.873us        10.03%      27.558ms     918.591us            30  
                           aten::_to_dense         1.34%       3.692ms        10.02%      27.540ms     917.995us            30  
                              aten::matmul         0.04%     110.167us         7.85%      21.557ms     718.565us            30  
                                 aten::bmm         7.73%      21.227ms         7.74%      21.267ms     708.907us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 274.770ms

2026-02-11 09:48:55,507 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.85%     225.713us       100.00%      26.509ms     883.639us            30  
    extension_cpp::sparse_attn        97.21%      25.771ms        98.93%      26.224ms     874.143us            30  
               aten::new_zeros         0.05%      13.837us         1.62%     430.088us      14.336us            30  
                   aten::zero_         0.05%      13.088us         1.56%     414.545us       6.909us            60  
                   aten::fill_         1.51%     401.457us         1.51%     401.457us      13.382us            30  
                 aten::squeeze         0.13%      34.406us         0.16%      41.203us       0.458us            90  
                   aten::empty         0.07%      18.456us         0.07%      18.456us       0.205us            90  
               aten::unsqueeze         0.06%      15.248us         0.07%      17.957us       0.599us            30  
              aten::as_strided         0.04%       9.506us         0.04%       9.506us       0.079us           120  
               aten::new_empty         0.01%       3.626us         0.03%       7.957us       0.265us            30  
              aten::contiguous         0.01%       2.957us         0.01%       2.957us       0.033us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 26.509ms

2026-02-11 09:48:55,509 - INFO - [41/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=50%
2026-02-11 09:48:56,080 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.39%      17.287ms       100.00%     270.372ms       9.012ms            30  
       aten::masked_fill         0.03%      82.124us        40.79%     110.287ms       3.676ms            30  
      aten::masked_fill_        34.38%      92.964ms        34.38%      92.964ms       3.099ms            30  
            aten::matmul         0.05%     145.132us        29.78%      80.520ms       1.342ms            60  
               aten::bmm        29.60%      80.040ms        29.63%      80.110ms       1.335ms            60  
           aten::softmax         0.01%      30.584us        14.52%      39.257ms       1.309ms            30  
          aten::_softmax        14.51%      39.226ms        14.51%      39.226ms       1.308ms            30  
               aten::div         6.56%      17.724ms         6.60%      17.839ms     594.620us            30  
             aten::clone         0.01%      36.002us         6.38%      17.241ms     574.698us            30  
             aten::copy_         6.37%      17.210ms         6.37%      17.210ms     286.832us            60  
       aten::bitwise_not         1.87%       5.061ms         1.87%       5.061ms     168.709us            30  
           aten::reshape         0.02%      64.947us         0.06%     152.576us       1.271us           120  
                aten::to         0.01%      14.085us         0.04%     114.543us       3.818us            30  
          aten::_to_copy         0.01%      35.119us         0.04%     100.458us       3.349us            30  
            aten::expand         0.03%      81.177us         0.04%      96.005us       0.800us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 270.372ms

2026-02-11 09:48:58,200 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         3.77%      43.939ms       100.00%        1.165s      38.839ms            30  
                       aten::to_sparse_csr         0.00%      20.085us        27.82%     324.150ms      10.805ms            30  
                      aten::_to_sparse_csr         0.59%       6.852ms        27.82%     324.130ms      10.804ms            30  
                            aten::to_dense         0.00%      23.129us        24.27%     282.737ms       9.425ms            30  
                           aten::_to_dense         2.69%      31.375ms        24.26%     282.714ms       9.424ms            30  
                aten::sparse_sampled_addmm        20.72%     241.433ms        22.97%     267.637ms       8.921ms            30  
                             aten::nonzero        19.72%     229.781ms        19.73%     229.895ms       3.832ms            60  
                               aten::copy_        13.35%     155.557ms        15.56%     181.352ms     403.004us           450  
                         aten::masked_fill         0.01%     105.537us         9.73%     113.381ms       3.779ms            30  
                                 aten::mul         7.10%      82.766ms         9.51%     110.797ms     461.654us           240  
                        aten::masked_fill_         8.19%      95.435ms         8.19%      95.435ms       3.181ms            30  
                            aten::_to_copy         0.03%     312.128us         7.60%      88.553ms     491.963us           180  
                                  aten::to         0.01%      59.366us         5.28%      61.478ms     512.313us           120  
                                  aten::ne         1.72%      20.047ms         4.64%      54.039ms       1.801ms            30  
                               aten::clone         0.01%     143.175us         4.33%      50.470ms     336.465us           150  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.165s

2026-02-11 09:49:02,964 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.10%       2.714ms       100.00%        2.810s      93.664ms            30  
    extension_cpp::sparse_attn        99.85%        2.806s        99.90%        2.807s      93.566ms            30  
               aten::new_zeros         0.00%      55.958us         0.04%       1.131ms      37.690us            30  
                   aten::zero_         0.00%      73.457us         0.04%       1.088ms      18.137us            60  
                   aten::fill_         0.04%       1.015ms         0.04%       1.015ms      33.825us            30  
               aten::unsqueeze         0.00%      99.792us         0.00%     122.084us       4.069us            30  
                 aten::squeeze         0.00%      88.665us         0.00%      98.913us       1.099us            90  
                   aten::empty         0.00%      94.584us         0.00%      94.584us       1.051us            90  
              aten::as_strided         0.00%      32.540us         0.00%      32.540us       0.271us           120  
               aten::new_empty         0.00%      18.458us         0.00%      31.000us       1.033us            30  
              aten::contiguous         0.00%       8.332us         0.00%       8.332us       0.093us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.810s

2026-02-11 09:49:02,967 - INFO - [42/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=70%
2026-02-11 09:49:03,492 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         5.32%      12.887ms       100.00%     242.190ms       8.073ms            30  
            aten::matmul         0.07%     163.468us        35.44%      85.834ms       1.431ms            60  
               aten::bmm        35.22%      85.310ms        35.26%      85.390ms       1.423ms            60  
       aten::masked_fill         0.04%      96.874us        32.58%      78.905ms       2.630ms            30  
      aten::masked_fill_        25.29%      61.259ms        25.29%      61.259ms       2.042ms            30  
           aten::softmax         0.01%      34.462us        17.07%      41.337ms       1.378ms            30  
          aten::_softmax        17.05%      41.303ms        17.05%      41.303ms       1.377ms            30  
               aten::div         7.34%      17.779ms         7.40%      17.914ms     597.138us            30  
             aten::clone         0.02%      39.796us         7.25%      17.549ms     584.968us            30  
             aten::copy_         7.23%      17.511ms         7.23%      17.511ms     291.856us            60  
       aten::bitwise_not         2.14%       5.186ms         2.14%       5.186ms     172.875us            30  
           aten::reshape         0.03%      65.829us         0.06%     156.456us       1.304us           120  
                aten::to         0.01%      16.498us         0.06%     135.289us       4.510us            30  
          aten::_to_copy         0.02%      41.918us         0.05%     118.791us       3.960us            30  
            aten::expand         0.04%      85.996us         0.04%     104.868us       0.874us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 242.190ms

2026-02-11 09:49:05,018 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         4.72%      38.763ms       100.00%     820.753ms      27.358ms            30  
                       aten::to_sparse_csr         0.00%      25.254us        31.00%     254.434ms       8.481ms            30  
                      aten::_to_sparse_csr         0.90%       7.396ms        31.00%     254.409ms       8.480ms            30  
                            aten::to_dense         0.00%      24.286us        22.41%     183.959ms       6.132ms            30  
                           aten::_to_dense         3.60%      29.563ms        22.41%     183.935ms       6.131ms            30  
                             aten::nonzero        21.09%     173.129ms        21.11%     173.244ms       2.887ms            60  
                aten::sparse_sampled_addmm        16.79%     137.814ms        18.67%     153.222ms       5.107ms            30  
                               aten::copy_        13.87%     113.825ms        15.70%     128.839ms     286.308us           450  
                         aten::masked_fill         0.01%      96.798us         9.53%      78.241ms       2.608ms            30  
                            aten::_to_copy         0.04%     292.118us         8.15%      66.869ms     371.497us           180  
                                 aten::mul         5.98%      49.089ms         8.07%      66.215ms     275.895us           240  
                        aten::masked_fill_         7.33%      60.133ms         7.33%      60.133ms       2.004ms            30  
                                  aten::ne         2.41%      19.820ms         6.57%      53.925ms       1.797ms            30  
                                  aten::to         0.01%      50.885us         6.17%      50.676ms     422.298us           120  
                             aten::softmax         0.00%      33.787us         4.84%      39.688ms       1.323ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 820.753ms

2026-02-11 09:49:07,934 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.27%       4.632ms       100.00%        1.697s      56.569ms            30  
    extension_cpp::sparse_attn        99.65%        1.691s        99.72%        1.692s      56.409ms            30  
               aten::new_zeros         0.00%      49.250us         0.06%       1.016ms      33.871us            30  
                   aten::zero_         0.00%      67.546us         0.06%     982.972us      16.383us            60  
                   aten::fill_         0.05%     915.426us         0.05%     915.426us      30.514us            30  
               aten::unsqueeze         0.00%      69.832us         0.01%      85.334us       2.844us            30  
                 aten::squeeze         0.00%      73.537us         0.00%      83.294us       0.925us            90  
                   aten::empty         0.00%      71.713us         0.00%      71.713us       0.797us            90  
              aten::as_strided         0.00%      25.259us         0.00%      25.259us       0.210us           120  
               aten::new_empty         0.00%      12.999us         0.00%      22.377us       0.746us            30  
              aten::contiguous         0.00%       5.829us         0.00%       5.829us       0.065us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.697s

2026-02-11 09:49:07,937 - INFO - [43/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=90%
2026-02-11 09:49:08,396 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.89%      14.303ms       100.00%     207.586ms       6.920ms            30  
            aten::matmul         0.08%     165.220us        39.82%      82.668ms       1.378ms            60  
               aten::bmm        39.57%      82.136ms        39.60%      82.213ms       1.370ms            60  
       aten::masked_fill         0.05%      95.838us        22.30%      46.300ms       1.543ms            30  
           aten::softmax         0.02%      38.212us        19.72%      40.935ms       1.364ms            30  
          aten::_softmax        19.70%      40.896ms        19.70%      40.896ms       1.363ms            30  
      aten::masked_fill_        13.90%      28.853ms        13.90%      28.853ms     961.771us            30  
               aten::div         8.66%      17.969ms         8.72%      18.098ms     603.270us            30  
             aten::clone         0.02%      43.454us         8.36%      17.351ms     578.370us            30  
             aten::copy_         8.34%      17.312ms         8.34%      17.312ms     288.536us            60  
       aten::bitwise_not         2.48%       5.149ms         2.48%       5.149ms     171.637us            30  
           aten::reshape         0.03%      68.450us         0.08%     161.867us       1.349us           120  
                aten::to         0.01%      15.081us         0.06%     128.666us       4.289us            30  
          aten::_to_copy         0.02%      41.001us         0.05%     113.585us       3.786us            30  
            aten::expand         0.04%      89.041us         0.05%     105.960us       0.883us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 207.586ms

2026-02-11 09:49:09,317 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         6.68%      30.443ms       100.00%     455.692ms      15.190ms            30  
                       aten::to_sparse_csr         0.00%      20.413us        34.95%     159.257ms       5.309ms            30  
                      aten::_to_sparse_csr         0.73%       3.347ms        34.94%     159.237ms       5.308ms            30  
                             aten::nonzero        20.63%      94.020ms        20.66%      94.123ms       1.569ms            60  
                               aten::copy_        16.28%      74.168ms        17.39%      79.227ms     176.061us           450  
                            aten::to_dense         0.00%      19.245us        17.22%      78.476ms       2.616ms            30  
                           aten::_to_dense         3.02%      13.761ms        17.22%      78.457ms       2.615ms            30  
                                  aten::ne         4.55%      20.739ms        12.11%      55.184ms       1.839ms            30  
                aten::sparse_sampled_addmm         9.65%      43.952ms        10.83%      49.349ms       1.645ms            30  
                         aten::masked_fill         0.02%      77.869us        10.40%      47.382ms       1.579ms            30  
                            aten::_to_copy         0.05%     244.348us        10.19%      46.413ms     257.848us           180  
                                  aten::to         0.01%      50.998us         8.91%      40.593ms     338.271us           120  
                             aten::softmax         0.01%      31.334us         8.78%      40.001ms       1.333ms            30  
                            aten::_softmax         8.77%      39.969ms         8.77%      39.969ms       1.332ms            30  
                              aten::matmul         0.03%     118.660us         7.47%      34.039ms       1.135ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 455.692ms

2026-02-11 09:49:10,325 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.10%     562.497us       100.00%     559.502ms      18.650ms            30  
    extension_cpp::sparse_attn        99.76%     558.140ms        99.88%     558.840ms      18.628ms            30  
               aten::new_zeros         0.00%      25.044us         0.12%     649.296us      21.643us            30  
                   aten::zero_         0.01%      28.582us         0.11%     626.087us      10.435us            60  
                   aten::fill_         0.11%     597.505us         0.11%     597.505us      19.917us            30  
                 aten::squeeze         0.01%      51.251us         0.01%      59.418us       0.660us            90  
               aten::unsqueeze         0.01%      33.542us         0.01%      40.084us       1.336us            30  
                   aten::empty         0.01%      37.460us         0.01%      37.460us       0.416us            90  
              aten::as_strided         0.00%      14.709us         0.00%      14.709us       0.123us           120  
               aten::new_empty         0.00%       8.328us         0.00%      14.331us       0.478us            30  
              aten::contiguous         0.00%       3.377us         0.00%       3.377us       0.038us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 559.502ms

2026-02-11 09:49:10,328 - INFO - [44/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=95%
2026-02-11 09:49:10,786 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*        11.07%      24.003ms       100.00%     216.926ms       7.231ms            30  
            aten::matmul         0.07%     155.806us        43.00%      93.268ms       1.554ms            60  
               aten::bmm        42.76%      92.753ms        42.79%      92.830ms       1.547ms            60  
           aten::softmax         0.01%      30.707us        18.13%      39.336ms       1.311ms            30  
          aten::_softmax        18.12%      39.306ms        18.12%      39.306ms       1.310ms            30  
       aten::masked_fill         0.05%      98.751us        17.18%      37.265ms       1.242ms            30  
      aten::masked_fill_         9.28%      20.120ms         9.28%      20.120ms     670.679us            30  
               aten::div         8.14%      17.653ms         8.20%      17.788ms     592.932us            30  
             aten::clone         0.02%      38.539us         7.86%      17.046ms     568.201us            30  
             aten::copy_         7.84%      17.017ms         7.84%      17.017ms     283.623us            60  
       aten::bitwise_not         2.37%       5.131ms         2.37%       5.131ms     171.045us            30  
           aten::reshape         0.03%      66.630us         0.07%     161.954us       1.350us           120  
                aten::to         0.01%      16.500us         0.06%     134.877us       4.496us            30  
          aten::_to_copy         0.02%      43.624us         0.05%     118.377us       3.946us            30  
            aten::expand         0.04%      82.700us         0.05%      97.660us       0.814us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 216.926ms

2026-02-11 09:49:11,565 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         7.85%      29.397ms       100.00%     374.354ms      12.478ms            30  
                       aten::to_sparse_csr         0.01%      20.166us        36.83%     137.860ms       4.595ms            30  
                      aten::_to_sparse_csr         1.13%       4.248ms        36.82%     137.839ms       4.595ms            30  
                             aten::nonzero        19.90%      74.511ms        19.93%      74.612ms       1.244ms            60  
                               aten::copy_        16.88%      63.182ms        17.59%      65.831ms     146.291us           450  
                            aten::to_dense         0.00%      17.872us        15.44%      57.795ms       1.926ms            30  
                           aten::_to_dense         3.73%      13.979ms        15.43%      57.777ms       1.926ms            30  
                                  aten::ne         5.62%      21.037ms        14.75%      55.209ms       1.840ms            30  
                            aten::_to_copy         0.06%     232.421us        10.76%      40.298ms     223.876us           180  
                             aten::softmax         0.01%      35.709us        10.67%      39.960ms       1.332ms            30  
                            aten::_softmax        10.66%      39.924ms        10.66%      39.924ms       1.331ms            30  
                         aten::masked_fill         0.02%      82.669us        10.41%      38.981ms       1.299ms            30  
                                  aten::to         0.01%      44.218us         9.99%      37.389ms     311.577us           120  
                              aten::matmul         0.03%     129.127us         9.17%      34.317ms       1.144ms            30  
                                 aten::bmm         9.07%      33.943ms         9.08%      33.985ms       1.133ms            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 374.354ms

2026-02-11 09:49:12,103 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.11%     309.247us       100.00%     276.631ms       9.221ms            30  
    extension_cpp::sparse_attn        99.66%     275.694ms        99.86%     276.252ms       9.208ms            30  
               aten::new_zeros         0.01%      17.497us         0.19%     521.000us      17.367us            30  
                   aten::zero_         0.01%      22.457us         0.18%     505.375us       8.423us            60  
                   aten::fill_         0.17%     482.918us         0.17%     482.918us      16.097us            30  
                 aten::squeeze         0.01%      40.003us         0.02%      46.835us       0.520us            90  
                   aten::empty         0.01%      27.206us         0.01%      27.206us       0.302us            90  
               aten::unsqueeze         0.01%      19.208us         0.01%      23.333us       0.778us            30  
              aten::as_strided         0.00%      10.957us         0.00%      10.957us       0.091us           120  
               aten::new_empty         0.00%       4.707us         0.00%       9.417us       0.314us            30  
              aten::contiguous         0.00%       3.576us         0.00%       3.576us       0.040us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 276.631ms

2026-02-11 09:49:12,106 - INFO - [45/45] Profiling attention with seq_len=2048, d_model=128, n_heads=1, sparsity=99%
2026-02-11 09:49:12,531 - INFO - ------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
           ProfilerStep*         6.90%      13.173ms       100.00%     190.949ms       6.365ms            30  
            aten::matmul         0.08%     150.050us        43.65%      83.341ms       1.389ms            60  
               aten::bmm        43.39%      82.850ms        43.43%      82.929ms       1.382ms            60  
           aten::softmax         0.01%      27.872us        20.73%      39.593ms       1.320ms            30  
          aten::_softmax        20.72%      39.565ms        20.72%      39.565ms       1.319ms            30  
       aten::masked_fill         0.05%      89.038us        16.64%      31.782ms       1.059ms            30  
               aten::div         9.31%      17.771ms         9.37%      17.886ms     596.201us            30  
             aten::clone         0.02%      36.960us         9.03%      17.251ms     575.041us            30  
             aten::copy_         9.02%      17.219ms         9.02%      17.219ms     286.978us            60  
      aten::masked_fill_         7.56%      14.442ms         7.56%      14.442ms     481.385us            30  
       aten::bitwise_not         2.65%       5.056ms         2.65%       5.056ms     168.534us            30  
           aten::reshape         0.03%      58.961us         0.08%     149.629us       1.247us           120  
                aten::to         0.01%      14.170us         0.06%     115.461us       3.849us            30  
          aten::_to_copy         0.02%      35.373us         0.05%     101.291us       3.376us            30  
            aten::expand         0.04%      79.865us         0.05%      95.201us       0.793us           120  
------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 190.949ms

2026-02-11 09:49:13,166 - INFO - ------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                             ProfilerStep*         7.44%      20.968ms       100.00%     281.732ms       9.391ms            30  
                       aten::to_sparse_csr         0.01%      15.788us        41.49%     116.899ms       3.897ms            30  
                      aten::_to_sparse_csr         0.75%       2.114ms        41.49%     116.883ms       3.896ms            30  
                             aten::nonzero        20.47%      57.662ms        20.49%      57.733ms     962.210us            60  
                               aten::copy_        19.21%      54.107ms        19.49%      54.919ms     122.042us           450  
                                  aten::ne         7.61%      21.453ms        19.46%      54.819ms       1.827ms            30  
                             aten::softmax         0.01%      25.997us        14.04%      39.562ms       1.319ms            30  
                            aten::_softmax        14.03%      39.536ms        14.03%      39.536ms       1.318ms            30  
                            aten::_to_copy         0.06%     179.664us        12.58%      35.446ms     196.921us           180  
                                  aten::to         0.01%      28.539us        12.25%      34.520ms     287.666us           120  
                         aten::masked_fill         0.02%      53.919us        11.52%      32.457ms       1.082ms            30  
                              aten::matmul         0.03%      85.124us        11.27%      31.748ms       1.058ms            30  
                                 aten::bmm        11.18%      31.489ms        11.19%      31.522ms       1.051ms            30  
                            aten::to_dense         0.01%      16.412us         9.66%      27.201ms     906.716us            30  
                           aten::_to_dense         1.51%       4.266ms         9.65%      27.185ms     906.169us            30  
------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 281.732ms

2026-02-11 09:49:13,333 - INFO - ------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                          Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
                 ProfilerStep*         0.45%     243.509us       100.00%      53.843ms       1.795ms            30  
    extension_cpp::sparse_attn        98.48%      53.024ms        99.44%      53.539ms       1.785ms            30  
               aten::new_zeros         0.03%      14.795us         0.91%     491.001us      16.367us            30  
                   aten::zero_         0.03%      15.538us         0.88%     475.581us       7.926us            60  
                   aten::fill_         0.85%     460.043us         0.85%     460.043us      15.335us            30  
                 aten::squeeze         0.07%      35.789us         0.08%      42.121us       0.468us            90  
                   aten::empty         0.03%      18.419us         0.03%      18.419us       0.205us            90  
               aten::unsqueeze         0.03%      15.047us         0.03%      18.252us       0.608us            30  
              aten::as_strided         0.02%       9.537us         0.02%       9.537us       0.079us           120  
               aten::new_empty         0.01%       3.831us         0.01%       7.541us       0.251us            30  
              aten::contiguous         0.01%       2.713us         0.01%       2.713us       0.030us            90  
------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 53.843ms

